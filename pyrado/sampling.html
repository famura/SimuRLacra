<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>sampling &mdash; Pyrado 0.7.1 documentation</title>
      <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="_static/graphviz.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/sphinx_highlight.js"></script>
        <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="plotting" href="plotting.html" />
    <link rel="prev" title="tasks" href="tasks.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="index.html" class="icon icon-home"> Pyrado
          </a>
              <div class="version">
                0.7.1
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Examples:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="examples/1_basic_experiment.html">How to run an experiment</a></li>
<li class="toctree-l1"><a class="reference internal" href="examples/2_wrapping_environments.html">How to wrap an environment</a></li>
<li class="toctree-l1"><a class="reference internal" href="examples/3_algorithm_skeleton.html">How to create an algorithm</a></li>
<li class="toctree-l1"><a class="reference internal" href="examples/4_creating_rcspysim_environments.html">How to create an RcsPySim environment</a></li>
<li class="toctree-l1"><a class="reference internal" href="examples/5_panda3d_visualization.html"><strong>How to create a visualization</strong></a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Environments:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="environments.html">environments</a></li>
<li class="toctree-l1"><a class="reference internal" href="environments.barrett_wam.html">barrett_wam</a></li>
<li class="toctree-l1"><a class="reference internal" href="environments.mujoco.html">mujoco</a></li>
<li class="toctree-l1"><a class="reference internal" href="environments.pysim.html">pysim</a></li>
<li class="toctree-l1"><a class="reference internal" href="environments.quanser.html">quanser</a></li>
<li class="toctree-l1"><a class="reference internal" href="environments.rcspysim.html">rcspysim</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Environment Wrappers:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="environment_wrappers.html">environment_wrappers</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Domain Randomization:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="domain_randomization.html">domain_randomization</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Algorithms:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="algorithms.html">algorithms</a></li>
<li class="toctree-l1"><a class="reference internal" href="algorithms.episodic.html">episodic</a></li>
<li class="toctree-l1"><a class="reference internal" href="algorithms.step_based.html">step_based</a></li>
<li class="toctree-l1"><a class="reference internal" href="algorithms.meta.html">meta</a></li>
<li class="toctree-l1"><a class="reference internal" href="algorithms.regression.html">regression</a></li>
<li class="toctree-l1"><a class="reference internal" href="algorithms.stopping_criteria.html">stopping_criteria</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Exploration:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="exploration.html">exploration</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Policies:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="policies.html">policies</a></li>
<li class="toctree-l1"><a class="reference internal" href="policies.feed_back.html">feed_back</a></li>
<li class="toctree-l1"><a class="reference internal" href="policies.feed_forward.html">feed_forward</a></li>
<li class="toctree-l1"><a class="reference internal" href="policies.recurrent.html">recurrent</a></li>
<li class="toctree-l1"><a class="reference internal" href="policies.special.html">special</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Spaces:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="spaces.html">spaces</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Tasks &amp; Rewards:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="tasks.html">tasks</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Sampling:</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">sampling</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#module-pyrado.sampling.bootstrapping">bootstrapping</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#pyrado.sampling.bootstrapping.bootstrap_ci"><code class="docutils literal notranslate"><span class="pre">bootstrap_ci()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-pyrado.sampling.cvar_sampler">cvar_sampler</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#pyrado.sampling.cvar_sampler.CVaRSampler"><code class="docutils literal notranslate"><span class="pre">CVaRSampler</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#pyrado.sampling.cvar_sampler.CVaRSampler.reinit"><code class="docutils literal notranslate"><span class="pre">CVaRSampler.reinit()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pyrado.sampling.cvar_sampler.CVaRSampler.sample"><code class="docutils literal notranslate"><span class="pre">CVaRSampler.sample()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pyrado.sampling.cvar_sampler.CVaRSampler.set_min_count"><code class="docutils literal notranslate"><span class="pre">CVaRSampler.set_min_count()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#pyrado.sampling.cvar_sampler.select_cvar"><code class="docutils literal notranslate"><span class="pre">select_cvar()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-pyrado.sampling.data_format">data_format</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#pyrado.sampling.data_format.cat_to_format"><code class="docutils literal notranslate"><span class="pre">cat_to_format()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#pyrado.sampling.data_format.new_tuple"><code class="docutils literal notranslate"><span class="pre">new_tuple()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#pyrado.sampling.data_format.stack_to_format"><code class="docutils literal notranslate"><span class="pre">stack_to_format()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#pyrado.sampling.data_format.to_format"><code class="docutils literal notranslate"><span class="pre">to_format()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-pyrado.sampling.hyper_sphere">hyper_sphere</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#pyrado.sampling.hyper_sphere.sample_from_hyper_sphere_surface"><code class="docutils literal notranslate"><span class="pre">sample_from_hyper_sphere_surface()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-pyrado.sampling.parallel_evaluation">parallel_evaluation</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#pyrado.sampling.parallel_evaluation.eval_domain_params"><code class="docutils literal notranslate"><span class="pre">eval_domain_params()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#pyrado.sampling.parallel_evaluation.eval_domain_params_with_segmentwise_reset"><code class="docutils literal notranslate"><span class="pre">eval_domain_params_with_segmentwise_reset()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#pyrado.sampling.parallel_evaluation.eval_nominal_domain"><code class="docutils literal notranslate"><span class="pre">eval_nominal_domain()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#pyrado.sampling.parallel_evaluation.eval_randomized_domain"><code class="docutils literal notranslate"><span class="pre">eval_randomized_domain()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-pyrado.sampling.parallel_rollout_sampler">parallel_rollout_sampler</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#pyrado.sampling.parallel_rollout_sampler.ParallelRolloutSampler"><code class="docutils literal notranslate"><span class="pre">ParallelRolloutSampler</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#pyrado.sampling.parallel_rollout_sampler.ParallelRolloutSampler.reinit"><code class="docutils literal notranslate"><span class="pre">ParallelRolloutSampler.reinit()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pyrado.sampling.parallel_rollout_sampler.ParallelRolloutSampler.sample"><code class="docutils literal notranslate"><span class="pre">ParallelRolloutSampler.sample()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-pyrado.sampling.parameter_exploration_sampler">parameter_exploration_sampler</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#pyrado.sampling.parameter_exploration_sampler.ParameterExplorationSampler"><code class="docutils literal notranslate"><span class="pre">ParameterExplorationSampler</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#pyrado.sampling.parameter_exploration_sampler.ParameterExplorationSampler.num_rollouts_per_param"><code class="docutils literal notranslate"><span class="pre">ParameterExplorationSampler.num_rollouts_per_param</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pyrado.sampling.parameter_exploration_sampler.ParameterExplorationSampler.reinit"><code class="docutils literal notranslate"><span class="pre">ParameterExplorationSampler.reinit()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pyrado.sampling.parameter_exploration_sampler.ParameterExplorationSampler.sample"><code class="docutils literal notranslate"><span class="pre">ParameterExplorationSampler.sample()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#pyrado.sampling.parameter_exploration_sampler.ParameterSample"><code class="docutils literal notranslate"><span class="pre">ParameterSample</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#pyrado.sampling.parameter_exploration_sampler.ParameterSample.mean_undiscounted_return"><code class="docutils literal notranslate"><span class="pre">ParameterSample.mean_undiscounted_return</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pyrado.sampling.parameter_exploration_sampler.ParameterSample.num_rollouts"><code class="docutils literal notranslate"><span class="pre">ParameterSample.num_rollouts</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pyrado.sampling.parameter_exploration_sampler.ParameterSample.params"><code class="docutils literal notranslate"><span class="pre">ParameterSample.params</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pyrado.sampling.parameter_exploration_sampler.ParameterSample.rollouts"><code class="docutils literal notranslate"><span class="pre">ParameterSample.rollouts</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#pyrado.sampling.parameter_exploration_sampler.ParameterSamplingResult"><code class="docutils literal notranslate"><span class="pre">ParameterSamplingResult</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#pyrado.sampling.parameter_exploration_sampler.ParameterSamplingResult.mean_returns"><code class="docutils literal notranslate"><span class="pre">ParameterSamplingResult.mean_returns()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pyrado.sampling.parameter_exploration_sampler.ParameterSamplingResult.num_rollouts"><code class="docutils literal notranslate"><span class="pre">ParameterSamplingResult.num_rollouts()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pyrado.sampling.parameter_exploration_sampler.ParameterSamplingResult.parameters"><code class="docutils literal notranslate"><span class="pre">ParameterSamplingResult.parameters()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pyrado.sampling.parameter_exploration_sampler.ParameterSamplingResult.rollouts"><code class="docutils literal notranslate"><span class="pre">ParameterSamplingResult.rollouts()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-pyrado.sampling.rollout">rollout</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#pyrado.sampling.rollout.after_rollout_query"><code class="docutils literal notranslate"><span class="pre">after_rollout_query()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#pyrado.sampling.rollout.rollout"><code class="docutils literal notranslate"><span class="pre">rollout()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-pyrado.sampling.sampler">sampler</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#pyrado.sampling.sampler.SamplerBase"><code class="docutils literal notranslate"><span class="pre">SamplerBase</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#pyrado.sampling.sampler.SamplerBase.reinit"><code class="docutils literal notranslate"><span class="pre">SamplerBase.reinit()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pyrado.sampling.sampler.SamplerBase.sample"><code class="docutils literal notranslate"><span class="pre">SamplerBase.sample()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pyrado.sampling.sampler.SamplerBase.set_min_count"><code class="docutils literal notranslate"><span class="pre">SamplerBase.set_min_count()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-pyrado.sampling.sampler_pool">sampler_pool</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#pyrado.sampling.sampler_pool.GlobalNamespace"><code class="docutils literal notranslate"><span class="pre">GlobalNamespace</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#pyrado.sampling.sampler_pool.SamplerPool"><code class="docutils literal notranslate"><span class="pre">SamplerPool</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#pyrado.sampling.sampler_pool.SamplerPool.invoke_all"><code class="docutils literal notranslate"><span class="pre">SamplerPool.invoke_all()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pyrado.sampling.sampler_pool.SamplerPool.invoke_all_map"><code class="docutils literal notranslate"><span class="pre">SamplerPool.invoke_all_map()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pyrado.sampling.sampler_pool.SamplerPool.run_collect"><code class="docutils literal notranslate"><span class="pre">SamplerPool.run_collect()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pyrado.sampling.sampler_pool.SamplerPool.run_map"><code class="docutils literal notranslate"><span class="pre">SamplerPool.run_map()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pyrado.sampling.sampler_pool.SamplerPool.set_seed"><code class="docutils literal notranslate"><span class="pre">SamplerPool.set_seed()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pyrado.sampling.sampler_pool.SamplerPool.stop"><code class="docutils literal notranslate"><span class="pre">SamplerPool.stop()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-pyrado.sampling.sbi_embeddings">sbi_embeddings</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#pyrado.sampling.sbi_embeddings.AllStepsEmbedding"><code class="docutils literal notranslate"><span class="pre">AllStepsEmbedding</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#pyrado.sampling.sbi_embeddings.AllStepsEmbedding.dim_output"><code class="docutils literal notranslate"><span class="pre">AllStepsEmbedding.dim_output</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pyrado.sampling.sbi_embeddings.AllStepsEmbedding.name"><code class="docutils literal notranslate"><span class="pre">AllStepsEmbedding.name</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pyrado.sampling.sbi_embeddings.AllStepsEmbedding.requires_target_domain_data"><code class="docutils literal notranslate"><span class="pre">AllStepsEmbedding.requires_target_domain_data</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pyrado.sampling.sbi_embeddings.AllStepsEmbedding.summary_statistic"><code class="docutils literal notranslate"><span class="pre">AllStepsEmbedding.summary_statistic()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#pyrado.sampling.sbi_embeddings.BayesSimEmbedding"><code class="docutils literal notranslate"><span class="pre">BayesSimEmbedding</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#pyrado.sampling.sbi_embeddings.BayesSimEmbedding.dim_output"><code class="docutils literal notranslate"><span class="pre">BayesSimEmbedding.dim_output</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pyrado.sampling.sbi_embeddings.BayesSimEmbedding.name"><code class="docutils literal notranslate"><span class="pre">BayesSimEmbedding.name</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pyrado.sampling.sbi_embeddings.BayesSimEmbedding.requires_target_domain_data"><code class="docutils literal notranslate"><span class="pre">BayesSimEmbedding.requires_target_domain_data</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pyrado.sampling.sbi_embeddings.BayesSimEmbedding.summary_statistic"><code class="docutils literal notranslate"><span class="pre">BayesSimEmbedding.summary_statistic()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#pyrado.sampling.sbi_embeddings.DeltaStepsEmbedding"><code class="docutils literal notranslate"><span class="pre">DeltaStepsEmbedding</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#pyrado.sampling.sbi_embeddings.DeltaStepsEmbedding.dim_output"><code class="docutils literal notranslate"><span class="pre">DeltaStepsEmbedding.dim_output</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pyrado.sampling.sbi_embeddings.DeltaStepsEmbedding.name"><code class="docutils literal notranslate"><span class="pre">DeltaStepsEmbedding.name</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pyrado.sampling.sbi_embeddings.DeltaStepsEmbedding.requires_target_domain_data"><code class="docutils literal notranslate"><span class="pre">DeltaStepsEmbedding.requires_target_domain_data</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pyrado.sampling.sbi_embeddings.DeltaStepsEmbedding.summary_statistic"><code class="docutils literal notranslate"><span class="pre">DeltaStepsEmbedding.summary_statistic()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#pyrado.sampling.sbi_embeddings.DynamicTimeWarpingEmbedding"><code class="docutils literal notranslate"><span class="pre">DynamicTimeWarpingEmbedding</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#pyrado.sampling.sbi_embeddings.DynamicTimeWarpingEmbedding.dim_output"><code class="docutils literal notranslate"><span class="pre">DynamicTimeWarpingEmbedding.dim_output</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pyrado.sampling.sbi_embeddings.DynamicTimeWarpingEmbedding.name"><code class="docutils literal notranslate"><span class="pre">DynamicTimeWarpingEmbedding.name</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pyrado.sampling.sbi_embeddings.DynamicTimeWarpingEmbedding.requires_target_domain_data"><code class="docutils literal notranslate"><span class="pre">DynamicTimeWarpingEmbedding.requires_target_domain_data</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pyrado.sampling.sbi_embeddings.DynamicTimeWarpingEmbedding.summary_statistic"><code class="docutils literal notranslate"><span class="pre">DynamicTimeWarpingEmbedding.summary_statistic()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#pyrado.sampling.sbi_embeddings.Embedding"><code class="docutils literal notranslate"><span class="pre">Embedding</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#pyrado.sampling.sbi_embeddings.Embedding.device"><code class="docutils literal notranslate"><span class="pre">Embedding.device</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pyrado.sampling.sbi_embeddings.Embedding.dim_output"><code class="docutils literal notranslate"><span class="pre">Embedding.dim_output</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pyrado.sampling.sbi_embeddings.Embedding.forward"><code class="docutils literal notranslate"><span class="pre">Embedding.forward()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pyrado.sampling.sbi_embeddings.Embedding.forward_one_batch"><code class="docutils literal notranslate"><span class="pre">Embedding.forward_one_batch()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pyrado.sampling.sbi_embeddings.Embedding.name"><code class="docutils literal notranslate"><span class="pre">Embedding.name</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pyrado.sampling.sbi_embeddings.Embedding.pack"><code class="docutils literal notranslate"><span class="pre">Embedding.pack()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pyrado.sampling.sbi_embeddings.Embedding.requires_target_domain_data"><code class="docutils literal notranslate"><span class="pre">Embedding.requires_target_domain_data</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pyrado.sampling.sbi_embeddings.Embedding.summary_statistic"><code class="docutils literal notranslate"><span class="pre">Embedding.summary_statistic()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pyrado.sampling.sbi_embeddings.Embedding.unpack"><code class="docutils literal notranslate"><span class="pre">Embedding.unpack()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#pyrado.sampling.sbi_embeddings.LastStepEmbedding"><code class="docutils literal notranslate"><span class="pre">LastStepEmbedding</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#pyrado.sampling.sbi_embeddings.LastStepEmbedding.dim_output"><code class="docutils literal notranslate"><span class="pre">LastStepEmbedding.dim_output</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pyrado.sampling.sbi_embeddings.LastStepEmbedding.name"><code class="docutils literal notranslate"><span class="pre">LastStepEmbedding.name</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pyrado.sampling.sbi_embeddings.LastStepEmbedding.requires_target_domain_data"><code class="docutils literal notranslate"><span class="pre">LastStepEmbedding.requires_target_domain_data</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pyrado.sampling.sbi_embeddings.LastStepEmbedding.summary_statistic"><code class="docutils literal notranslate"><span class="pre">LastStepEmbedding.summary_statistic()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#pyrado.sampling.sbi_embeddings.RNNEmbedding"><code class="docutils literal notranslate"><span class="pre">RNNEmbedding</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#pyrado.sampling.sbi_embeddings.RNNEmbedding.dim_output"><code class="docutils literal notranslate"><span class="pre">RNNEmbedding.dim_output</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pyrado.sampling.sbi_embeddings.RNNEmbedding.init_param"><code class="docutils literal notranslate"><span class="pre">RNNEmbedding.init_param()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pyrado.sampling.sbi_embeddings.RNNEmbedding.name"><code class="docutils literal notranslate"><span class="pre">RNNEmbedding.name</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pyrado.sampling.sbi_embeddings.RNNEmbedding.requires_target_domain_data"><code class="docutils literal notranslate"><span class="pre">RNNEmbedding.requires_target_domain_data</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pyrado.sampling.sbi_embeddings.RNNEmbedding.summary_statistic"><code class="docutils literal notranslate"><span class="pre">RNNEmbedding.summary_statistic()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-pyrado.sampling.sbi_rollout_sampler">sbi_rollout_sampler</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#pyrado.sampling.sbi_rollout_sampler.RealRolloutSamplerForSBI"><code class="docutils literal notranslate"><span class="pre">RealRolloutSamplerForSBI</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#pyrado.sampling.sbi_rollout_sampler.RecRolloutSamplerForSBI"><code class="docutils literal notranslate"><span class="pre">RecRolloutSamplerForSBI</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#pyrado.sampling.sbi_rollout_sampler.RecRolloutSamplerForSBI.num_rollouts"><code class="docutils literal notranslate"><span class="pre">RecRolloutSamplerForSBI.num_rollouts</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pyrado.sampling.sbi_rollout_sampler.RecRolloutSamplerForSBI.ring_idx"><code class="docutils literal notranslate"><span class="pre">RecRolloutSamplerForSBI.ring_idx</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#pyrado.sampling.sbi_rollout_sampler.RolloutSamplerForSBI"><code class="docutils literal notranslate"><span class="pre">RolloutSamplerForSBI</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#pyrado.sampling.sbi_rollout_sampler.RolloutSamplerForSBI.get_dim_data"><code class="docutils literal notranslate"><span class="pre">RolloutSamplerForSBI.get_dim_data()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#pyrado.sampling.sbi_rollout_sampler.SimRolloutSamplerForSBI"><code class="docutils literal notranslate"><span class="pre">SimRolloutSamplerForSBI</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#pyrado.sampling.sbi_rollout_sampler.check_domain_params"><code class="docutils literal notranslate"><span class="pre">check_domain_params()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-pyrado.sampling.sequences">sequences</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#pyrado.sampling.sequences.sequence"><code class="docutils literal notranslate"><span class="pre">sequence()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#pyrado.sampling.sequences.sequence_add_init"><code class="docutils literal notranslate"><span class="pre">sequence_add_init()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#pyrado.sampling.sequences.sequence_const"><code class="docutils literal notranslate"><span class="pre">sequence_const()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#pyrado.sampling.sequences.sequence_nlog2"><code class="docutils literal notranslate"><span class="pre">sequence_nlog2()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#pyrado.sampling.sequences.sequence_plus_one"><code class="docutils literal notranslate"><span class="pre">sequence_plus_one()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#pyrado.sampling.sequences.sequence_rec_double"><code class="docutils literal notranslate"><span class="pre">sequence_rec_double()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#pyrado.sampling.sequences.sequence_rec_sqrt"><code class="docutils literal notranslate"><span class="pre">sequence_rec_sqrt()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#pyrado.sampling.sequences.sequence_sqrt"><code class="docutils literal notranslate"><span class="pre">sequence_sqrt()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-pyrado.sampling.step_sequence">step_sequence</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#pyrado.sampling.step_sequence.DictIndexProxy"><code class="docutils literal notranslate"><span class="pre">DictIndexProxy</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#pyrado.sampling.step_sequence.Step"><code class="docutils literal notranslate"><span class="pre">Step</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#pyrado.sampling.step_sequence.StepSequence"><code class="docutils literal notranslate"><span class="pre">StepSequence</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#pyrado.sampling.step_sequence.StepSequence.actions"><code class="docutils literal notranslate"><span class="pre">StepSequence.actions</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pyrado.sampling.step_sequence.StepSequence.add_data"><code class="docutils literal notranslate"><span class="pre">StepSequence.add_data()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pyrado.sampling.step_sequence.StepSequence.concat"><code class="docutils literal notranslate"><span class="pre">StepSequence.concat()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pyrado.sampling.step_sequence.StepSequence.convert"><code class="docutils literal notranslate"><span class="pre">StepSequence.convert()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pyrado.sampling.step_sequence.StepSequence.data_format"><code class="docutils literal notranslate"><span class="pre">StepSequence.data_format</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pyrado.sampling.step_sequence.StepSequence.data_names"><code class="docutils literal notranslate"><span class="pre">StepSequence.data_names</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pyrado.sampling.step_sequence.StepSequence.discounted_return"><code class="docutils literal notranslate"><span class="pre">StepSequence.discounted_return()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pyrado.sampling.step_sequence.StepSequence.from_pandas"><code class="docutils literal notranslate"><span class="pre">StepSequence.from_pandas()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pyrado.sampling.step_sequence.StepSequence.get_data_values"><code class="docutils literal notranslate"><span class="pre">StepSequence.get_data_values()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pyrado.sampling.step_sequence.StepSequence.get_rollout"><code class="docutils literal notranslate"><span class="pre">StepSequence.get_rollout()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pyrado.sampling.step_sequence.StepSequence.iterate_rollouts"><code class="docutils literal notranslate"><span class="pre">StepSequence.iterate_rollouts()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pyrado.sampling.step_sequence.StepSequence.length"><code class="docutils literal notranslate"><span class="pre">StepSequence.length</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pyrado.sampling.step_sequence.StepSequence.numpy"><code class="docutils literal notranslate"><span class="pre">StepSequence.numpy()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pyrado.sampling.step_sequence.StepSequence.observations"><code class="docutils literal notranslate"><span class="pre">StepSequence.observations</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pyrado.sampling.step_sequence.StepSequence.pad"><code class="docutils literal notranslate"><span class="pre">StepSequence.pad()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pyrado.sampling.step_sequence.StepSequence.process_data"><code class="docutils literal notranslate"><span class="pre">StepSequence.process_data()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pyrado.sampling.step_sequence.StepSequence.required_fields"><code class="docutils literal notranslate"><span class="pre">StepSequence.required_fields</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pyrado.sampling.step_sequence.StepSequence.rewards"><code class="docutils literal notranslate"><span class="pre">StepSequence.rewards</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pyrado.sampling.step_sequence.StepSequence.rollout_bounds"><code class="docutils literal notranslate"><span class="pre">StepSequence.rollout_bounds</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pyrado.sampling.step_sequence.StepSequence.rollout_count"><code class="docutils literal notranslate"><span class="pre">StepSequence.rollout_count</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pyrado.sampling.step_sequence.StepSequence.rollout_lengths"><code class="docutils literal notranslate"><span class="pre">StepSequence.rollout_lengths</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pyrado.sampling.step_sequence.StepSequence.sample_w_next"><code class="docutils literal notranslate"><span class="pre">StepSequence.sample_w_next()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pyrado.sampling.step_sequence.StepSequence.split_ordered_batches"><code class="docutils literal notranslate"><span class="pre">StepSequence.split_ordered_batches()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pyrado.sampling.step_sequence.StepSequence.split_shuffled_batches"><code class="docutils literal notranslate"><span class="pre">StepSequence.split_shuffled_batches()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pyrado.sampling.step_sequence.StepSequence.torch"><code class="docutils literal notranslate"><span class="pre">StepSequence.torch()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pyrado.sampling.step_sequence.StepSequence.undiscounted_return"><code class="docutils literal notranslate"><span class="pre">StepSequence.undiscounted_return()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#pyrado.sampling.step_sequence.check_act_equal"><code class="docutils literal notranslate"><span class="pre">check_act_equal()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#pyrado.sampling.step_sequence.discounted_reverse_cumsum"><code class="docutils literal notranslate"><span class="pre">discounted_reverse_cumsum()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#pyrado.sampling.step_sequence.discounted_value"><code class="docutils literal notranslate"><span class="pre">discounted_value()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#pyrado.sampling.step_sequence.discounted_values"><code class="docutils literal notranslate"><span class="pre">discounted_values()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#pyrado.sampling.step_sequence.gae_returns"><code class="docutils literal notranslate"><span class="pre">gae_returns()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-pyrado.sampling.utils">utils</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#pyrado.sampling.utils.gen_ordered_batch_idcs"><code class="docutils literal notranslate"><span class="pre">gen_ordered_batch_idcs()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#pyrado.sampling.utils.gen_ordered_batches"><code class="docutils literal notranslate"><span class="pre">gen_ordered_batches()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#pyrado.sampling.utils.gen_shuffled_batch_idcs"><code class="docutils literal notranslate"><span class="pre">gen_shuffled_batch_idcs()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#pyrado.sampling.utils.shuffled_ordered_batches"><code class="docutils literal notranslate"><span class="pre">shuffled_ordered_batches()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-pyrado.sampling">Module contents</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Plotting:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="plotting.html">plotting</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Utilities:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="utils.html">utils</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Pyrado</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
      <li>sampling</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/sampling.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="sampling">
<h1>sampling<a class="headerlink" href="#sampling" title="Permalink to this heading"></a></h1>
<section id="module-pyrado.sampling.bootstrapping">
<span id="bootstrapping"></span><h2>bootstrapping<a class="headerlink" href="#module-pyrado.sampling.bootstrapping" title="Permalink to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="pyrado.sampling.bootstrapping.bootstrap_ci">
<span class="sig-name descname"><span class="pre">bootstrap_ci</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stat_fcn</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Callable</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_reps</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ci_sides</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bias_correction</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">studentized</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/sampling/bootstrapping.html#bootstrap_ci"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.sampling.bootstrapping.bootstrap_ci" title="Permalink to this definition"></a></dt>
<dd><p>Re-sampling input data using the nonparametric bootstrap method, computing bootstrap replications using stat_fcn and
computing a confidence interval on the statistic of interest given by <cite>stat_fcn</cite> which needs to expect the argument
<cite>axis</cite> (like numpy functions do).</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p>[1] <a class="reference external" href="https://projecteuclid.org/download/pdf_1/euclid.ss/1032280214">https://projecteuclid.org/download/pdf_1/euclid.ss/1032280214</a>
[2] <a class="reference external" href="https://people.csail.mit.edu/tommi/papers/SteJaa-nips03.pdf">https://people.csail.mit.edu/tommi/papers/SteJaa-nips03.pdf</a>
[3] Cameron &amp; Trivedi, “Microeconometrics: Methods and Applications”, 2005, page 361
[4] <a class="reference external" href="http://users.stat.umn.edu/~helwig/notes/bootci-Notes.pdf">http://users.stat.umn.edu/~helwig/notes/bootci-Notes.pdf</a>
[5] <a class="reference external" href="https://www.diva-portal.org/smash/get/diva2:130905/FULLTEXT01.pdf">https://www.diva-portal.org/smash/get/diva2:130905/FULLTEXT01.pdf</a>
[6] <a class="reference external" href="https://www.ethz.ch/content/dam/ethz/special-interest/math/statistics/sfs/Education/Advanced%20Studies%20in%20Applied%20Statistics/course-material-1719/Nonparametric%20Methods/lecture_2up.pdf">https://www.ethz.ch/content/dam/ethz/special-interest/math/statistics/sfs/Education/Advanced%20Studies%20in%20Applied%20Statistics/course-material-1719/Nonparametric%20Methods/lecture_2up.pdf</a>
[7] <a class="reference external" href="https://ocw.mit.edu/courses/mathematics/18-05-introduction-to-probability-and-statistics-spring-2014/readings/MIT18_05S14_Reading24.pdf">https://ocw.mit.edu/courses/mathematics/18-05-introduction-to-probability-and-statistics-spring-2014/readings/MIT18_05S14_Reading24.pdf</a></p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> – data to bootstrap from (for now only 1D arrays supported)</p></li>
<li><p><strong>stat_fcn</strong> – function to compute a statistic of interest (e.g. mean, variance) on bootstrap samples</p></li>
<li><p><strong>num_reps</strong> – number of samples in every bootstrap sample</p></li>
<li><p><strong>alpha</strong> – determines the confidence level <span class="math notranslate nohighlight">\(1 - \alpha \in [0, 1]\)</span></p></li>
<li><p><strong>ci_sides</strong> – one or two-sided confidence interval</p></li>
<li><p><strong>axis</strong> – axis to compute along in case of 2-dim data</p></li>
<li><p><strong>bias_correction</strong> – bool to decide if the bias should be subtracted (see [2]). However, the confidence intervals
are constructed independent of the bias-correction (see [5, p.7]).
The bias-correction can be dangerous in practice. Even though T_bc(D) is less biased than
T(D), the bias-corrected estimator may have substantially larger variance. This is due to a
possibly higher variability in the estimate of the bias, particularly when computed from
small data sets.
Other estimates of the bias-correction factor than stat_emp possible, see [4].</p></li>
<li><p><strong>studentized</strong> – flag to determine if the method based on the t-distribution is used (leads to a wider ci)</p></li>
<li><p><strong>seed</strong> – value for the random number generators’ seeds, pass <cite>None</cite> to skip seeding</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>mean of the bootstrap replications, and the confidence interval</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-pyrado.sampling.cvar_sampler">
<span id="cvar-sampler"></span><h2>cvar_sampler<a class="headerlink" href="#module-pyrado.sampling.cvar_sampler" title="Permalink to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="pyrado.sampling.cvar_sampler.CVaRSampler">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">CVaRSampler</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">wrapped_sampler</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">epsilon</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gamma</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_rollouts</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_steps</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/sampling/cvar_sampler.html#CVaRSampler"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.sampling.cvar_sampler.CVaRSampler" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#pyrado.sampling.sampler.SamplerBase" title="pyrado.sampling.sampler.SamplerBase"><code class="xref py py-class docutils literal notranslate"><span class="pre">SamplerBase</span></code></a>, <a class="reference internal" href="logger.html#pyrado.logger.step.LoggerAware" title="pyrado.logger.step.LoggerAware"><code class="xref py py-class docutils literal notranslate"><span class="pre">LoggerAware</span></code></a></p>
<p>Samples rollouts to optimize the CVaR of the discounted return.
This is done by sampling more rollouts, and then only using the epsilon-qunatile of them.</p>
<p>Constructor</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>wrapped_sampler</strong> – the inner sampler used to sample the full data set</p></li>
<li><p><strong>epsilon</strong> – quantile of rollouts that will be kept</p></li>
<li><p><strong>gamma</strong> – discount factor to compute the discounted return, default is 1 (no discount)</p></li>
<li><p><strong>min_rollouts</strong> – minimum number of complete rollouts to sample</p></li>
<li><p><strong>min_steps</strong> – minimum total number of steps to sample</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyrado.sampling.cvar_sampler.CVaRSampler.reinit">
<span class="sig-name descname"><span class="pre">reinit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">env</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="environments.html#pyrado.environments.base.Env" title="pyrado.environments.base.Env"><span class="pre">Env</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">policy</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="policies.html#pyrado.policies.base.Policy" title="pyrado.policies.base.Policy"><span class="pre">Policy</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/sampling/cvar_sampler.html#CVaRSampler.reinit"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.sampling.cvar_sampler.CVaRSampler.reinit" title="Permalink to this definition"></a></dt>
<dd><p>Reset the sampler after changes were made to the environment or the policy, optionally replacing one of them.</p>
<p>Most samplers will be implemented in parallel, so if there are changes to the environment or the policy,
they will not automatically propagate to all processes. This method exists as a workaround; call it to
force a reinitialization of environment and policy in all subprocesses.</p>
<p>Note that you don’t need to call this if the policy parameters change, since that is to be expected between
sampling runs, the sample() method takes care of this on it’s own.</p>
<p>You can use the env and policy parameters to completely replace the stored environment or policy.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>env</strong> – new environment to use, or None to keep the old one</p></li>
<li><p><strong>policy</strong> – new policy to use, or None to keep the old one</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyrado.sampling.cvar_sampler.CVaRSampler.sample">
<span class="sig-name descname"><span class="pre">sample</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#pyrado.sampling.step_sequence.StepSequence" title="pyrado.sampling.step_sequence.StepSequence"><span class="pre">StepSequence</span></a><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/pyrado/sampling/cvar_sampler.html#CVaRSampler.sample"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.sampling.cvar_sampler.CVaRSampler.sample" title="Permalink to this definition"></a></dt>
<dd><p>Generate a list of rollouts. This method works exactly as specified in the class description.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>sampled rollouts</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyrado.sampling.cvar_sampler.CVaRSampler.set_min_count">
<span class="sig-name descname"><span class="pre">set_min_count</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">min_rollouts</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_steps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/sampling/cvar_sampler.html#CVaRSampler.set_min_count"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.sampling.cvar_sampler.CVaRSampler.set_min_count" title="Permalink to this definition"></a></dt>
<dd><p>Adapt the sampling boundaries.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>min_rollouts</strong> – minimum number of complete rollouts to sample</p></li>
<li><p><strong>min_steps</strong> – minimum total number of steps to sample</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyrado.sampling.cvar_sampler.select_cvar">
<span class="sig-name descname"><span class="pre">select_cvar</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rollouts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">epsilon</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gamma</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/sampling/cvar_sampler.html#select_cvar"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.sampling.cvar_sampler.select_cvar" title="Permalink to this definition"></a></dt>
<dd><p>Select a subset of rollouts so that their mean discounted return is the CVaR(eps) of the full rollout set.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>rollouts</strong> – list of rollouts</p></li>
<li><p><strong>epsilon</strong> – chosen return quantile</p></li>
<li><p><strong>gamma</strong> – discount factor to compute the discounted return, default is 1 (no discount)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>list of selected rollouts</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-pyrado.sampling.data_format">
<span id="data-format"></span><h2>data_format<a class="headerlink" href="#module-pyrado.sampling.data_format" title="Permalink to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="pyrado.sampling.data_format.cat_to_format">
<span class="sig-name descname"><span class="pre">cat_to_format</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">tuple</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Sequence</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_format</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/sampling/data_format.html#cat_to_format"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.sampling.data_format.cat_to_format" title="Permalink to this definition"></a></dt>
<dd><p>Concatenate the generic data in the given data format.
For dicts, the dict elements are stacked individually. A list of dicts is treated as a dict of lists.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> – input data</p></li>
<li><p><strong>data_format</strong> – numpy or torch</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>numpy.ndarray or torch.Tensor, or dict of these</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyrado.sampling.data_format.new_tuple">
<span class="sig-name descname"><span class="pre">new_tuple</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">nt_type</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">values</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/sampling/data_format.html#new_tuple"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.sampling.data_format.new_tuple" title="Permalink to this definition"></a></dt>
<dd><p>Create a new tuple of the same type as nt_type.
This handles the constructor differences between tuple and NamedTuples</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>nt_type</strong> – type of tuple</p></li>
<li><p><strong>values</strong> – values as sequence</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>new named tuple</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyrado.sampling.data_format.stack_to_format">
<span class="sig-name descname"><span class="pre">stack_to_format</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">tuple</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Sequence</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_format</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/sampling/data_format.html#stack_to_format"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.sampling.data_format.stack_to_format" title="Permalink to this definition"></a></dt>
<dd><p>Stack the generic data in the given data format.
For dicts, the dict elements are stacked individually. A list of dicts is treated as a dict of lists.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> – input data</p></li>
<li><p><strong>data_format</strong> – ‘numpy’ or ‘torch’</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>numpy array or PyTorch tensor, or dict of these</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyrado.sampling.data_format.to_format">
<span class="sig-name descname"><span class="pre">to_format</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_format</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/sampling/data_format.html#to_format"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.sampling.data_format.to_format" title="Permalink to this definition"></a></dt>
<dd><p>Convert the tensor data to the given data format.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> – input data</p></li>
<li><p><strong>data_format</strong> – numpy or torch</p></li>
<li><p><strong>data_type</strong> – type to return data in. When None is passed, the data type is left unchanged.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>numpy.ndarray or torch.Tensor</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-pyrado.sampling.hyper_sphere">
<span id="hyper-sphere"></span><h2>hyper_sphere<a class="headerlink" href="#module-pyrado.sampling.hyper_sphere" title="Permalink to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="pyrado.sampling.hyper_sphere.sample_from_hyper_sphere_surface">
<span class="sig-name descname"><span class="pre">sample_from_hyper_sphere_surface</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">num_dim</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tensor</span></span></span><a class="reference internal" href="_modules/pyrado/sampling/hyper_sphere.html#sample_from_hyper_sphere_surface"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.sampling.hyper_sphere.sample_from_hyper_sphere_surface" title="Permalink to this definition"></a></dt>
<dd><p>Sampling from the surface of a multidimensional unit sphere.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p>[1] G. Marsaglia, “Choosing a Point from the Surface of a Sphere”, Ann. Math. Statist., 1972</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>num_dim</strong> – number of dimensions of the sphere</p></li>
<li><p><strong>method</strong> – approach used to acquire the samples</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>sample with L2-norm equal 1</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-pyrado.sampling.parallel_evaluation">
<span id="parallel-evaluation"></span><h2>parallel_evaluation<a class="headerlink" href="#module-pyrado.sampling.parallel_evaluation" title="Permalink to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="pyrado.sampling.parallel_evaluation.eval_domain_params">
<span class="sig-name descname"><span class="pre">eval_domain_params</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">pool:</span> <span class="pre">~pyrado.sampling.sampler_pool.SamplerPool,</span> <span class="pre">env:</span> <span class="pre">~pyrado.environments.sim_base.SimEnv,</span> <span class="pre">policy:</span> <span class="pre">~pyrado.policies.base.Policy,</span> <span class="pre">params:</span> <span class="pre">~typing.List[~typing.Dict],</span> <span class="pre">init_state:</span> <span class="pre">~typing.Optional[~numpy.ndarray]</span> <span class="pre">=</span> <span class="pre">None,</span> <span class="pre">seed:</span> <span class="pre">int</span> <span class="pre">=</span> <span class="pre">&lt;object</span> <span class="pre">object&gt;</span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#pyrado.sampling.step_sequence.StepSequence" title="pyrado.sampling.step_sequence.StepSequence"><span class="pre">StepSequence</span></a><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/pyrado/sampling/parallel_evaluation.html#eval_domain_params"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.sampling.parallel_evaluation.eval_domain_params" title="Permalink to this definition"></a></dt>
<dd><p>Evaluate a policy on a multidimensional grid of domain parameters.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pool</strong> – parallel sampler</p></li>
<li><p><strong>env</strong> – environment to evaluate in</p></li>
<li><p><strong>policy</strong> – policy to evaluate</p></li>
<li><p><strong>params</strong> – multidimensional grid of domain parameters</p></li>
<li><p><strong>init_state</strong> – initial state of the environment which will be fixed if not set to <cite>None</cite></p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>list of rollouts</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyrado.sampling.parallel_evaluation.eval_domain_params_with_segmentwise_reset">
<span class="sig-name descname"><span class="pre">eval_domain_params_with_segmentwise_reset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pool</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#pyrado.sampling.sampler_pool.SamplerPool" title="pyrado.sampling.sampler_pool.SamplerPool"><span class="pre">SamplerPool</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">env_sim</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="environments.html#pyrado.environments.sim_base.SimEnv" title="pyrado.environments.sim_base.SimEnv"><span class="pre">SimEnv</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">policy</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="policies.html#pyrado.policies.base.Policy" title="pyrado.policies.base.Policy"><span class="pre">Policy</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">segments_real_all</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#pyrado.sampling.step_sequence.StepSequence" title="pyrado.sampling.step_sequence.StepSequence"><span class="pre">StepSequence</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">domain_params_ml_all</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stop_on_done</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_rec</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#pyrado.sampling.step_sequence.StepSequence" title="pyrado.sampling.step_sequence.StepSequence"><span class="pre">StepSequence</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/pyrado/sampling/parallel_evaluation.html#eval_domain_params_with_segmentwise_reset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.sampling.parallel_evaluation.eval_domain_params_with_segmentwise_reset" title="Permalink to this definition"></a></dt>
<dd><p>Evaluate a policy for a given set of domain parameters, synchronizing the segments’ initial states with the given
target domain segments</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pool</strong> – parallel sampler</p></li>
<li><p><strong>env_sim</strong> – environment to evaluate in</p></li>
<li><p><strong>policy</strong> – policy to evaluate</p></li>
<li><p><strong>segments_real_all</strong> – all segments from the target domain rollout</p></li>
<li><p><strong>domain_params_ml_all</strong> – all domain parameters to evaluate over</p></li>
<li><p><strong>stop_on_done</strong> – if <cite>True</cite>, the rollouts are stopped as soon as they hit the state or observation space
boundaries. This behavior is save, but can lead to short trajectories which are eventually
padded with zeroes. Chose <cite>False</cite> to ignore the boundaries (dangerous on the real system).</p></li>
<li><p><strong>use_rec</strong> – <cite>True</cite> if pre-recorded actions have been used to generate the rollouts</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>list of segments of rollouts</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyrado.sampling.parallel_evaluation.eval_nominal_domain">
<span class="sig-name descname"><span class="pre">eval_nominal_domain</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pool</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#pyrado.sampling.sampler_pool.SamplerPool" title="pyrado.sampling.sampler_pool.SamplerPool"><span class="pre">SamplerPool</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">env</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="environments.html#pyrado.environments.sim_base.SimEnv" title="pyrado.environments.sim_base.SimEnv"><span class="pre">SimEnv</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">policy</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="policies.html#pyrado.policies.base.Policy" title="pyrado.policies.base.Policy"><span class="pre">Policy</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">init_states</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">ndarray</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#pyrado.sampling.step_sequence.StepSequence" title="pyrado.sampling.step_sequence.StepSequence"><span class="pre">StepSequence</span></a><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/pyrado/sampling/parallel_evaluation.html#eval_nominal_domain"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.sampling.parallel_evaluation.eval_nominal_domain" title="Permalink to this definition"></a></dt>
<dd><p>Evaluate a policy using the nominal (set in the given environment) domain parameters.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pool</strong> – parallel sampler</p></li>
<li><p><strong>env</strong> – environment to evaluate in</p></li>
<li><p><strong>policy</strong> – policy to evaluate</p></li>
<li><p><strong>init_states</strong> – initial states of the environment which will be fixed if not set to <cite>None</cite></p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>list of rollouts</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyrado.sampling.parallel_evaluation.eval_randomized_domain">
<span class="sig-name descname"><span class="pre">eval_randomized_domain</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pool</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#pyrado.sampling.sampler_pool.SamplerPool" title="pyrado.sampling.sampler_pool.SamplerPool"><span class="pre">SamplerPool</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">env</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="environments.html#pyrado.environments.sim_base.SimEnv" title="pyrado.environments.sim_base.SimEnv"><span class="pre">SimEnv</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">randomizer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="domain_randomization.html#pyrado.domain_randomization.domain_randomizer.DomainRandomizer" title="pyrado.domain_randomization.domain_randomizer.DomainRandomizer"><span class="pre">DomainRandomizer</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">policy</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="policies.html#pyrado.policies.base.Policy" title="pyrado.policies.base.Policy"><span class="pre">Policy</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">init_states</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">ndarray</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#pyrado.sampling.step_sequence.StepSequence" title="pyrado.sampling.step_sequence.StepSequence"><span class="pre">StepSequence</span></a><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/pyrado/sampling/parallel_evaluation.html#eval_randomized_domain"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.sampling.parallel_evaluation.eval_randomized_domain" title="Permalink to this definition"></a></dt>
<dd><p>Evaluate a policy in a randomized domain.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pool</strong> – parallel sampler</p></li>
<li><p><strong>env</strong> – environment to evaluate in</p></li>
<li><p><strong>randomizer</strong> – randomizer used to sample random domain instances, inherited from <cite>DomainRandomizer</cite></p></li>
<li><p><strong>policy</strong> – policy to evaluate</p></li>
<li><p><strong>init_states</strong> – initial states of the environment which will be fixed if not set to <cite>None</cite></p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>list of rollouts</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-pyrado.sampling.parallel_rollout_sampler">
<span id="parallel-rollout-sampler"></span><h2>parallel_rollout_sampler<a class="headerlink" href="#module-pyrado.sampling.parallel_rollout_sampler" title="Permalink to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="pyrado.sampling.parallel_rollout_sampler.ParallelRolloutSampler">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">ParallelRolloutSampler</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">env</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">policy</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_workers:</span> <span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_rollouts:</span> <span class="pre">~typing.Optional[int]</span> <span class="pre">=</span> <span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_steps:</span> <span class="pre">~typing.Optional[int]</span> <span class="pre">=</span> <span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show_progress_bar:</span> <span class="pre">bool</span> <span class="pre">=</span> <span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed:</span> <span class="pre">int</span> <span class="pre">=</span> <span class="pre">&lt;object</span> <span class="pre">object&gt;</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/sampling/parallel_rollout_sampler.html#ParallelRolloutSampler"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.sampling.parallel_rollout_sampler.ParallelRolloutSampler" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#pyrado.sampling.sampler.SamplerBase" title="pyrado.sampling.sampler.SamplerBase"><code class="xref py py-class docutils literal notranslate"><span class="pre">SamplerBase</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Serializable</span></code></p>
<p>Class for sampling from multiple environments in parallel</p>
<p>Constructor</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>env</strong> – environment to sample from</p></li>
<li><p><strong>policy</strong> – policy to act in the environment (can also be an exploration strategy)</p></li>
<li><p><strong>num_workers</strong> – number of parallel samplers</p></li>
<li><p><strong>min_rollouts</strong> – minimum number of complete rollouts to sample</p></li>
<li><p><strong>min_steps</strong> – minimum total number of steps to sample</p></li>
<li><p><strong>show_progress_bar</strong> – it <cite>True</cite>, display a progress bar using <cite>tqdm</cite></p></li>
<li><p><strong>seed</strong> – seed value for the random number generators, pass <cite>None</cite> for no seeding; defaults to the last seed
that was set with <cite>pyrado.set_seed</cite></p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyrado.sampling.parallel_rollout_sampler.ParallelRolloutSampler.reinit">
<span class="sig-name descname"><span class="pre">reinit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">env</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="environments.html#pyrado.environments.base.Env" title="pyrado.environments.base.Env"><span class="pre">Env</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">policy</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="policies.html#pyrado.policies.base.Policy" title="pyrado.policies.base.Policy"><span class="pre">Policy</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/sampling/parallel_rollout_sampler.html#ParallelRolloutSampler.reinit"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.sampling.parallel_rollout_sampler.ParallelRolloutSampler.reinit" title="Permalink to this definition"></a></dt>
<dd><p>Re-initialize the sampler.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>env</strong> – the environment which the policy operates</p></li>
<li><p><strong>policy</strong> – the policy used for sampling</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyrado.sampling.parallel_rollout_sampler.ParallelRolloutSampler.sample">
<span class="sig-name descname"><span class="pre">sample</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">init_states</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">ndarray</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">domain_params</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eval</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#pyrado.sampling.step_sequence.StepSequence" title="pyrado.sampling.step_sequence.StepSequence"><span class="pre">StepSequence</span></a><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/pyrado/sampling/parallel_rollout_sampler.html#ParallelRolloutSampler.sample"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.sampling.parallel_rollout_sampler.ParallelRolloutSampler.sample" title="Permalink to this definition"></a></dt>
<dd><p>Do the sampling according to the previously given environment, policy, and number of steps/rollouts.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This method is <strong>not</strong> thread-safe! See for example the usage of <cite>self._sample_count</cite>.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>init_states</strong> – initial states forw <cite>run_map()</cite>, pass <cite>None</cite> (default) to sample from the environment’s
initial state space</p></li>
<li><p><strong>domain_params</strong> – domain parameters for <cite>run_map()</cite>, pass <cite>None</cite> (default) to not explicitly set them</p></li>
<li><p><strong>eval</strong> – pass <cite>False</cite> if the rollout is executed during training, else <cite>True</cite>. Forwarded to <cite>rollout()</cite>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>list of sampled rollouts</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-pyrado.sampling.parameter_exploration_sampler">
<span id="parameter-exploration-sampler"></span><h2>parameter_exploration_sampler<a class="headerlink" href="#module-pyrado.sampling.parameter_exploration_sampler" title="Permalink to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="pyrado.sampling.parameter_exploration_sampler.ParameterExplorationSampler">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">ParameterExplorationSampler</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">env</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="environments.html#pyrado.environments.sim_base.SimEnv" title="pyrado.environments.sim_base.SimEnv"><span class="pre">SimEnv</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="environment_wrappers.html#pyrado.environment_wrappers.base.EnvWrapper" title="pyrado.environment_wrappers.base.EnvWrapper"><span class="pre">EnvWrapper</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">policy</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="policies.html#pyrado.policies.base.Policy" title="pyrado.policies.base.Policy"><span class="pre">Policy</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_init_states_per_domain</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_domains</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_workers</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/sampling/parameter_exploration_sampler.html#ParameterExplorationSampler"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.sampling.parameter_exploration_sampler.ParameterExplorationSampler" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Serializable</span></code></p>
<p>Parallel sampler for parameter exploration</p>
<p>Constructor</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>env</strong> – environment to sample from</p></li>
<li><p><strong>policy</strong> – policy used for sampling</p></li>
<li><p><strong>num_init_states_per_domain</strong> – number of rollouts to cover the variance over initial states</p></li>
<li><p><strong>num_domains</strong> – number of rollouts due to the variance over domain parameters</p></li>
<li><p><strong>num_workers</strong> – number of parallel samplers</p></li>
<li><p><strong>seed</strong> – seed value for the random number generators, pass <cite>None</cite> for no seeding; defaults to the last seed
that was set with <cite>pyrado.set_seed</cite></p></li>
</ul>
</dd>
</dl>
<dl class="py property">
<dt class="sig sig-object py" id="pyrado.sampling.parameter_exploration_sampler.ParameterExplorationSampler.num_rollouts_per_param">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">num_rollouts_per_param</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><a class="headerlink" href="#pyrado.sampling.parameter_exploration_sampler.ParameterExplorationSampler.num_rollouts_per_param" title="Permalink to this definition"></a></dt>
<dd><p>Get the number of rollouts per policy parameter set.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyrado.sampling.parameter_exploration_sampler.ParameterExplorationSampler.reinit">
<span class="sig-name descname"><span class="pre">reinit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">env</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="environments.html#pyrado.environments.base.Env" title="pyrado.environments.base.Env"><span class="pre">Env</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">policy</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="policies.html#pyrado.policies.base.Policy" title="pyrado.policies.base.Policy"><span class="pre">Policy</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/sampling/parameter_exploration_sampler.html#ParameterExplorationSampler.reinit"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.sampling.parameter_exploration_sampler.ParameterExplorationSampler.reinit" title="Permalink to this definition"></a></dt>
<dd><p>Re-initialize the sampler.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>env</strong> – the environment which the policy operates</p></li>
<li><p><strong>policy</strong> – the policy used for sampling</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyrado.sampling.parameter_exploration_sampler.ParameterExplorationSampler.sample">
<span class="sig-name descname"><span class="pre">sample</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">param_sets</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">init_states</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">ndarray</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#pyrado.sampling.parameter_exploration_sampler.ParameterSamplingResult" title="pyrado.sampling.parameter_exploration_sampler.ParameterSamplingResult"><span class="pre">ParameterSamplingResult</span></a></span></span><a class="reference internal" href="_modules/pyrado/sampling/parameter_exploration_sampler.html#ParameterExplorationSampler.sample"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.sampling.parameter_exploration_sampler.ParameterExplorationSampler.sample" title="Permalink to this definition"></a></dt>
<dd><p>Sample rollouts for a given set of parameters.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This method is <strong>not</strong> thread-safe! See for example the usage of <cite>self._sample_count</cite>.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>param_sets</strong> – sets of policy parameters</p></li>
<li><p><strong>init_states</strong> – fixed initial states, pass <cite>None</cite> to randomly sample initial states</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>data structure containing the policy parameter sets and the associated rollout data</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="pyrado.sampling.parameter_exploration_sampler.ParameterSample">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">ParameterSample</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rollouts</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#pyrado.sampling.step_sequence.StepSequence" title="pyrado.sampling.step_sequence.StepSequence"><span class="pre">StepSequence</span></a><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/sampling/parameter_exploration_sampler.html#ParameterSample"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.sampling.parameter_exploration_sampler.ParameterSample" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code></p>
<p>Stores policy parameters and associated rollouts.</p>
<p>Create new instance of ParameterSample(params, rollouts)</p>
<dl class="py property">
<dt class="sig sig-object py" id="pyrado.sampling.parameter_exploration_sampler.ParameterSample.mean_undiscounted_return">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">mean_undiscounted_return</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span></em><a class="headerlink" href="#pyrado.sampling.parameter_exploration_sampler.ParameterSample.mean_undiscounted_return" title="Permalink to this definition"></a></dt>
<dd><p>Get the mean of the undiscounted returns over all rollouts.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="pyrado.sampling.parameter_exploration_sampler.ParameterSample.num_rollouts">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">num_rollouts</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><a class="headerlink" href="#pyrado.sampling.parameter_exploration_sampler.ParameterSample.num_rollouts" title="Permalink to this definition"></a></dt>
<dd><p>Get the number of rollouts.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="pyrado.sampling.parameter_exploration_sampler.ParameterSample.params">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">params</span></span><a class="headerlink" href="#pyrado.sampling.parameter_exploration_sampler.ParameterSample.params" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 0</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="pyrado.sampling.parameter_exploration_sampler.ParameterSample.rollouts">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">rollouts</span></span><a class="headerlink" href="#pyrado.sampling.parameter_exploration_sampler.ParameterSample.rollouts" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 1</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="pyrado.sampling.parameter_exploration_sampler.ParameterSamplingResult">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">ParameterSamplingResult</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">samples</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Sequence</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#pyrado.sampling.parameter_exploration_sampler.ParameterSample" title="pyrado.sampling.parameter_exploration_sampler.ParameterSample"><span class="pre">ParameterSample</span></a><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/sampling/parameter_exploration_sampler.html#ParameterSamplingResult"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.sampling.parameter_exploration_sampler.ParameterSamplingResult" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence</span></code>[<a class="reference internal" href="#pyrado.sampling.parameter_exploration_sampler.ParameterSample" title="pyrado.sampling.parameter_exploration_sampler.ParameterSample"><code class="xref py py-class docutils literal notranslate"><span class="pre">ParameterSample</span></code></a>]</p>
<p>Result of a parameter exploration sampling run.
On one hand, this is a list of ParameterSamples.
On the other hand, this allows to query combined tensors of parameters and mean returns.</p>
<p>Constructor</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>samples</strong> – list of parameter samples</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyrado.sampling.parameter_exploration_sampler.ParameterSamplingResult.mean_returns">
<span class="sig-name descname"><span class="pre">mean_returns</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/sampling/parameter_exploration_sampler.html#ParameterSamplingResult.mean_returns"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.sampling.parameter_exploration_sampler.ParameterSamplingResult.mean_returns" title="Permalink to this definition"></a></dt>
<dd><p>Get all parameter sample means return as a N-dim vector, where N is the number of samples.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyrado.sampling.parameter_exploration_sampler.ParameterSamplingResult.num_rollouts">
<span class="sig-name descname"><span class="pre">num_rollouts</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/sampling/parameter_exploration_sampler.html#ParameterSamplingResult.num_rollouts"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.sampling.parameter_exploration_sampler.ParameterSamplingResult.num_rollouts" title="Permalink to this definition"></a></dt>
<dd><p>Get the total number of rollouts for all samples.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyrado.sampling.parameter_exploration_sampler.ParameterSamplingResult.parameters">
<span class="sig-name descname"><span class="pre">parameters</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/sampling/parameter_exploration_sampler.html#ParameterSamplingResult.parameters"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.sampling.parameter_exploration_sampler.ParameterSamplingResult.parameters" title="Permalink to this definition"></a></dt>
<dd><p>Get all policy parameters as NxP matrix, where N is the number of samples and P is the policy param dim.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyrado.sampling.parameter_exploration_sampler.ParameterSamplingResult.rollouts">
<span class="sig-name descname"><span class="pre">rollouts</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/sampling/parameter_exploration_sampler.html#ParameterSamplingResult.rollouts"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.sampling.parameter_exploration_sampler.ParameterSamplingResult.rollouts" title="Permalink to this definition"></a></dt>
<dd><p>Get all rollouts for all samples, i.e. a list of pop_size items, each a list of nom_rollouts rollouts.</p>
</dd></dl>

</dd></dl>

</section>
<section id="module-pyrado.sampling.rollout">
<span id="rollout"></span><h2>rollout<a class="headerlink" href="#module-pyrado.sampling.rollout" title="Permalink to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="pyrado.sampling.rollout.after_rollout_query">
<span class="sig-name descname"><span class="pre">after_rollout_query</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">env</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="environments.html#pyrado.environments.base.Env" title="pyrado.environments.base.Env"><span class="pre">Env</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">policy</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="policies.html#pyrado.policies.base.Policy" title="pyrado.policies.base.Policy"><span class="pre">Policy</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">rollout</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#pyrado.sampling.step_sequence.StepSequence" title="pyrado.sampling.step_sequence.StepSequence"><span class="pre">StepSequence</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">bool</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">ndarray</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/pyrado/sampling/rollout.html#after_rollout_query"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.sampling.rollout.after_rollout_query" title="Permalink to this definition"></a></dt>
<dd><p>Ask the user what to do after a rollout has been animated.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>env</strong> – environment used for the rollout</p></li>
<li><p><strong>policy</strong> – policy used for the rollout</p></li>
<li><p><strong>rollout</strong> – collected data from the rollout</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>done flag, initial state, and domain parameters</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyrado.sampling.rollout.rollout">
<span class="sig-name descname"><span class="pre">rollout</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">env</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="environments.html#pyrado.environments.base.Env" title="pyrado.environments.base.Env"><span class="pre">Env</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">policy</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">Module</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="policies.html#pyrado.policies.base.Policy" title="pyrado.policies.base.Policy"><span class="pre">Policy</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Callable</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eval</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_steps</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reset_kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">render_mode</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="utils.html#pyrado.utils.data_types.RenderMode" title="pyrado.utils.data_types.RenderMode"><span class="pre">RenderMode</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">RenderMode(text=False,</span> <span class="pre">video=False,</span> <span class="pre">render=False)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">render_step</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">no_reset</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">no_close</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">record_dts</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stop_on_done</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sub_seed</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sub_sub_seed</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#pyrado.sampling.step_sequence.StepSequence" title="pyrado.sampling.step_sequence.StepSequence"><span class="pre">StepSequence</span></a></span></span><a class="reference internal" href="_modules/pyrado/sampling/rollout.html#rollout"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.sampling.rollout.rollout" title="Permalink to this definition"></a></dt>
<dd><p>Perform a rollout (i.e. sample a trajectory) in the given environment using given policy.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>env</strong> – environment to use (<cite>SimEnv</cite> or <cite>RealEnv</cite>)</p></li>
<li><p><strong>policy</strong> – policy to determine the next action given the current observation.
This policy may be wrapped by an exploration strategy.</p></li>
<li><p><strong>eval</strong> – pass <cite>False</cite> if the rollout is executed during training, else <cite>True</cite>. Forwarded to PyTorch <cite>Module</cite>.</p></li>
<li><p><strong>max_steps</strong> – maximum number of time steps, if <cite>None</cite> the environment’s property is used</p></li>
<li><p><strong>reset_kwargs</strong> – keyword arguments passed to environment’s reset function</p></li>
<li><p><strong>render_mode</strong> – determines if the user sees an animation, console prints, or nothing</p></li>
<li><p><strong>render_step</strong> – rendering interval, renders every step if set to 1</p></li>
<li><p><strong>no_reset</strong> – do not reset the environment before running the rollout</p></li>
<li><p><strong>no_close</strong> – do not close (and disconnect) the environment after running the rollout</p></li>
<li><p><strong>record_dts</strong> – flag if the time intervals of different parts of one step should be recorded (for debugging)</p></li>
<li><p><strong>stop_on_done</strong> – set to false to ignore the environment’s done flag (for debugging)</p></li>
<li><p><strong>seed</strong> – seed value for the random number generators, pass <cite>None</cite> for no seeding</p></li>
</ul>
</dd>
</dl>
<p>:return paths of the observations, actions, rewards, and information about the environment as well as the policy</p>
</dd></dl>

</section>
<section id="module-pyrado.sampling.sampler">
<span id="sampler"></span><h2>sampler<a class="headerlink" href="#module-pyrado.sampling.sampler" title="Permalink to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="pyrado.sampling.sampler.SamplerBase">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">SamplerBase</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_rollouts</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_steps</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/sampling/sampler.html#SamplerBase"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.sampling.sampler.SamplerBase" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">ABC</span></code></p>
<p>A sampler generates a list of rollouts in some unspecified way.</p>
<p>Since the sampling might occur in parallel, there is no way to reliably generate an exact amount of samples.
The sampler can however guarantee a minimum amount of samples to be available. The sampler does not discard any
samples on it’s own, all sampled data will be returned.
There are two ways to regulate the sampling process:
1. the minimum number of rollouts
2. the minimum number of steps in all rollouts</p>
<p>At least one of these bounds must be specified. If both are set, the sampler will only terminate once both are
fulfilled.</p>
<p>Constructor</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>min_rollouts</strong> – minimum number of complete rollouts to sample</p></li>
<li><p><strong>min_steps</strong> – minimum total number of steps to sample</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyrado.sampling.sampler.SamplerBase.reinit">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">reinit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">env</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="environments.html#pyrado.environments.base.Env" title="pyrado.environments.base.Env"><span class="pre">Env</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">policy</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="policies.html#pyrado.policies.base.Policy" title="pyrado.policies.base.Policy"><span class="pre">Policy</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/sampling/sampler.html#SamplerBase.reinit"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.sampling.sampler.SamplerBase.reinit" title="Permalink to this definition"></a></dt>
<dd><p>Reset the sampler after changes were made to the environment or the policy, optionally replacing one of them.</p>
<p>Most samplers will be implemented in parallel, so if there are changes to the environment or the policy,
they will not automatically propagate to all processes. This method exists as a workaround; call it to
force a reinitialization of environment and policy in all subprocesses.</p>
<p>Note that you don’t need to call this if the policy parameters change, since that is to be expected between
sampling runs, the sample() method takes care of this on it’s own.</p>
<p>You can use the env and policy parameters to completely replace the stored environment or policy.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>env</strong> – new environment to use, or None to keep the old one</p></li>
<li><p><strong>policy</strong> – new policy to use, or None to keep the old one</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyrado.sampling.sampler.SamplerBase.sample">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">sample</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#pyrado.sampling.step_sequence.StepSequence" title="pyrado.sampling.step_sequence.StepSequence"><span class="pre">StepSequence</span></a><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/pyrado/sampling/sampler.html#SamplerBase.sample"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.sampling.sampler.SamplerBase.sample" title="Permalink to this definition"></a></dt>
<dd><p>Generate a list of rollouts. This method works exactly as specified in the class description.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>sampled rollouts</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyrado.sampling.sampler.SamplerBase.set_min_count">
<span class="sig-name descname"><span class="pre">set_min_count</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">min_rollouts</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_steps</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/sampling/sampler.html#SamplerBase.set_min_count"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.sampling.sampler.SamplerBase.set_min_count" title="Permalink to this definition"></a></dt>
<dd><p>Adapt the sampling boundaries.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>min_rollouts</strong> – minimum number of complete rollouts to sample</p></li>
<li><p><strong>min_steps</strong> – minimum total number of steps to sample</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-pyrado.sampling.sampler_pool">
<span id="sampler-pool"></span><h2>sampler_pool<a class="headerlink" href="#module-pyrado.sampling.sampler_pool" title="Permalink to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="pyrado.sampling.sampler_pool.GlobalNamespace">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">GlobalNamespace</span></span><a class="reference internal" href="_modules/pyrado/sampling/sampler_pool.html#GlobalNamespace"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.sampling.sampler_pool.GlobalNamespace" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Type of the worker’s global namespace</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="pyrado.sampling.sampler_pool.SamplerPool">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">SamplerPool</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">num_threads</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/sampling/sampler_pool.html#SamplerPool"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.sampling.sampler_pool.SamplerPool" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>A process pool capable of executing operations in parallel. This differs from the multiprocessing.Pool class in
that it explicitly incorporates process-local state.</p>
<p>Every parallel function gets a GlobalNamespace object as first argument, which can hold arbitrary worker-local
state. This allows for certain optimizations. For example, when the parallel operation requires an object that is
expensive to transmit, we can create this object once in each process, store it in the namespace, and then use it
in every map function call.</p>
<p>This class also contains additional methods to call a function exactly once in each worker, to setup worker-local
state.</p>
<dl class="py method">
<dt class="sig sig-object py" id="pyrado.sampling.sampler_pool.SamplerPool.invoke_all">
<span class="sig-name descname"><span class="pre">invoke_all</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">func</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/sampling/sampler_pool.html#SamplerPool.invoke_all"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.sampling.sampler_pool.SamplerPool.invoke_all" title="Permalink to this definition"></a></dt>
<dd><p>Invoke func on all workers using the same argument values.
The return values are collected into a list.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>func</strong> – the first argument of func will be a worker-local namespace</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyrado.sampling.sampler_pool.SamplerPool.invoke_all_map">
<span class="sig-name descname"><span class="pre">invoke_all_map</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">func</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">arglist</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/sampling/sampler_pool.html#SamplerPool.invoke_all_map"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.sampling.sampler_pool.SamplerPool.invoke_all_map" title="Permalink to this definition"></a></dt>
<dd><p>Invoke func(arg) on all workers using one argument from the list for each ordered worker.
The length of the argument list must match the number of workers.
The first argument of func will be a worker-local namespace.
The return values are collected into a list.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyrado.sampling.sampler_pool.SamplerPool.run_collect">
<span class="sig-name descname"><span class="pre">run_collect</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">func</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">collect_progressbar</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">tqdm</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_runs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">tuple</span></span></span><a class="reference internal" href="_modules/pyrado/sampling/sampler_pool.html#SamplerPool.run_collect"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.sampling.sampler_pool.SamplerPool.run_collect" title="Permalink to this definition"></a></dt>
<dd><p>Collect at least n samples from func, where the number of samples per run can vary.</p>
<p>This is done by calling res, ns = func(G, <a href="#id1"><span class="problematic" id="id2">*</span></a>args, <a href="#id3"><span class="problematic" id="id4">**</span></a>kwargs) until the sum of ns exceeds n.</p>
<p>This is intended for situations like reinforcement learning runs. If the environment ends up
in an error state, you get less samples per run. To ensure a stable learning behaviour, you can
specify the minimum amount of samples to collect before returning.</p>
<p>Since the workers can only check the amount of samples before starting a run, you will likely
get more samples than the minimum. No generated samples that are part of a rollout are dropped.
However, if some rollouts where sampled that are “too much”, those will be dropped to get seed-
determinism across different number of workers.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>n</strong> – minimum number of samples to collect</p></li>
<li><p><strong>func</strong> – sampler function, must be pickleable</p></li>
<li><p><strong>args</strong> – remaining positional args are passed to the function</p></li>
<li><p><strong>collect_progressbar</strong> – <cite>tdqm</cite> progress bar to use; default None</p></li>
<li><p><strong>min_runs</strong> – optionally specify a minimum amount of runs to be executed before returning</p></li>
<li><p><strong>kwargs</strong> – remaining keyword args are passed to the function</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>list of results</p>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>total number of samples</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyrado.sampling.sampler_pool.SamplerPool.run_map">
<span class="sig-name descname"><span class="pre">run_map</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">func</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">arglist</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">progressbar</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">tqdm</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/sampling/sampler_pool.html#SamplerPool.run_map"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.sampling.sampler_pool.SamplerPool.run_map" title="Permalink to this definition"></a></dt>
<dd><p>A parallel version of <cite>[func(G, arg) for arg in arglist]</cite>.
There is no deterministic assignment of workers to arglist elements. Optionally runs with progress bar.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>func</strong> – mapper function, must be pickleable</p></li>
<li><p><strong>arglist</strong> – list of function args</p></li>
<li><p><strong>progressbar</strong> – optional progress bar from the <cite>tqdm</cite> library</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>list of results</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyrado.sampling.sampler_pool.SamplerPool.set_seed">
<span class="sig-name descname"><span class="pre">set_seed</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">seed</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/sampling/sampler_pool.html#SamplerPool.set_seed"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.sampling.sampler_pool.SamplerPool.set_seed" title="Permalink to this definition"></a></dt>
<dd><p>Set a deterministic seed on all workers.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This is intended to only be used in <strong>legacy</strong> evaluation scripts! For new code and everything that should
really be reproducible, pass the seed to the <cite>sample()</cite> method of a <cite>ParallelRolloutSampler</cite>.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>seed</strong> – seed value for the random number generators</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyrado.sampling.sampler_pool.SamplerPool.stop">
<span class="sig-name descname"><span class="pre">stop</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/sampling/sampler_pool.html#SamplerPool.stop"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.sampling.sampler_pool.SamplerPool.stop" title="Permalink to this definition"></a></dt>
<dd><p>Terminate all workers.</p>
</dd></dl>

</dd></dl>

</section>
<section id="module-pyrado.sampling.sbi_embeddings">
<span id="sbi-embeddings"></span><h2>sbi_embeddings<a class="headerlink" href="#module-pyrado.sampling.sbi_embeddings" title="Permalink to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="pyrado.sampling.sbi_embeddings.AllStepsEmbedding">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">AllStepsEmbedding</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">spec</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="utils.html#pyrado.utils.data_types.EnvSpec" title="pyrado.utils.data_types.EnvSpec"><span class="pre">EnvSpec</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">dim_data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">len_rollouts</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">downsampling_factor</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">state_mask_labels</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">act_mask_labels</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_cuda</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/sampling/sbi_embeddings.html#AllStepsEmbedding"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.sampling.sbi_embeddings.AllStepsEmbedding" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#pyrado.sampling.sbi_embeddings.Embedding" title="pyrado.sampling.sbi_embeddings.Embedding"><code class="xref py py-class docutils literal notranslate"><span class="pre">Embedding</span></code></a></p>
<p>Embedding for simulation-based inference with time series data which computes the same features of the rollouts
states and actions as done in [1]</p>
<dl class="simple">
<dt>[1] F. Ramos, R.C. Possas, D. Fox, “BayesSim: adaptive domain randomization via probabilistic inference for</dt><dd><p>robotics simulators”, RSS, 2019</p>
</dd>
</dl>
<p>Constructor</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>spec</strong> – environment specification</p></li>
<li><p><strong>dim_data</strong> – number of dimensions of one data sample, i.e. one time step. By default, this is the sum of the
state and action spaces’ flat dimensions. This number is doubled if the embedding
target domain data.</p></li>
<li><p><strong>len_rollouts</strong> – number of time steps per rollout without considering a potential downsampling later
(must be the same for all rollouts)</p></li>
<li><p><strong>downsampling_factor</strong> – skip evey <cite>downsampling_factor</cite> time series sample, the downsampling is done in the
base class before calling <cite>summary_statistic()</cite></p></li>
<li><p><strong>state_mask_labels</strong> – list or tuple of integers or stings to select specific states from their space.
By default <cite>None</cite> all states are passed to sbi.</p></li>
<li><p><strong>act_mask_labels</strong> – list or tuple of integers or stings to select specific actions from their space.
By default <cite>None</cite> all actions are passed to sbi.</p></li>
<li><p><strong>use_cuda</strong> – <cite>True</cite> to move the policy to the GPU, <cite>False</cite> (default) to use the CPU</p></li>
</ul>
</dd>
</dl>
<dl class="py property">
<dt class="sig sig-object py" id="pyrado.sampling.sbi_embeddings.AllStepsEmbedding.dim_output">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">dim_output</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><a class="headerlink" href="#pyrado.sampling.sbi_embeddings.AllStepsEmbedding.dim_output" title="Permalink to this definition"></a></dt>
<dd><p>Get the dimension of the embeddings output, i.e. its feature dimension.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pyrado.sampling.sbi_embeddings.AllStepsEmbedding.name">
<span class="sig-name descname"><span class="pre">name</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'asemb'</span></em><a class="headerlink" href="#pyrado.sampling.sbi_embeddings.AllStepsEmbedding.name" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pyrado.sampling.sbi_embeddings.AllStepsEmbedding.requires_target_domain_data">
<span class="sig-name descname"><span class="pre">requires_target_domain_data</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">False</span></em><a class="headerlink" href="#pyrado.sampling.sbi_embeddings.AllStepsEmbedding.requires_target_domain_data" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyrado.sampling.sbi_embeddings.AllStepsEmbedding.summary_statistic">
<span class="sig-name descname"><span class="pre">summary_statistic</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tensor</span></span></span><a class="reference internal" href="_modules/pyrado/sampling/sbi_embeddings.html#AllStepsEmbedding.summary_statistic"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.sampling.sbi_embeddings.AllStepsEmbedding.summary_statistic" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Returns the full states of the rollout as a vector i.e.</dt><dd><p>the time-steps and state dimension are flattend into one dimension.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>data</strong> – states and actions of a rollout or segment to be transformed for inference</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>all states as a flattened vector</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="pyrado.sampling.sbi_embeddings.BayesSimEmbedding">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">BayesSimEmbedding</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">spec</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="utils.html#pyrado.utils.data_types.EnvSpec" title="pyrado.utils.data_types.EnvSpec"><span class="pre">EnvSpec</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">dim_data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">downsampling_factor</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">state_mask_labels</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">act_mask_labels</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_cuda</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/sampling/sbi_embeddings.html#BayesSimEmbedding"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.sampling.sbi_embeddings.BayesSimEmbedding" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#pyrado.sampling.sbi_embeddings.Embedding" title="pyrado.sampling.sbi_embeddings.Embedding"><code class="xref py py-class docutils literal notranslate"><span class="pre">Embedding</span></code></a></p>
<p>Embedding for simulation-based inference with time series data which computes the same features of the rollouts
states and actions as done in [1]</p>
<dl class="simple">
<dt>[1] F. Ramos, R.C. Possas, D. Fox, “BayesSim: adaptive domain randomization via probabilistic inference for</dt><dd><p>robotics simulators”, RSS, 2019</p>
</dd>
</dl>
<p>Constructor</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>spec</strong> – environment specification</p></li>
<li><p><strong>dim_data</strong> – number of dimensions of one data sample, i.e. one time step. By default, this is the sum of the
states and action spaces’ flat dimensions. This number is doubled if the embedding
target domain data.</p></li>
<li><p><strong>downsampling_factor</strong> – skip evey <cite>downsampling_factor</cite> time series sample, no downsampling by default</p></li>
<li><p><strong>state_mask_labels</strong> – list or tuple of integers or stings to select specific states from their space.
By default <cite>None</cite> all states are passed to sbi.</p></li>
<li><p><strong>act_mask_labels</strong> – list or tuple of integers or stings to select specific actions from their space.
By default <cite>None</cite> all actions are passed to sbi.</p></li>
<li><p><strong>use_cuda</strong> – <cite>True</cite> to move the policy to the GPU, <cite>False</cite> (default) to use the CPU</p></li>
</ul>
</dd>
</dl>
<dl class="py property">
<dt class="sig sig-object py" id="pyrado.sampling.sbi_embeddings.BayesSimEmbedding.dim_output">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">dim_output</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><a class="headerlink" href="#pyrado.sampling.sbi_embeddings.BayesSimEmbedding.dim_output" title="Permalink to this definition"></a></dt>
<dd><p>Get the dimension of the embeddings output, i.e. its feature dimension.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pyrado.sampling.sbi_embeddings.BayesSimEmbedding.name">
<span class="sig-name descname"><span class="pre">name</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'bsemb'</span></em><a class="headerlink" href="#pyrado.sampling.sbi_embeddings.BayesSimEmbedding.name" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pyrado.sampling.sbi_embeddings.BayesSimEmbedding.requires_target_domain_data">
<span class="sig-name descname"><span class="pre">requires_target_domain_data</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">False</span></em><a class="headerlink" href="#pyrado.sampling.sbi_embeddings.BayesSimEmbedding.requires_target_domain_data" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyrado.sampling.sbi_embeddings.BayesSimEmbedding.summary_statistic">
<span class="sig-name descname"><span class="pre">summary_statistic</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tensor</span></span></span><a class="reference internal" href="_modules/pyrado/sampling/sbi_embeddings.html#BayesSimEmbedding.summary_statistic"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.sampling.sbi_embeddings.BayesSimEmbedding.summary_statistic" title="Permalink to this definition"></a></dt>
<dd><p>Computing summary statistics based on approach in [1], see eq. (22).
This method guarantees output which has the same size for every trajectory.</p>
<dl class="simple">
<dt>[1] F. Ramos, R.C. Possas, D. Fox, “BayesSim: adaptive domain randomization via probabilistic inference for</dt><dd><p>robotics simulators”, RSS, 2019</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>data</strong> – states and actions of a rollout or segment to be transformed for inference</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>summary statistics of the rollout</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="pyrado.sampling.sbi_embeddings.DeltaStepsEmbedding">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">DeltaStepsEmbedding</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">spec</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="utils.html#pyrado.utils.data_types.EnvSpec" title="pyrado.utils.data_types.EnvSpec"><span class="pre">EnvSpec</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">dim_data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">len_rollouts</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">downsampling_factor</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">state_mask_labels</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">act_mask_labels</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_cuda</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/sampling/sbi_embeddings.html#DeltaStepsEmbedding"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.sampling.sbi_embeddings.DeltaStepsEmbedding" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#pyrado.sampling.sbi_embeddings.Embedding" title="pyrado.sampling.sbi_embeddings.Embedding"><code class="xref py py-class docutils literal notranslate"><span class="pre">Embedding</span></code></a></p>
<p>Embedding for simulation-based inference with time series data which returns the change in the states between
consecutive time steps of the rollouts</p>
<p>Constructor</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>spec</strong> – environment specification</p></li>
<li><p><strong>dim_data</strong> – number of dimensions of one data sample, i.e. one time step. By default, this is the sum of the
state and action spaces’ flat dimensions. This number is doubled if the embedding
target domain data.</p></li>
<li><p><strong>len_rollouts</strong> – number of time steps per rollout without considering a potential downsampling later
(must be the same for all rollouts)</p></li>
<li><p><strong>downsampling_factor</strong> – skip evey <cite>downsampling_factor</cite> time series sample, the downsampling is done in the
base class before calling <cite>summary_statistic()</cite></p></li>
<li><p><strong>state_mask_labels</strong> – list or tuple of integers or stings to select specific states from their space.
By default <cite>None</cite> all states are passed to sbi.</p></li>
<li><p><strong>act_mask_labels</strong> – list or tuple of integers or stings to select specific actions from their space.
By default <cite>None</cite> all actions are passed to sbi.</p></li>
<li><p><strong>use_cuda</strong> – <cite>True</cite> to move the policy to the GPU, <cite>False</cite> (default) to use the CPU</p></li>
</ul>
</dd>
</dl>
<dl class="py property">
<dt class="sig sig-object py" id="pyrado.sampling.sbi_embeddings.DeltaStepsEmbedding.dim_output">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">dim_output</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><a class="headerlink" href="#pyrado.sampling.sbi_embeddings.DeltaStepsEmbedding.dim_output" title="Permalink to this definition"></a></dt>
<dd><p>Get the dimension of the embeddings output, i.e. its feature dimension.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pyrado.sampling.sbi_embeddings.DeltaStepsEmbedding.name">
<span class="sig-name descname"><span class="pre">name</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'dsemb'</span></em><a class="headerlink" href="#pyrado.sampling.sbi_embeddings.DeltaStepsEmbedding.name" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pyrado.sampling.sbi_embeddings.DeltaStepsEmbedding.requires_target_domain_data">
<span class="sig-name descname"><span class="pre">requires_target_domain_data</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">False</span></em><a class="headerlink" href="#pyrado.sampling.sbi_embeddings.DeltaStepsEmbedding.requires_target_domain_data" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyrado.sampling.sbi_embeddings.DeltaStepsEmbedding.summary_statistic">
<span class="sig-name descname"><span class="pre">summary_statistic</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tensor</span></span></span><a class="reference internal" href="_modules/pyrado/sampling/sbi_embeddings.html#DeltaStepsEmbedding.summary_statistic"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.sampling.sbi_embeddings.DeltaStepsEmbedding.summary_statistic" title="Permalink to this definition"></a></dt>
<dd><p>Returns the last states of the rollout as a vector.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>data</strong> – states and actions of a rollout or segment to be transformed for inference</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>all states as a flattened vector</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="pyrado.sampling.sbi_embeddings.DynamicTimeWarpingEmbedding">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">DynamicTimeWarpingEmbedding</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">spec</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="utils.html#pyrado.utils.data_types.EnvSpec" title="pyrado.utils.data_types.EnvSpec"><span class="pre">EnvSpec</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">dim_data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">step_pattern</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">StepPattern</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">downsampling_factor</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">state_mask_labels</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">act_mask_labels</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_cuda</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/sampling/sbi_embeddings.html#DynamicTimeWarpingEmbedding"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.sampling.sbi_embeddings.DynamicTimeWarpingEmbedding" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#pyrado.sampling.sbi_embeddings.Embedding" title="pyrado.sampling.sbi_embeddings.Embedding"><code class="xref py py-class docutils literal notranslate"><span class="pre">Embedding</span></code></a></p>
<p>Embedding for simulation-based inference with time series data which uses the dtw-python package to compute the
Dynamic Time Warping (DTW) distance between the states as features of the data</p>
<p>Constructor</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>spec</strong> – environment specification</p></li>
<li><p><strong>dim_data</strong> – number of dimensions of one data sample, i.e. one time step. By default, this is the sum of the
states and action spaces’ flat dimensions. This number is doubled if the embedding
target domain data.</p></li>
<li><p><strong>step_pattern</strong> – method passed to dtw-python for computing the distance. Here the same default as in the
dtw-python package is used (“symmetric2”). To for example use  the Rabiner-Juang type VI-c
unsmoothed recursion step pattern pass <cite>dtw.stepPattern.rabinerJuangStepPattern(6, “c”)</cite></p></li>
<li><p><strong>downsampling_factor</strong> – skip evey <cite>downsampling_factor</cite> time series sample, the downsampling is done in the
base class before calling <cite>summary_statistic()</cite></p></li>
<li><p><strong>state_mask_labels</strong> – list or tuple of integers or stings to select specific states from their space.
By default <cite>None</cite> all states are passed to sbi.</p></li>
<li><p><strong>act_mask_labels</strong> – list or tuple of integers or stings to select specific actions from their space.
By default <cite>None</cite> all actions are passed to sbi.</p></li>
<li><p><strong>use_cuda</strong> – <cite>True</cite> to move the policy to the GPU, <cite>False</cite> (default) to use the CPU</p></li>
</ul>
</dd>
</dl>
<dl class="py property">
<dt class="sig sig-object py" id="pyrado.sampling.sbi_embeddings.DynamicTimeWarpingEmbedding.dim_output">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">dim_output</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><a class="headerlink" href="#pyrado.sampling.sbi_embeddings.DynamicTimeWarpingEmbedding.dim_output" title="Permalink to this definition"></a></dt>
<dd><p>Get the dimension of the embeddings output, i.e. its feature dimension.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pyrado.sampling.sbi_embeddings.DynamicTimeWarpingEmbedding.name">
<span class="sig-name descname"><span class="pre">name</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'dtwemb'</span></em><a class="headerlink" href="#pyrado.sampling.sbi_embeddings.DynamicTimeWarpingEmbedding.name" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pyrado.sampling.sbi_embeddings.DynamicTimeWarpingEmbedding.requires_target_domain_data">
<span class="sig-name descname"><span class="pre">requires_target_domain_data</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">True</span></em><a class="headerlink" href="#pyrado.sampling.sbi_embeddings.DynamicTimeWarpingEmbedding.requires_target_domain_data" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyrado.sampling.sbi_embeddings.DynamicTimeWarpingEmbedding.summary_statistic">
<span class="sig-name descname"><span class="pre">summary_statistic</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tensor</span></span></span><a class="reference internal" href="_modules/pyrado/sampling/sbi_embeddings.html#DynamicTimeWarpingEmbedding.summary_statistic"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.sampling.sbi_embeddings.DynamicTimeWarpingEmbedding.summary_statistic" title="Permalink to this definition"></a></dt>
<dd><p>Returns the dynamic time warping distance between the simulated rollouts” and the real rollouts’ states.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>It is necessary to take the mean over all distances since the same function is used to compute the
observations (for sbi) form the target domain rollouts. At this point in time there might be only one target
domain rollout, thus the target domain rollouts are only compared with themselves, thus yield a scalar
distance value.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>data</strong> – data tensor containing the simulated states (1st part of the 1st half of the 1st dim) and the
real states (1st part of the 2nd half of the 1st dim)</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>dynamic time warping distance in multi-dim state space</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="pyrado.sampling.sbi_embeddings.Embedding">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">Embedding</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">spec</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="utils.html#pyrado.utils.data_types.EnvSpec" title="pyrado.utils.data_types.EnvSpec"><span class="pre">EnvSpec</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">dim_data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">downsampling_factor</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">state_mask_labels</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">act_mask_labels</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_cuda</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/sampling/sbi_embeddings.html#Embedding"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.sampling.sbi_embeddings.Embedding" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">ABC</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<p>Base class for all embeddings used for simulation-based inference with time series data</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The features of each rollout are concatenated, and since the inference procedure requires a consistent size of
the inputs, it is necessary that all rollouts yield the same number of features, i.e. have equal length!</p>
</div>
<p>Constructor</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>spec</strong> – environment specification</p></li>
<li><p><strong>dim_data</strong> – number of dimensions of one data sample, i.e. one time step. By default, this is the sum of the
states and action spaces’ flat dimensions. This number is doubled if the embedding
target domain data.</p></li>
<li><p><strong>downsampling_factor</strong> – skip evey <cite>downsampling_factor</cite> time series sample, no downsampling by default</p></li>
<li><p><strong>state_mask_labels</strong> – list or tuple of integers or stings to select specific states from their space.
By default <cite>None</cite> all states are passed to sbi.</p></li>
<li><p><strong>act_mask_labels</strong> – list or tuple of integers or stings to select specific actions from their space.
By default <cite>None</cite> all actions are passed to sbi.</p></li>
<li><p><strong>use_cuda</strong> – <cite>True</cite> to move the policy to the GPU, <cite>False</cite> (default) to use the CPU</p></li>
</ul>
</dd>
</dl>
<dl class="py property">
<dt class="sig sig-object py" id="pyrado.sampling.sbi_embeddings.Embedding.device">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">device</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span></em><a class="headerlink" href="#pyrado.sampling.sbi_embeddings.Embedding.device" title="Permalink to this definition"></a></dt>
<dd><p>Get the device (CPU or GPU) on which the embedding is stored.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="pyrado.sampling.sbi_embeddings.Embedding.dim_output">
<em class="property"><span class="pre">abstract</span><span class="w"> </span><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">dim_output</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><a class="headerlink" href="#pyrado.sampling.sbi_embeddings.Embedding.dim_output" title="Permalink to this definition"></a></dt>
<dd><p>Get the dimension of the embeddings output, i.e. its feature dimension.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyrado.sampling.sbi_embeddings.Embedding.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tensor</span></span></span><a class="reference internal" href="_modules/pyrado/sampling/sbi_embeddings.html#Embedding.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.sampling.sbi_embeddings.Embedding.forward" title="Permalink to this definition"></a></dt>
<dd><p>Transforms rollouts into the observations used for likelihood-free inference.
Currently a state-representation as well as state-action summary-statistics are available.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>data</strong> – packed data of shape [batch_size, num_rollouts, len_time_series, dim_data]</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>features of the data extracted from the embedding of shape [[batch_size, num_rollouts * dim_feat]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyrado.sampling.sbi_embeddings.Embedding.forward_one_batch">
<span class="sig-name descname"><span class="pre">forward_one_batch</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data_batch</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tensor</span></span></span><a class="reference internal" href="_modules/pyrado/sampling/sbi_embeddings.html#Embedding.forward_one_batch"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.sampling.sbi_embeddings.Embedding.forward_one_batch" title="Permalink to this definition"></a></dt>
<dd><p>Iterate over all rollouts and compute the features for each rollout separately, then average the features
over the rollouts.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>data_batch</strong> – data batch of shape [num_rollouts, len_time_series, dim_data]</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>concatenation of the features for each rollout</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pyrado.sampling.sbi_embeddings.Embedding.name">
<span class="sig-name descname"><span class="pre">name</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span></em><a class="headerlink" href="#pyrado.sampling.sbi_embeddings.Embedding.name" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyrado.sampling.sbi_embeddings.Embedding.pack">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">pack</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tensor</span></span></span><a class="reference internal" href="_modules/pyrado/sampling/sbi_embeddings.html#Embedding.pack"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.sampling.sbi_embeddings.Embedding.pack" title="Permalink to this definition"></a></dt>
<dd><p>Reshape the data such that the shape is [batch_dim, num_rollouts, data_points_flattened].</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>data</strong> – un-packed a.k.a. un-flattened data</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>packed a.k.a. flattened data</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pyrado.sampling.sbi_embeddings.Embedding.requires_target_domain_data">
<span class="sig-name descname"><span class="pre">requires_target_domain_data</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#pyrado.sampling.sbi_embeddings.Embedding.requires_target_domain_data" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyrado.sampling.sbi_embeddings.Embedding.summary_statistic">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">summary_statistic</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tensor</span></span></span><a class="reference internal" href="_modules/pyrado/sampling/sbi_embeddings.html#Embedding.summary_statistic"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.sampling.sbi_embeddings.Embedding.summary_statistic" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyrado.sampling.sbi_embeddings.Embedding.unpack">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">unpack</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dim_data_orig</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tensor</span></span></span><a class="reference internal" href="_modules/pyrado/sampling/sbi_embeddings.html#Embedding.unpack"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.sampling.sbi_embeddings.Embedding.unpack" title="Permalink to this definition"></a></dt>
<dd><p>Reshape the data such that the shape is [batch_dim, num_rollouts, len_time_series, dim_data].</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> – packed a.k.a. flattened data</p></li>
<li><p><strong>dim_data_orig</strong> – dimension of the original data</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>un-pack a.k.a. un-flattened data</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="pyrado.sampling.sbi_embeddings.LastStepEmbedding">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">LastStepEmbedding</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">spec</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="utils.html#pyrado.utils.data_types.EnvSpec" title="pyrado.utils.data_types.EnvSpec"><span class="pre">EnvSpec</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">dim_data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">downsampling_factor</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">state_mask_labels</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">act_mask_labels</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_cuda</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/sampling/sbi_embeddings.html#LastStepEmbedding"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.sampling.sbi_embeddings.LastStepEmbedding" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#pyrado.sampling.sbi_embeddings.Embedding" title="pyrado.sampling.sbi_embeddings.Embedding"><code class="xref py py-class docutils literal notranslate"><span class="pre">Embedding</span></code></a></p>
<p>Embedding for simulation-based inference with time series data which selects the last state of the rollouts</p>
<p>Constructor</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>spec</strong> – environment specification</p></li>
<li><p><strong>dim_data</strong> – number of dimensions of one data sample, i.e. one time step. By default, this is the sum of the
states and action spaces’ flat dimensions. This number is doubled if the embedding
target domain data.</p></li>
<li><p><strong>downsampling_factor</strong> – skip evey <cite>downsampling_factor</cite> time series sample, no downsampling by default</p></li>
<li><p><strong>state_mask_labels</strong> – list or tuple of integers or stings to select specific states from their space.
By default <cite>None</cite> all states are passed to sbi.</p></li>
<li><p><strong>act_mask_labels</strong> – list or tuple of integers or stings to select specific actions from their space.
By default <cite>None</cite> all actions are passed to sbi.</p></li>
<li><p><strong>use_cuda</strong> – <cite>True</cite> to move the policy to the GPU, <cite>False</cite> (default) to use the CPU</p></li>
</ul>
</dd>
</dl>
<dl class="py property">
<dt class="sig sig-object py" id="pyrado.sampling.sbi_embeddings.LastStepEmbedding.dim_output">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">dim_output</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><a class="headerlink" href="#pyrado.sampling.sbi_embeddings.LastStepEmbedding.dim_output" title="Permalink to this definition"></a></dt>
<dd><p>Get the dimension of the embeddings output, i.e. its feature dimension.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pyrado.sampling.sbi_embeddings.LastStepEmbedding.name">
<span class="sig-name descname"><span class="pre">name</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'lsemb'</span></em><a class="headerlink" href="#pyrado.sampling.sbi_embeddings.LastStepEmbedding.name" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pyrado.sampling.sbi_embeddings.LastStepEmbedding.requires_target_domain_data">
<span class="sig-name descname"><span class="pre">requires_target_domain_data</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">False</span></em><a class="headerlink" href="#pyrado.sampling.sbi_embeddings.LastStepEmbedding.requires_target_domain_data" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyrado.sampling.sbi_embeddings.LastStepEmbedding.summary_statistic">
<span class="sig-name descname"><span class="pre">summary_statistic</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tensor</span></span></span><a class="reference internal" href="_modules/pyrado/sampling/sbi_embeddings.html#LastStepEmbedding.summary_statistic"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.sampling.sbi_embeddings.LastStepEmbedding.summary_statistic" title="Permalink to this definition"></a></dt>
<dd><p>Returns the last state of the rollout as a vector.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>data</strong> – states and actions of a rollout or segment to be transformed for inference</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>last states as a vector</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="pyrado.sampling.sbi_embeddings.RNNEmbedding">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">RNNEmbedding</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">spec:</span> <span class="pre">~pyrado.utils.data_types.EnvSpec,</span> <span class="pre">dim_data:</span> <span class="pre">int,</span> <span class="pre">hidden_size:</span> <span class="pre">int,</span> <span class="pre">num_recurrent_layers:</span> <span class="pre">int,</span> <span class="pre">output_size:</span> <span class="pre">int,</span> <span class="pre">recurrent_network_type:</span> <span class="pre">type</span> <span class="pre">=</span> <span class="pre">&lt;class</span> <span class="pre">'torch.nn.modules.rnn.RNN'&gt;,</span> <span class="pre">only_last_output:</span> <span class="pre">bool</span> <span class="pre">=</span> <span class="pre">False,</span> <span class="pre">len_rollouts:</span> <span class="pre">~typing.Optional[int]</span> <span class="pre">=</span> <span class="pre">None,</span> <span class="pre">output_nonlin:</span> <span class="pre">~typing.Optional[~typing.Callable]</span> <span class="pre">=</span> <span class="pre">None,</span> <span class="pre">dropout:</span> <span class="pre">float</span> <span class="pre">=</span> <span class="pre">0.0,</span> <span class="pre">init_param_kwargs:</span> <span class="pre">~typing.Optional[dict]</span> <span class="pre">=</span> <span class="pre">None,</span> <span class="pre">downsampling_factor:</span> <span class="pre">int</span> <span class="pre">=</span> <span class="pre">1,</span> <span class="pre">state_mask_labels:</span> <span class="pre">~typing.Optional[~typing.Union[~typing.Tuple[~typing.Union[int,</span> <span class="pre">str]],</span> <span class="pre">~typing.List[~typing.Union[int,</span> <span class="pre">str]]]]</span> <span class="pre">=</span> <span class="pre">None,</span> <span class="pre">act_mask_labels:</span> <span class="pre">~typing.Optional[~typing.Union[~typing.Tuple[~typing.Union[int,</span> <span class="pre">str]],</span> <span class="pre">~typing.List[~typing.Union[int,</span> <span class="pre">str]]]]</span> <span class="pre">=</span> <span class="pre">None,</span> <span class="pre">use_cuda:</span> <span class="pre">bool</span> <span class="pre">=</span> <span class="pre">False,</span> <span class="pre">**recurrent_net_kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/sampling/sbi_embeddings.html#RNNEmbedding"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.sampling.sbi_embeddings.RNNEmbedding" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#pyrado.sampling.sbi_embeddings.Embedding" title="pyrado.sampling.sbi_embeddings.Embedding"><code class="xref py py-class docutils literal notranslate"><span class="pre">Embedding</span></code></a></p>
<p>Embedding for simulation-based inference with time series data which uses an recurrent neural network, e.g. RNN,
LSTM, or GRU, to compute features of the rollouts</p>
<p>Constructor</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>spec</strong> – environment specification</p></li>
<li><p><strong>dim_data</strong> – number of dimensions of one data sample, i.e. one time step. By default, this is the sum of the
state and action spaces’ flat dimensions. This number is doubled if the embedding
target domain data.</p></li>
<li><p><strong>hidden_size</strong> – size of the hidden layers (all equal)</p></li>
<li><p><strong>num_recurrent_layers</strong> – number of equally sized hidden layers</p></li>
<li><p><strong>recurrent_network_type</strong> – PyTorch recurrent network class, e.g. <cite>nn.RNN</cite>, <cite>nn.LSTM</cite>, or <cite>nn.GRU</cite></p></li>
<li><p><strong>output_size</strong> – size of the features at every time step, which are eventually reshaped into a vector</p></li>
<li><p><strong>only_last_output</strong> – if <cite>True</cite>, only the last output of the network is used as a feature for sbi, else
there will be an output every <cite>downsampling_factor</cite> time steps. Moreover, if <cite>True</cite> the
constructor does not need to know how long the rollouts are.</p></li>
<li><p><strong>len_rollouts</strong> – number of time steps per rollout without considering a potential downsampling later
(must be the same for all rollouts)</p></li>
<li><p><strong>output_nonlin</strong> – nonlinearity for output layer</p></li>
<li><p><strong>dropout</strong> – dropout probability, default = 0 deactivates dropout</p></li>
<li><p><strong>init_param_kwargs</strong> – additional keyword arguments for the policy parameter initialization</p></li>
<li><p><strong>recurrent_net_kwargs</strong> – any extra kwargs are passed to the recurrent net’s constructor</p></li>
<li><p><strong>downsampling_factor</strong> – skip evey <cite>downsampling_factor</cite> time series sample, the downsampling is done in the
base class before calling <cite>summary_statistic()</cite></p></li>
<li><p><strong>state_mask_labels</strong> – list or tuple of integers or stings to select specific states from their space.
By default <cite>None</cite> all states are passed to sbi.</p></li>
<li><p><strong>act_mask_labels</strong> – list or tuple of integers or stings to select specific actions from their space.
By default <cite>None</cite> all actions are passed to sbi.</p></li>
<li><p><strong>use_cuda</strong> – <cite>True</cite> to move the policy to the GPU, <cite>False</cite> (default) to use the CPU</p></li>
</ul>
</dd>
</dl>
<dl class="py property">
<dt class="sig sig-object py" id="pyrado.sampling.sbi_embeddings.RNNEmbedding.dim_output">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">dim_output</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><a class="headerlink" href="#pyrado.sampling.sbi_embeddings.RNNEmbedding.dim_output" title="Permalink to this definition"></a></dt>
<dd><p>Get the dimension of the embeddings output, i.e. its feature dimension.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyrado.sampling.sbi_embeddings.RNNEmbedding.init_param">
<span class="sig-name descname"><span class="pre">init_param</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">init_values</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Tensor</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/sampling/sbi_embeddings.html#RNNEmbedding.init_param"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.sampling.sbi_embeddings.RNNEmbedding.init_param" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pyrado.sampling.sbi_embeddings.RNNEmbedding.name">
<span class="sig-name descname"><span class="pre">name</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'rnnemb'</span></em><a class="headerlink" href="#pyrado.sampling.sbi_embeddings.RNNEmbedding.name" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pyrado.sampling.sbi_embeddings.RNNEmbedding.requires_target_domain_data">
<span class="sig-name descname"><span class="pre">requires_target_domain_data</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">False</span></em><a class="headerlink" href="#pyrado.sampling.sbi_embeddings.RNNEmbedding.requires_target_domain_data" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyrado.sampling.sbi_embeddings.RNNEmbedding.summary_statistic">
<span class="sig-name descname"><span class="pre">summary_statistic</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tensor</span></span></span><a class="reference internal" href="_modules/pyrado/sampling/sbi_embeddings.html#RNNEmbedding.summary_statistic"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.sampling.sbi_embeddings.RNNEmbedding.summary_statistic" title="Permalink to this definition"></a></dt>
<dd><p>Pass the time series data through a recurrent neural network.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>data</strong> – states and actions of a rollout or segment to be transformed for inference</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>features obtained from the RNN at every time step, fattened into a vector</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-pyrado.sampling.sbi_rollout_sampler">
<span id="sbi-rollout-sampler"></span><h2>sbi_rollout_sampler<a class="headerlink" href="#module-pyrado.sampling.sbi_rollout_sampler" title="Permalink to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="pyrado.sampling.sbi_rollout_sampler.RealRolloutSamplerForSBI">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">RealRolloutSamplerForSBI</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">env</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="environments.html#pyrado.environments.base.Env" title="pyrado.environments.base.Env"><span class="pre">Env</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">policy</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="policies.html#pyrado.policies.base.Policy" title="pyrado.policies.base.Policy"><span class="pre">Policy</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">embedding</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#pyrado.sampling.sbi_embeddings.Embedding" title="pyrado.sampling.sbi_embeddings.Embedding"><span class="pre">Embedding</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_segments</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">len_segments</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stop_on_done</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/sampling/sbi_rollout_sampler.html#RealRolloutSamplerForSBI"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.sampling.sbi_rollout_sampler.RealRolloutSamplerForSBI" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#pyrado.sampling.sbi_rollout_sampler.RolloutSamplerForSBI" title="pyrado.sampling.sbi_rollout_sampler.RolloutSamplerForSBI"><code class="xref py py-class docutils literal notranslate"><span class="pre">RolloutSamplerForSBI</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Serializable</span></code></p>
<p>Wrapper to make SimuRLacra’s real environments similar to the sbi simulator</p>
<p>Constructor</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>env</strong> – environment which the policy operates, in sim-to-real settings this is a real-world device, i.e.
<cite>RealEnv</cite>, but in a sim-to-sim experiment this can be a (randomized) <cite>SimEnv</cite></p></li>
<li><p><strong>policy</strong> – policy used for sampling the rollout</p></li>
<li><p><strong>embedding</strong> – embedding used for pre-processing the data before (later) passing it to the posterior</p></li>
<li><p><strong>num_segments</strong> – number of segments in which the rollouts are split into. For every segment, the initial
state of the simulation is reset, and thus for every set the features of the trajectories
are computed separately. Either specify <cite>num_segments</cite> or <cite>len_segments</cite>.</p></li>
<li><p><strong>len_segments</strong> – length of the segments in which the rollouts are split into. For every segment, the initial
state of the simulation is reset, and thus for every set the features of the trajectories
are computed separately. Either specify <cite>num_segments</cite> or <cite>len_segments</cite>.</p></li>
<li><p><strong>stop_on_done</strong> – if <cite>True</cite>, the rollouts are stopped as soon as they hit the state or observation space
boundaries. This behavior is save, but can lead to short trajectories which are eventually
padded with zeroes. Chose <cite>False</cite> to ignore the boundaries (dangerous on the real system).</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="pyrado.sampling.sbi_rollout_sampler.RecRolloutSamplerForSBI">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">RecRolloutSamplerForSBI</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rollouts_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">embedding</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#pyrado.sampling.sbi_embeddings.Embedding" title="pyrado.sampling.sbi_embeddings.Embedding"><span class="pre">Embedding</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_segments</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">len_segments</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rand_init_rollout</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/sampling/sbi_rollout_sampler.html#RecRolloutSamplerForSBI"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.sampling.sbi_rollout_sampler.RecRolloutSamplerForSBI" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#pyrado.sampling.sbi_rollout_sampler.RealRolloutSamplerForSBI" title="pyrado.sampling.sbi_rollout_sampler.RealRolloutSamplerForSBI"><code class="xref py py-class docutils literal notranslate"><span class="pre">RealRolloutSamplerForSBI</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Serializable</span></code></p>
<p>Wrapper to yield pre-recorded rollouts similar to the sbi simulator</p>
<p>Constructor</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>rollouts_dir</strong> – directory where to find the of pre-recorded rollouts</p></li>
<li><p><strong>num_segments</strong> – number of segments in which the rollouts are split into. For every segment, the initial
state of the simulation is reset, and thus for every set the features of the trajectories
are computed separately. Either specify <cite>num_segments</cite> or <cite>len_segments</cite>.</p></li>
<li><p><strong>embedding</strong> – embedding used for pre-processing the data before (later) passing it to the posterior</p></li>
<li><p><strong>len_segments</strong> – length of the segments in which the rollouts are split into. For every segment, the initial
state of the simulation is reset, and thus for every set the features of the trajectories
are computed separately. Either specify <cite>num_segments</cite> or <cite>len_segments</cite>.</p></li>
<li><p><strong>rand_init_rollout</strong> – if <cite>True</cite>, chose the first rollout at random, and then cycle through the list</p></li>
</ul>
</dd>
</dl>
<dl class="py property">
<dt class="sig sig-object py" id="pyrado.sampling.sbi_rollout_sampler.RecRolloutSamplerForSBI.num_rollouts">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">num_rollouts</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><a class="headerlink" href="#pyrado.sampling.sbi_rollout_sampler.RecRolloutSamplerForSBI.num_rollouts" title="Permalink to this definition"></a></dt>
<dd><p>Get the number of stored rollouts.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="pyrado.sampling.sbi_rollout_sampler.RecRolloutSamplerForSBI.ring_idx">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">ring_idx</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><a class="headerlink" href="#pyrado.sampling.sbi_rollout_sampler.RecRolloutSamplerForSBI.ring_idx" title="Permalink to this definition"></a></dt>
<dd><p>Get the buffer’s index.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="pyrado.sampling.sbi_rollout_sampler.RolloutSamplerForSBI">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">RolloutSamplerForSBI</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">env</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="environments.html#pyrado.environments.base.Env" title="pyrado.environments.base.Env"><span class="pre">Env</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">policy</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="policies.html#pyrado.policies.base.Policy" title="pyrado.policies.base.Policy"><span class="pre">Policy</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">embedding</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#pyrado.sampling.sbi_embeddings.Embedding" title="pyrado.sampling.sbi_embeddings.Embedding"><span class="pre">Embedding</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_segments</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">len_segments</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stop_on_done</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/sampling/sbi_rollout_sampler.html#RolloutSamplerForSBI"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.sampling.sbi_rollout_sampler.RolloutSamplerForSBI" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">ABC</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Serializable</span></code></p>
<p>Wrapper to do enable the sbi simulator instance to make rollouts from SimuRLacra environments as if the environment
was a callable that only needs the simulator parameters as inputs</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The features of each rollout are concatenated, and since the inference procedure requires a consistent size of
the inputs, it is necessary that all rollouts yield the same number of features, i.e. have equal length!</p>
</div>
<p>Constructor</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>env</strong> – environment which the policy operates, in sim-to-real settings this is a real-world device, buy in
a sim-to-sim experiment this can be a (randomized) <cite>SimEnv</cite>. We strip all domain randomization
wrappers from this env since we want to randomize it manually here.</p></li>
<li><p><strong>policy</strong> – policy used for sampling the rollout</p></li>
<li><p><strong>embedding</strong> – embedding used for pre-processing the data before (later) passing it to the posterior</p></li>
<li><p><strong>num_segments</strong> – number of segments in which the rollouts are split into. For every segment, the initial
state of the simulation is reset, and thus for every set the features of the trajectories
are computed separately. Either specify <cite>num_segments</cite> or <cite>len_segments</cite>.</p></li>
<li><p><strong>len_segments</strong> – length of the segments in which the rollouts are split into. For every segment, the initial
state of the simulation is reset, and thus for every set the features of the trajectories
are computed separately. Either specify <cite>num_segments</cite> or <cite>len_segments</cite>.</p></li>
<li><p><strong>stop_on_done</strong> – if <cite>True</cite>, the rollouts are stopped as soon as they hit the state or observation space
boundaries. This behavior is save, but can lead to short trajectories which are eventually
padded with zeroes. Chose <cite>False</cite> to ignore the boundaries (dangerous on the real system).</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyrado.sampling.sbi_rollout_sampler.RolloutSamplerForSBI.get_dim_data">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_dim_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">spec</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="utils.html#pyrado.utils.data_types.EnvSpec" title="pyrado.utils.data_types.EnvSpec"><span class="pre">EnvSpec</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">int</span></span></span><a class="reference internal" href="_modules/pyrado/sampling/sbi_rollout_sampler.html#RolloutSamplerForSBI.get_dim_data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.sampling.sbi_rollout_sampler.RolloutSamplerForSBI.get_dim_data" title="Permalink to this definition"></a></dt>
<dd><p>Compute the dimension of the data which is extracted from the rollouts.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>spec</strong> – environment specification</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>dimension of one data sample, i.e. one time step</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="pyrado.sampling.sbi_rollout_sampler.SimRolloutSamplerForSBI">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">SimRolloutSamplerForSBI</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">env</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="environments.html#pyrado.environments.sim_base.SimEnv" title="pyrado.environments.sim_base.SimEnv"><span class="pre">SimEnv</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="environment_wrappers.html#pyrado.environment_wrappers.base.EnvWrapper" title="pyrado.environment_wrappers.base.EnvWrapper"><span class="pre">EnvWrapper</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">policy</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="policies.html#pyrado.policies.base.Policy" title="pyrado.policies.base.Policy"><span class="pre">Policy</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">dp_mapping</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Mapping</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">embedding</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#pyrado.sampling.sbi_embeddings.Embedding" title="pyrado.sampling.sbi_embeddings.Embedding"><span class="pre">Embedding</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_segments</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">len_segments</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stop_on_done</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rollouts_real</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#pyrado.sampling.step_sequence.StepSequence" title="pyrado.sampling.step_sequence.StepSequence"><span class="pre">StepSequence</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_rec_act</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/sampling/sbi_rollout_sampler.html#SimRolloutSamplerForSBI"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.sampling.sbi_rollout_sampler.SimRolloutSamplerForSBI" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#pyrado.sampling.sbi_rollout_sampler.RolloutSamplerForSBI" title="pyrado.sampling.sbi_rollout_sampler.RolloutSamplerForSBI"><code class="xref py py-class docutils literal notranslate"><span class="pre">RolloutSamplerForSBI</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Serializable</span></code></p>
<p>Wrapper to make SimuRLacra’s simulation environments usable as simulators for the sbi package</p>
<p>Constructor</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>env</strong> – environment which the policy operates, which must not be a randomized environment since we want to
randomize it manually via the domain parameters coming from the sbi package</p></li>
<li><p><strong>policy</strong> – policy used for sampling the rollout</p></li>
<li><p><strong>dp_mapping</strong> – mapping from subsequent integers (starting at 0) to domain parameter names (e.g. mass)</p></li>
<li><p><strong>embedding</strong> – embedding used for pre-processing the data before (later) passing it to the posterior</p></li>
<li><p><strong>num_segments</strong> – number of segments in which the rollouts are split into. For every segment, the initial
state of the simulation is reset, and thus for every set the features of the trajectories
are computed separately. Either specify <cite>num_segments</cite> or <cite>len_segments</cite>.</p></li>
<li><p><strong>len_segments</strong> – length of the segments in which the rollouts are split into. For every segment, the initial
state of the simulation is reset, and thus for every set the features of the trajectories
are computed separately. Either specify <cite>num_segments</cite> or <cite>len_segments</cite>.</p></li>
<li><p><strong>stop_on_done</strong> – if <cite>True</cite>, the rollouts are stopped as soon as they hit the state or observation space
boundaries. This behavior is save, but can lead to short trajectories which are eventually
padded with zeroes. Chose <cite>False</cite> to ignore the boundaries (dangerous on the real system).</p></li>
<li><p><strong>rollouts_real</strong> – list of rollouts recorded from the target domain, which are used to sync the simulations’
initial states</p></li>
<li><p><strong>use_rec_act</strong> – if <cite>True</cite> the recorded actions form the target domain are used to generate the rollout
during simulation (feed-forward). If <cite>False</cite> there policy is used to generate (potentially)
state-dependent actions (feed-back).</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyrado.sampling.sbi_rollout_sampler.check_domain_params">
<span class="sig-name descname"><span class="pre">check_domain_params</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rollouts</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#pyrado.sampling.step_sequence.StepSequence" title="pyrado.sampling.step_sequence.StepSequence"><span class="pre">StepSequence</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#pyrado.sampling.step_sequence.StepSequence" title="pyrado.sampling.step_sequence.StepSequence"><span class="pre">StepSequence</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">domain_param_value</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">domain_param_names</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ValuesView</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/sampling/sbi_rollout_sampler.html#check_domain_params"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.sampling.sbi_rollout_sampler.check_domain_params" title="Permalink to this definition"></a></dt>
<dd><p>Verify if the domain parameters in the rollout are actually the ones commanded.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>rollouts</strong> – simulated rollouts or rollout segments</p></li>
<li><p><strong>domain_param_value</strong> – one set of domain parameters as commanded</p></li>
<li><p><strong>domain_param_names</strong> – names of the domain parameters to set, i.e. values of the domain parameter mapping</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-pyrado.sampling.sequences">
<span id="sequences"></span><h2>sequences<a class="headerlink" href="#module-pyrado.sampling.sequences" title="Permalink to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="pyrado.sampling.sequences.sequence">
<span class="sig-name descname"><span class="pre">sequence</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x_init</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">iterations</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">iterator_function</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype=&lt;class</span> <span class="pre">'int'&gt;</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/sampling/sequences.html#sequence"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.sampling.sequences.sequence" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyrado.sampling.sequences.sequence_add_init">
<span class="sig-name descname"><span class="pre">sequence_add_init</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x_init</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">iter</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype=&lt;class</span> <span class="pre">'int'&gt;</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/sampling/sequences.html#sequence_add_init"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.sampling.sequences.sequence_add_init" title="Permalink to this definition"></a></dt>
<dd><p>Mathematical sequence: x_n = x_0 * n</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x_init</strong> – initial values of the sequence</p></li>
<li><p><strong>iter</strong> – iteration until the sequence should be evaluated</p></li>
<li><p><strong>dtype</strong> – data type to cast to (either int of float)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>element at the given iteration and array of the whole sequence</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyrado.sampling.sequences.sequence_const">
<span class="sig-name descname"><span class="pre">sequence_const</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x_init</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">iter</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype=&lt;class</span> <span class="pre">'int'&gt;</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/sampling/sequences.html#sequence_const"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.sampling.sequences.sequence_const" title="Permalink to this definition"></a></dt>
<dd><p>Mathematical sequence: x_n = x_0</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x_init</strong> – constant values of the sequence</p></li>
<li><p><strong>iter</strong> – iteration until the sequence should be evaluated</p></li>
<li><p><strong>dtype</strong> – data type to cast to (either int of float)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>element at the given iteration and array of the whole sequence</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyrado.sampling.sequences.sequence_nlog2">
<span class="sig-name descname"><span class="pre">sequence_nlog2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x_init</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">iter</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype=&lt;class</span> <span class="pre">'int'&gt;</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/sampling/sequences.html#sequence_nlog2"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.sampling.sequences.sequence_nlog2" title="Permalink to this definition"></a></dt>
<dd><p>Mathematical sequence: x_n = x_0 * n * log2(n+2), with log2 being the base 2 logarithm</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x_init</strong> – initial values of the sequence</p></li>
<li><p><strong>iter</strong> – iteration until the sequence should be evaluated</p></li>
<li><p><strong>dtype</strong> – data type to cast to (either int of float)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>element at the given iteration and array of the whole sequence</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyrado.sampling.sequences.sequence_plus_one">
<span class="sig-name descname"><span class="pre">sequence_plus_one</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x_init</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">iter</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype=&lt;class</span> <span class="pre">'int'&gt;</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/sampling/sequences.html#sequence_plus_one"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.sampling.sequences.sequence_plus_one" title="Permalink to this definition"></a></dt>
<dd><p>Mathematical sequence: x_n = x_0 + n</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x_init</strong> – initial values of the sequence</p></li>
<li><p><strong>iter</strong> – iteration until the sequence should be evaluated</p></li>
<li><p><strong>dtype</strong> – data type to cast to (either int of float)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>element at the given iteration and array of the whole sequence</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyrado.sampling.sequences.sequence_rec_double">
<span class="sig-name descname"><span class="pre">sequence_rec_double</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x_init</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">iter</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype=&lt;class</span> <span class="pre">'int'&gt;</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/sampling/sequences.html#sequence_rec_double"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.sampling.sequences.sequence_rec_double" title="Permalink to this definition"></a></dt>
<dd><p>Mathematical sequence: x_n = x_{n-1} * 2</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x_init</strong> – initial values of the sequence</p></li>
<li><p><strong>iter</strong> – iteration until the sequence should be evaluated</p></li>
<li><p><strong>dtype</strong> – data type to cast to (either int of float)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>element at the given iteration and array of the whole sequence</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyrado.sampling.sequences.sequence_rec_sqrt">
<span class="sig-name descname"><span class="pre">sequence_rec_sqrt</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x_init</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">iter</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype=&lt;class</span> <span class="pre">'int'&gt;</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/sampling/sequences.html#sequence_rec_sqrt"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.sampling.sequences.sequence_rec_sqrt" title="Permalink to this definition"></a></dt>
<dd><p>Mathematical sequence: x_n = x_{n-1} * sqrt(n)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x_init</strong> – initial values of the sequence</p></li>
<li><p><strong>iter</strong> – iteration until the sequence should be evaluated</p></li>
<li><p><strong>dtype</strong> – data type to cast to (either int of float)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>element at the given iteration and array of the whole sequence</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyrado.sampling.sequences.sequence_sqrt">
<span class="sig-name descname"><span class="pre">sequence_sqrt</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x_init</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">iter</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype=&lt;class</span> <span class="pre">'int'&gt;</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/sampling/sequences.html#sequence_sqrt"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.sampling.sequences.sequence_sqrt" title="Permalink to this definition"></a></dt>
<dd><p>Mathematical sequence: x_n = x_0 * sqrt(n)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x_init</strong> – initial values of the sequence</p></li>
<li><p><strong>iter</strong> – iteration until the sequence should be evaluated</p></li>
<li><p><strong>dtype</strong> – data type to cast to (either int of float)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>element at the given iteration and array of the whole sequence</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-pyrado.sampling.step_sequence">
<span id="step-sequence"></span><h2>step_sequence<a class="headerlink" href="#module-pyrado.sampling.step_sequence" title="Permalink to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="pyrado.sampling.step_sequence.DictIndexProxy">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">DictIndexProxy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">obj</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">index</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/sampling/step_sequence.html#DictIndexProxy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.sampling.step_sequence.DictIndexProxy" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Views a slice through a dict of lists or tensors.</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="pyrado.sampling.step_sequence.Step">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">Step</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rollout</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">index</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/sampling/step_sequence.html#Step"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.sampling.step_sequence.Step" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#pyrado.sampling.step_sequence.DictIndexProxy" title="pyrado.sampling.step_sequence.DictIndexProxy"><code class="xref py py-class docutils literal notranslate"><span class="pre">DictIndexProxy</span></code></a></p>
<p>A single step in a rollout.</p>
<p>This object is a proxy, referring a specific index in the rollout. When querying an attribute from the step,
it will try to return the corresponding slice from the rollout. Additionally, one can prefix attributes with <cite>next_</cite>
to access the value for the next step, i.e. <cite>next_observations</cite> the observation made at the start of the next step.</p>
<p>Constructor</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>rollout</strong> – <cite>StepSequence</cite> object to which this step belongs</p></li>
<li><p><strong>index</strong> – index of this step in the rollout</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="pyrado.sampling.step_sequence.StepSequence">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">StepSequence</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">complete</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rollout_info</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_format</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">done</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">ndarray</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">continuous</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rollout_bounds</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rewards</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Sequence</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">observations</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Sequence</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">actions</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Sequence</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">data</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/sampling/step_sequence.html#StepSequence"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.sampling.step_sequence.StepSequence" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence</span></code>[<a class="reference internal" href="#pyrado.sampling.step_sequence.Step" title="pyrado.sampling.step_sequence.Step"><code class="xref py py-class docutils literal notranslate"><span class="pre">Step</span></code></a>]</p>
<p>A sequence of steps.</p>
<p>During the rollout, the values of different variables are recorded. This class provides efficient storage and
access for these values. The constructor accepts a list of step entries for each variable. For every step,
the list should contain a Tensor/ndarray of values for that step. The shape of these tensors must be the same for
all step entries. The passed tensors are then stacked, so that the first dimension is the step count.
Some values, like the observations, can have one more element then there are steps to encode the state after the
last step. Additionally, the step entries may be dicts to support keyed storage. A list of dicts is converted to
a dict of lists, each of which will be regularly stacked. Apart from the variable-based view, the rollout can also
be seen as a sequence of steps. Each Step object is a proxy, it’s attributes refer to the respective slice of the
corresponding variable. The only required result variable are <cite>rewards</cite>, observations`, and <cite>actions</cite>.
All other variables are optional. Common optional ones are <cite>states</cite> and <cite>rollout_info</cite>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Storing PyTorch tensors with gradient tracing is NOT supported. The rationale behind this is eager error
avoidance. The only reason you would add them is to profit from the optimized slicing, but using that with
gradient tracking risks lingering incomplete graphs.</p>
</div>
<p>Constructor</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>complete</strong> – <cite>False</cite> if the rollout is incomplete, i.e. as part of a mini-batch</p></li>
<li><p><strong>rollout_info</strong> – data staying constant through the whole episode</p></li>
<li><p><strong>data_format</strong> – ‘torch’ to use Tensors, ‘numpy’ to use ndarrays.
Will use Tensors if any data argument does, else ndarrays</p></li>
<li><p><strong>done</strong> – boolean ndarray, specifying for each step whether it led to termination.
The last step of continuous rollouts, i.e. not mini-batches, is done if <cite>complete</cite> is <cite>True</cite>.</p></li>
<li><p><strong>continuous</strong> – true if the steps form one continuous sequence.</p></li>
<li><p><strong>rewards</strong> – sequence of reward values, determines sequence length</p></li>
<li><p><strong>observations</strong> – sequence of observation values, the length must be <cite>len(rewards) + 1</cite></p></li>
<li><p><strong>actions</strong> – sequence of action values, the length must be <cite>len(rewards)</cite></p></li>
<li><p><strong>data</strong> – additional data lists, their length must be <cite>len(rewards)</cite> or <cite>len(rewards) + 1</cite></p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="pyrado.sampling.step_sequence.StepSequence.actions">
<span class="sig-name descname"><span class="pre">actions</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Tensor</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#pyrado.sampling.step_sequence.StepSequence.actions" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyrado.sampling.step_sequence.StepSequence.add_data">
<span class="sig-name descname"><span class="pre">add_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">value</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">item_shape</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">tuple</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">with_after_last</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/sampling/step_sequence.html#StepSequence.add_data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.sampling.step_sequence.StepSequence.add_data" title="Permalink to this definition"></a></dt>
<dd><p>Add a new data field to the step sequence.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>name</strong> – string for the name</p></li>
<li><p><strong>value</strong> – the data</p></li>
<li><p><strong>item_shape</strong> – shape to store the data in</p></li>
<li><p><strong>with_after_last</strong> – <cite>True</cite> if there is one more element than the length (e.g. last observation)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyrado.sampling.step_sequence.StepSequence.concat">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">concat</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">parts</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Sequence</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#pyrado.sampling.step_sequence.StepSequence" title="pyrado.sampling.step_sequence.StepSequence"><span class="pre">StepSequence</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_format</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">truncate_last</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/sampling/step_sequence.html#StepSequence.concat"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.sampling.step_sequence.StepSequence.concat" title="Permalink to this definition"></a></dt>
<dd><p>Concatenate multiple step sequences into one, truncating the last observation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>parts</strong> – batch of sequences to concatenate</p></li>
<li><p><strong>data_format</strong> – torch to use Tensors, numpy to use ndarrays, <cite>None</cite> to choose automatically</p></li>
<li><p><strong>truncate_last</strong> – remove the last step from each part, highly recommended to be <cite>True</cite></p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>concatenated sequence of <cite>Steps</cite></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyrado.sampling.step_sequence.StepSequence.convert">
<span class="sig-name descname"><span class="pre">convert</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data_format</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/sampling/step_sequence.html#StepSequence.convert"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.sampling.step_sequence.StepSequence.convert" title="Permalink to this definition"></a></dt>
<dd><p>Convert data to specified format.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data_format</strong> – torch to use Tensors, numpy to use ndarrays</p></li>
<li><p><strong>data_type</strong> – optional torch/numpy dtype for data. When <cite>None</cite> is passed, the data type is left unchanged.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="pyrado.sampling.step_sequence.StepSequence.data_format">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">data_format</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span></em><a class="headerlink" href="#pyrado.sampling.step_sequence.StepSequence.data_format" title="Permalink to this definition"></a></dt>
<dd><p>Get the name of data format (‘torch’ or ‘numpy’).</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="pyrado.sampling.step_sequence.StepSequence.data_names">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">data_names</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Sequence</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#pyrado.sampling.step_sequence.StepSequence.data_names" title="Permalink to this definition"></a></dt>
<dd><p>Get the list of data attribute names.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyrado.sampling.step_sequence.StepSequence.discounted_return">
<span class="sig-name descname"><span class="pre">discounted_return</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">gamma:</span> <span class="pre">float)</span> <span class="pre">-&gt;</span> <span class="pre">(&lt;class</span> <span class="pre">'torch.Tensor'&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">&lt;class</span> <span class="pre">'numpy.ndarray'&gt;</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/sampling/step_sequence.html#StepSequence.discounted_return"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.sampling.step_sequence.StepSequence.discounted_return" title="Permalink to this definition"></a></dt>
<dd><p>Compute the discounted return.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>gamma</strong> – temporal discount factor</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>exponentially weighted sum of rewards</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyrado.sampling.step_sequence.StepSequence.from_pandas">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">from_pandas</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataFrame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">env_spec</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="utils.html#pyrado.utils.data_types.EnvSpec" title="pyrado.utils.data_types.EnvSpec"><span class="pre">EnvSpec</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">continuous</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">task</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="tasks.html#pyrado.tasks.base.Task" title="pyrado.tasks.base.Task"><span class="pre">Task</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#pyrado.sampling.step_sequence.StepSequence" title="pyrado.sampling.step_sequence.StepSequence"><span class="pre">StepSequence</span></a></span></span><a class="reference internal" href="_modules/pyrado/sampling/step_sequence.html#StepSequence.from_pandas"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.sampling.step_sequence.StepSequence.from_pandas" title="Permalink to this definition"></a></dt>
<dd><p>Generate a StepSequence object from a Pandas DataFrame instance.
Not all data fields are supported. The fields ‘rewards’ is mandatory.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>df</strong> – Pandas DataFrame holding the data in 1-dim arrays</p></li>
<li><p><strong>env_spec</strong> – environment specifications which labels are used to slice the DataFrame</p></li>
<li><p><strong>continuous</strong> – <cite>True</cite> if the rollout to be reconstructed was continuous</p></li>
<li><p><strong>task</strong> – task containing the reward function(s) that can be used to recompute the rewards from the recorded
observations and actions</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>new <cite>StepSequence</cite></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyrado.sampling.step_sequence.StepSequence.get_data_values">
<span class="sig-name descname"><span class="pre">get_data_values</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">truncate_last</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/sampling/step_sequence.html#StepSequence.get_data_values"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.sampling.step_sequence.StepSequence.get_data_values" title="Permalink to this definition"></a></dt>
<dd><p>Return the data tensor stored under the given name.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>name</strong> – data name</p></li>
<li><p><strong>truncate_last</strong> – True to truncate the length+1 entry if present</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyrado.sampling.step_sequence.StepSequence.get_rollout">
<span class="sig-name descname"><span class="pre">get_rollout</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">index</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/sampling/step_sequence.html#StepSequence.get_rollout"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.sampling.step_sequence.StepSequence.get_rollout" title="Permalink to this definition"></a></dt>
<dd><p>Get an indexed sub-rollout.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>index</strong> – generic index of sub-rollout, negative values, slices and iterables are allowed</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>selected subset.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyrado.sampling.step_sequence.StepSequence.iterate_rollouts">
<span class="sig-name descname"><span class="pre">iterate_rollouts</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/sampling/step_sequence.html#StepSequence.iterate_rollouts"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.sampling.step_sequence.StepSequence.iterate_rollouts" title="Permalink to this definition"></a></dt>
<dd><p>Iterate over all sub-rollouts of a concatenated rollout.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="pyrado.sampling.step_sequence.StepSequence.length">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">length</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><a class="headerlink" href="#pyrado.sampling.step_sequence.StepSequence.length" title="Permalink to this definition"></a></dt>
<dd><p>Get the length of the rollout (does not include the final step).</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyrado.sampling.step_sequence.StepSequence.numpy">
<span class="sig-name descname"><span class="pre">numpy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/sampling/step_sequence.html#StepSequence.numpy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.sampling.step_sequence.StepSequence.numpy" title="Permalink to this definition"></a></dt>
<dd><p>Convert data to numpy <a href="#id5"><span class="problematic" id="id6">`</span></a>ndarray.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>data_type</strong> – type to return data in. When None is passed, the data type is left unchanged.</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pyrado.sampling.step_sequence.StepSequence.observations">
<span class="sig-name descname"><span class="pre">observations</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Tensor</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#pyrado.sampling.step_sequence.StepSequence.observations" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyrado.sampling.step_sequence.StepSequence.pad">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">pad</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rollout</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#pyrado.sampling.step_sequence.StepSequence" title="pyrado.sampling.step_sequence.StepSequence"><span class="pre">StepSequence</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">len_to_pad_to</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pad_value</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/sampling/step_sequence.html#StepSequence.pad"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.sampling.step_sequence.StepSequence.pad" title="Permalink to this definition"></a></dt>
<dd><p>Add steps to the end of a given rollout. The entires of the steps are filled with <cite>pad_value</cite>.
So far, only numpy arrays and PyTorch tensors are padded (see <cite>data_format</cite>).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>rollout</strong> – rollout to be padded, modified in-place</p></li>
<li><p><strong>len_to_pad_to</strong> – length of the resulting rollout (without the final state)</p></li>
<li><p><strong>pad_value</strong> – scalar value to pad with</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyrado.sampling.step_sequence.StepSequence.process_data">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">process_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rollout:</span> <span class="pre">~pyrado.sampling.step_sequence.StepSequence</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fcn:</span> <span class="pre">~typing.Callable</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fcn_arg_name:</span> <span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fcn_arg_types:</span> <span class="pre">~typing.Union[type</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">~typing.Tuple[type]]</span> <span class="pre">=</span> <span class="pre">&lt;class</span> <span class="pre">'numpy.ndarray'&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">include_fields:</span> <span class="pre">~typing.Optional[~typing.Sequence[str]]</span> <span class="pre">=</span> <span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">exclude_fields:</span> <span class="pre">~typing.Optional[~typing.Sequence[str]]</span> <span class="pre">=</span> <span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">**process_fcn_kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/sampling/step_sequence.html#StepSequence.process_data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.sampling.step_sequence.StepSequence.process_data" title="Permalink to this definition"></a></dt>
<dd><p>Process all data fields of a rollouts using an arbitrary function. Optionally, some fields can be excluded.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>rollout</strong> – <cite>StepSequence</cite> holding the data</p></li>
<li><p><strong>fcn</strong> – function (of one remaining input) to used manipulate the data fields, e.g. <cite>scipy.filtfilt()</cite></p></li>
<li><p><strong>fcn_arg_name</strong> – sting of the remaining input of <cite>process_fcn()</cite>, e.g. <cite>x</cite> for <cite>scipy.filtfilt()</cite></p></li>
<li><p><strong>fcn_arg_types</strong> – type or tuple thereof which are expected as input to <cite>fcn()</cite></p></li>
<li><p><strong>include_fields</strong> – list of field names to include for processing, pass <cite>None</cite> to not include everything.
If specified, only fields from this selection will be considered</p></li>
<li><p><strong>exclude_fields</strong> – list of field names to exclude from processing, pass <cite>None</cite> to not exclude anything</p></li>
<li><p><strong>process_fcn_kwargs</strong> – keyword arguments forwarded to <cite>process_fcn()</cite></p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>new <cite>StepSequence</cite> instance with processed data</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pyrado.sampling.step_sequence.StepSequence.required_fields">
<span class="sig-name descname"><span class="pre">required_fields</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">{}</span></em><a class="headerlink" href="#pyrado.sampling.step_sequence.StepSequence.required_fields" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pyrado.sampling.step_sequence.StepSequence.rewards">
<span class="sig-name descname"><span class="pre">rewards</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Tensor</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#pyrado.sampling.step_sequence.StepSequence.rewards" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="pyrado.sampling.step_sequence.StepSequence.rollout_bounds">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">rollout_bounds</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">ndarray</span></em><a class="headerlink" href="#pyrado.sampling.step_sequence.StepSequence.rollout_bounds" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="pyrado.sampling.step_sequence.StepSequence.rollout_count">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">rollout_count</span></span><a class="headerlink" href="#pyrado.sampling.step_sequence.StepSequence.rollout_count" title="Permalink to this definition"></a></dt>
<dd><p>Count the number of sub-rollouts inside this step sequence.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="pyrado.sampling.step_sequence.StepSequence.rollout_lengths">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">rollout_lengths</span></span><a class="headerlink" href="#pyrado.sampling.step_sequence.StepSequence.rollout_lengths" title="Permalink to this definition"></a></dt>
<dd><p>Lengths of sub-rollouts.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyrado.sampling.step_sequence.StepSequence.sample_w_next">
<span class="sig-name descname"><span class="pre">sample_w_next</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">batch_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">tuple</span></span></span><a class="reference internal" href="_modules/pyrado/sampling/step_sequence.html#StepSequence.sample_w_next"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.sampling.step_sequence.StepSequence.sample_w_next" title="Permalink to this definition"></a></dt>
<dd><p>Sample a random batch of steps from a together with the associated next steps.
Similar to <cite>split_shuffled_batches</cite> with <cite>complete_rollouts=False</cite></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>batch_size</strong> – number of steps to sample</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>randomly sampled batch of steps</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyrado.sampling.step_sequence.StepSequence.split_ordered_batches">
<span class="sig-name descname"><span class="pre">split_ordered_batches</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">batch_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_batches</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/sampling/step_sequence.html#StepSequence.split_ordered_batches"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.sampling.step_sequence.StepSequence.split_ordered_batches" title="Permalink to this definition"></a></dt>
<dd><p>Batch generation. Split the step collection into ordered mini-batches of size batch_size.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>batch_size</strong> – number of steps per batch, i.e. variable number of batches</p></li>
<li><p><strong>num_batches</strong> – number of batches to split the rollout in, i.e. variable batch size</p></li>
</ul>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Left out the option to return complete rollouts like for <cite>split_shuffled_batches</cite>.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyrado.sampling.step_sequence.StepSequence.split_shuffled_batches">
<span class="sig-name descname"><span class="pre">split_shuffled_batches</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">batch_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">complete_rollouts</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/sampling/step_sequence.html#StepSequence.split_shuffled_batches"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.sampling.step_sequence.StepSequence.split_shuffled_batches" title="Permalink to this definition"></a></dt>
<dd><p>Batch generation. Split the step collection into random mini-batches of size batch_size.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>batch_size</strong> – number of steps per batch</p></li>
<li><p><strong>complete_rollouts</strong> – if <cite>complete_rollouts = True</cite>, the batches will not contain partial rollouts.
However, the size of the returned batches cannot be strictly maintained in this case.</p></li>
</ul>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This method is also supposed to be called for recurrent networks, which have a different <cite>evaluate()</cite>
method that recognized where the rollouts end within a batch.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyrado.sampling.step_sequence.StepSequence.torch">
<span class="sig-name descname"><span class="pre">torch</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/sampling/step_sequence.html#StepSequence.torch"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.sampling.step_sequence.StepSequence.torch" title="Permalink to this definition"></a></dt>
<dd><p>Convert data to PyTorch tensors.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>data_type</strong> – type to return data in. When None is passed, the data type is left unchanged.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyrado.sampling.step_sequence.StepSequence.undiscounted_return">
<span class="sig-name descname"><span class="pre">undiscounted_return</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">float</span></span></span><a class="reference internal" href="_modules/pyrado/sampling/step_sequence.html#StepSequence.undiscounted_return"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.sampling.step_sequence.StepSequence.undiscounted_return" title="Permalink to this definition"></a></dt>
<dd><p>Compute the undiscounted return.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>sum of rewards</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyrado.sampling.step_sequence.check_act_equal">
<span class="sig-name descname"><span class="pre">check_act_equal</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rollout_1</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#pyrado.sampling.step_sequence.StepSequence" title="pyrado.sampling.step_sequence.StepSequence"><span class="pre">StepSequence</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#pyrado.sampling.step_sequence.StepSequence" title="pyrado.sampling.step_sequence.StepSequence"><span class="pre">StepSequence</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rollout_2</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#pyrado.sampling.step_sequence.StepSequence" title="pyrado.sampling.step_sequence.StepSequence"><span class="pre">StepSequence</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#pyrado.sampling.step_sequence.StepSequence" title="pyrado.sampling.step_sequence.StepSequence"><span class="pre">StepSequence</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">check_applied</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/sampling/step_sequence.html#check_act_equal"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.sampling.step_sequence.check_act_equal" title="Permalink to this definition"></a></dt>
<dd><p>Check if the actions of two rollouts or pairwise two rollouts in in two lists are approximately the same</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>rollout_1</strong> – rollouts or list of rollouts</p></li>
<li><p><strong>rollout_2</strong> – rollouts or list of rollouts</p></li>
<li><p><strong>check_applied</strong> – if <cite>True</cite> check the actions applied to the environment instead of the commanded ones</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><cite>True</cite> if the actions match</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyrado.sampling.step_sequence.discounted_reverse_cumsum">
<span class="sig-name descname"><span class="pre">discounted_reverse_cumsum</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gamma</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/sampling/step_sequence.html#discounted_reverse_cumsum"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.sampling.step_sequence.discounted_reverse_cumsum" title="Permalink to this definition"></a></dt>
<dd><p>Use a linear filter to compute the reverse discounted cumulative sum.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><cite>scipy.signal.lfilter</cite> assumes an initialization with 0 by default.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> – input data with samples along the 0 axis (e.g. time series)</p></li>
<li><p><strong>gamma</strong> – discount factor</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>cumulative sums for every step</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyrado.sampling.step_sequence.discounted_value">
<span class="sig-name descname"><span class="pre">discounted_value</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rollout</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#pyrado.sampling.step_sequence.StepSequence" title="pyrado.sampling.step_sequence.StepSequence"><span class="pre">StepSequence</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">gamma</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/sampling/step_sequence.html#discounted_value"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.sampling.step_sequence.discounted_value" title="Permalink to this definition"></a></dt>
<dd><p>Compute the discounted state values for one rollout.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>rollout</strong> – input data</p></li>
<li><p><strong>gamma</strong> – temporal discount factor</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>state values for every time step in the rollout</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyrado.sampling.step_sequence.discounted_values">
<span class="sig-name descname"><span class="pre">discounted_values</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rollouts</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Sequence</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#pyrado.sampling.step_sequence.StepSequence" title="pyrado.sampling.step_sequence.StepSequence"><span class="pre">StepSequence</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gamma</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_format</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'torch'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/sampling/step_sequence.html#discounted_values"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.sampling.step_sequence.discounted_values" title="Permalink to this definition"></a></dt>
<dd><p>Compute the discounted state values for multiple rollouts.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>rollouts</strong> – input data</p></li>
<li><p><strong>gamma</strong> – temporal discount factor</p></li>
<li><p><strong>data_format</strong> – data format of the given</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>state values for every time step in the rollouts (concatenated sequence across rollouts)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyrado.sampling.step_sequence.gae_returns">
<span class="sig-name descname"><span class="pre">gae_returns</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rollout</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#pyrado.sampling.step_sequence.StepSequence" title="pyrado.sampling.step_sequence.StepSequence"><span class="pre">StepSequence</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">gamma</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.99</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lamb</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.95</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/sampling/step_sequence.html#gae_returns"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.sampling.step_sequence.gae_returns" title="Permalink to this definition"></a></dt>
<dd><p>Compute returns using generalized advantage estimation.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p>[1] J. Schulmann, P. Moritz, S. Levine, M. Jordan, P. Abbeel, ‘High-Dimensional Continuous Control Using
Generalized Advantage Estimation’, ICLR 2016</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>rollout</strong> – sequence of steps</p></li>
<li><p><strong>gamma</strong> – temporal discount factor</p></li>
<li><p><strong>lamb</strong> – discount factor</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>estimated advantage</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-pyrado.sampling.utils">
<span id="utils"></span><h2>utils<a class="headerlink" href="#module-pyrado.sampling.utils" title="Permalink to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="pyrado.sampling.utils.gen_ordered_batch_idcs">
<span class="sig-name descname"><span class="pre">gen_ordered_batch_idcs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">batch_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sorted</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/sampling/utils.html#gen_ordered_batch_idcs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.sampling.utils.gen_ordered_batch_idcs" title="Permalink to this definition"></a></dt>
<dd><p>Helper function for doing SGD on mini-batches that returns the indies for the mini-batch samples</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>batch_size</strong> – number of samples in each mini-batch</p></li>
<li><p><strong>data_size</strong> – total number of samples</p></li>
<li><p><strong>sorted</strong> – if <cite>False</cite>, the order of batches is randomized (but the order within them is preserved)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>generator for lists of random indices of sub-samples</p>
</dd>
<dt class="field-odd">Usage</dt>
<dd class="field-odd"><p>If num_rollouts = 2, data_size = 5 and sorted = False, then the output might be ((2, 3), (0, 1), (4,))
If num_rollouts = 2, data_size = 5 and sorted = True, then the output will be ((0, 1), (2, 3), (4,))</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyrado.sampling.utils.gen_ordered_batches">
<span class="sig-name descname"><span class="pre">gen_ordered_batches</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inp</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Iterable</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/sampling/utils.html#gen_ordered_batches"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.sampling.utils.gen_ordered_batches" title="Permalink to this definition"></a></dt>
<dd><p>Helper function that cuts the input into equal sized chunks</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>inp</strong> – iterable input</p></li>
<li><p><strong>batch_size</strong> – number of samples in each mini-batch</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>iterator over the input</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyrado.sampling.utils.gen_shuffled_batch_idcs">
<span class="sig-name descname"><span class="pre">gen_shuffled_batch_idcs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">batch_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/sampling/utils.html#gen_shuffled_batch_idcs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.sampling.utils.gen_shuffled_batch_idcs" title="Permalink to this definition"></a></dt>
<dd><p>Helper function for doing SGD on mini-batches that returns the indies for the mini-batch samples</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>batch_size</strong> – number of samples in each mini-batch</p></li>
<li><p><strong>data_size</strong> – total number of samples</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>generator for lists of random indices of sub-samples</p>
</dd>
<dt class="field-odd">Usage</dt>
<dd class="field-odd"><p>If num_rollouts = 2 and data_size = 5, then the output might be ((0, 3), (2, 1), (4,))</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyrado.sampling.utils.shuffled_ordered_batches">
<span class="sig-name descname"><span class="pre">shuffled_ordered_batches</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inp</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Iterable</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/sampling/utils.html#shuffled_ordered_batches"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.sampling.utils.shuffled_ordered_batches" title="Permalink to this definition"></a></dt>
<dd><p>Helper function that cuts the input into equal sized chunks with the original ordering, but shuffled order among the
chunks</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>inp</strong> – iterable input</p></li>
<li><p><strong>batch_size</strong> – number of samples in each mini-batch</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>list of randomly ordered mini-batches which within themselves have the original ordering</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-pyrado.sampling">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-pyrado.sampling" title="Permalink to this heading"></a></h2>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="tasks.html" class="btn btn-neutral float-left" title="tasks" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="plotting.html" class="btn btn-neutral float-right" title="plotting" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2020.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>