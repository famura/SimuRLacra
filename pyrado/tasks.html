<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>tasks &mdash; Pyrado 0.7 documentation</title>
      <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="_static/graphviz.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="sampling" href="sampling.html" />
    <link rel="prev" title="spaces" href="spaces.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="index.html" class="icon icon-home"> Pyrado
          </a>
              <div class="version">
                0.7
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Examples:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="examples/1_basic_experiment.html">How to run an experiment</a></li>
<li class="toctree-l1"><a class="reference internal" href="examples/2_wrapping_environments.html">How to wrap an environment</a></li>
<li class="toctree-l1"><a class="reference internal" href="examples/3_algorithm_skeleton.html">How to create an algorithm</a></li>
<li class="toctree-l1"><a class="reference internal" href="examples/4_creating_rcspysim_environments.html">How to create an RcsPySim environment</a></li>
<li class="toctree-l1"><a class="reference internal" href="examples/5_panda3d_visualization.html"><strong>How to create a visualization</strong></a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Environments:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="environments.html">environments</a></li>
<li class="toctree-l1"><a class="reference internal" href="environments.barrett_wam.html">barrett_wam</a></li>
<li class="toctree-l1"><a class="reference internal" href="environments.mujoco.html">mujoco</a></li>
<li class="toctree-l1"><a class="reference internal" href="environments.pysim.html">pysim</a></li>
<li class="toctree-l1"><a class="reference internal" href="environments.quanser.html">quanser</a></li>
<li class="toctree-l1"><a class="reference internal" href="environments.rcspysim.html">rcspysim</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Environment Wrappers:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="environment_wrappers.html">environment_wrappers</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Domain Randomization:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="domain_randomization.html">domain_randomization</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Algorithms:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="algorithms.html">algorithms</a></li>
<li class="toctree-l1"><a class="reference internal" href="algorithms.episodic.html">episodic</a></li>
<li class="toctree-l1"><a class="reference internal" href="algorithms.step_based.html">step_based</a></li>
<li class="toctree-l1"><a class="reference internal" href="algorithms.meta.html">meta</a></li>
<li class="toctree-l1"><a class="reference internal" href="algorithms.regression.html">regression</a></li>
<li class="toctree-l1"><a class="reference internal" href="algorithms.stopping_criteria.html">stopping_criteria</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Exploration:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="exploration.html">exploration</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Policies:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="policies.html">policies</a></li>
<li class="toctree-l1"><a class="reference internal" href="policies.feed_back.html">feed_back</a></li>
<li class="toctree-l1"><a class="reference internal" href="policies.feed_forward.html">feed_forward</a></li>
<li class="toctree-l1"><a class="reference internal" href="policies.recurrent.html">recurrent</a></li>
<li class="toctree-l1"><a class="reference internal" href="policies.special.html">special</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Spaces:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="spaces.html">spaces</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Tasks &amp; Rewards:</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">tasks</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#module-pyrado.tasks.base">base</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-pyrado.tasks.condition_only">condition_only</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-pyrado.tasks.desired_space">desired_space</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-pyrado.tasks.desired_state">desired_state</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-pyrado.tasks.endless_flipping">endless_flipping</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-pyrado.tasks.final_reward">final_reward</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-pyrado.tasks.goalless">goalless</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-pyrado.tasks.masked">masked</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-pyrado.tasks.parallel">parallel</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-pyrado.tasks.predefined">predefined</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-pyrado.tasks.reward_functions">reward_functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-pyrado.tasks.sequential">sequential</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-pyrado.tasks.utils">utils</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-pyrado.tasks">Module contents</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Sampling:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="sampling.html">sampling</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Plotting:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="plotting.html">plotting</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Utilities:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="utils.html">utils</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Pyrado</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
      <li>tasks</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/tasks.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="tasks">
<h1>tasks<a class="headerlink" href="#tasks" title="Permalink to this headline"></a></h1>
<section id="module-pyrado.tasks.base">
<span id="base"></span><h2>base<a class="headerlink" href="#module-pyrado.tasks.base" title="Permalink to this headline"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="pyrado.tasks.base.Task">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">Task</span></span><a class="reference internal" href="_modules/pyrado/tasks/base.html#Task"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.tasks.base.Task" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">abc.ABC</span></code></p>
<p>Base class for all tasks in Pyrado.
A task contains a desired state, a reward function, and a step function.
The task also checks if the environment is done. Every environment should have exactly one task at a time.</p>
<dl class="py method">
<dt class="sig sig-object py" id="pyrado.tasks.base.Task.compute_final_rew">
<span class="sig-name descname"><span class="pre">compute_final_rew</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">numpy.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">remaining_steps</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">float</span></span></span><a class="reference internal" href="_modules/pyrado/tasks/base.html#Task.compute_final_rew"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.tasks.base.Task.compute_final_rew" title="Permalink to this definition"></a></dt>
<dd><p>Compute the final reward, e.g. bonus for success or a malus for failure, for a single task.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This function should only be overwritten by tasks that manipulate the final reward.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>state</strong> – current state</p></li>
<li><p><strong>remaining_steps</strong> – number of time steps left in the episode</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>final reward</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="pyrado.tasks.base.Task.env_spec">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">env_spec</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="utils.html#pyrado.utils.data_types.EnvSpec" title="pyrado.utils.data_types.EnvSpec"><span class="pre">pyrado.utils.data_types.EnvSpec</span></a></em><a class="headerlink" href="#pyrado.tasks.base.Task.env_spec" title="Permalink to this definition"></a></dt>
<dd><p>Get the specification of environment the task is in.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyrado.tasks.base.Task.final_rew">
<span class="sig-name descname"><span class="pre">final_rew</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">numpy.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">remaining_steps</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">float</span></span></span><a class="reference internal" href="_modules/pyrado/tasks/base.html#Task.final_rew"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.tasks.base.Task.final_rew" title="Permalink to this definition"></a></dt>
<dd><p>Get the final reward, e.g. bonus for success or a malus for failure.
This function loops through all tasks (unfolding the wrappers) and calls their <cite>compute_final_rew</cite> method.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>state</strong> – current state forwarded to <cite>compute_final_rew</cite></p></li>
<li><p><strong>remaining_steps</strong> – number of time steps left in the episode forwarded to <cite>compute_final_rew</cite></p></li>
</ul>
</dd>
<dt class="field-even">Return rew</dt>
<dd class="field-even"><p>summed final reward</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyrado.tasks.base.Task.has_failed">
<span class="sig-name descname"><span class="pre">has_failed</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">numpy.ndarray</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">bool</span></span></span><a class="reference internal" href="_modules/pyrado/tasks/base.html#Task.has_failed"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.tasks.base.Task.has_failed" title="Permalink to this definition"></a></dt>
<dd><p>Check the environment if the agent failed.
The default implementation checks if the state is out of bounds.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>state</strong> – environments current state</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><cite>True</cite> if failed</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyrado.tasks.base.Task.has_succeeded">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">has_succeeded</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">numpy.ndarray</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">bool</span></span></span><a class="reference internal" href="_modules/pyrado/tasks/base.html#Task.has_succeeded"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.tasks.base.Task.has_succeeded" title="Permalink to this definition"></a></dt>
<dd><p>Check the environment if the agent succeeded.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>state</strong> – environments current state</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><cite>True</cite> if succeeded</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyrado.tasks.base.Task.is_done">
<span class="sig-name descname"><span class="pre">is_done</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">numpy.ndarray</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">bool</span></span></span><a class="reference internal" href="_modules/pyrado/tasks/base.html#Task.is_done"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.tasks.base.Task.is_done" title="Permalink to this definition"></a></dt>
<dd><p>Check if a final state is reached.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>It is strongly recommended to call this method every environment step.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>state</strong> – current state</p></li>
<li><p><strong>act</strong> – current action</p></li>
</ul>
</dd>
<dt class="field-even">Return done</dt>
<dd class="field-even"><p>done flag</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyrado.tasks.base.Task.reset">
<span class="sig-name descname"><span class="pre">reset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/tasks/base.html#Task.reset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.tasks.base.Task.reset" title="Permalink to this definition"></a></dt>
<dd><p>Reset the task.
Since the environment specification may change at every reset of the environment, we have to reset the task.
This might also include resetting the members of the reward function if there are any.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>kwargs</strong> – optional arguments e.g. environment specification or new desired state</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="pyrado.tasks.base.Task.rew_fcn">
<em class="property"><span class="pre">abstract</span><span class="w"> </span><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">rew_fcn</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="#pyrado.tasks.reward_functions.RewFcn" title="pyrado.tasks.reward_functions.RewFcn"><span class="pre">pyrado.tasks.reward_functions.RewFcn</span></a></em><a class="headerlink" href="#pyrado.tasks.base.Task.rew_fcn" title="Permalink to this definition"></a></dt>
<dd><p>Get the reward function.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="pyrado.tasks.base.Task.space_des">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">space_des</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="spaces.html#pyrado.spaces.base.Space" title="pyrado.spaces.base.Space"><span class="pre">pyrado.spaces.base.Space</span></a></em><a class="headerlink" href="#pyrado.tasks.base.Task.space_des" title="Permalink to this definition"></a></dt>
<dd><p>Get the desired state (same dimensions as the environment’s state).
Only override this if the task has a desired state.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="pyrado.tasks.base.Task.state_des">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">state_des</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">numpy.ndarray</span></em><a class="headerlink" href="#pyrado.tasks.base.Task.state_des" title="Permalink to this definition"></a></dt>
<dd><p>Get the desired state (same dimensions as the environment’s state).
Only override this if the task has a desired state.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyrado.tasks.base.Task.step_rew">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">step_rew</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">numpy.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">act</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">numpy.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">remaining_steps</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">float</span></span></span><a class="reference internal" href="_modules/pyrado/tasks/base.html#Task.step_rew"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.tasks.base.Task.step_rew" title="Permalink to this definition"></a></dt>
<dd><p>Get the step reward, e.g. from a function of the states and actions.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>It is strongly recommended to call this method every environment step.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>state</strong> – current state</p></li>
<li><p><strong>act</strong> – current action</p></li>
<li><p><strong>remaining_steps</strong> – number of time steps left in the episode</p></li>
</ul>
</dd>
<dt class="field-even">Return rew</dt>
<dd class="field-even"><p>current reward</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="pyrado.tasks.base.TaskWrapper">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">TaskWrapper</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">wrapped_task</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#pyrado.tasks.base.Task" title="pyrado.tasks.base.Task"><span class="pre">pyrado.tasks.base.Task</span></a></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/tasks/base.html#TaskWrapper"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.tasks.base.TaskWrapper" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#pyrado.tasks.base.Task" title="pyrado.tasks.base.Task"><code class="xref py py-class docutils literal notranslate"><span class="pre">pyrado.tasks.base.Task</span></code></a></p>
<p>Base for all task wrappers. Delegates all environment methods to the wrapped environment.</p>
<p>Constructor</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>wrapped_task</strong> – task to wrap</p>
</dd>
</dl>
<dl class="py property">
<dt class="sig sig-object py" id="pyrado.tasks.base.TaskWrapper.env_spec">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">env_spec</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="utils.html#pyrado.utils.data_types.EnvSpec" title="pyrado.utils.data_types.EnvSpec"><span class="pre">pyrado.utils.data_types.EnvSpec</span></a></em><a class="headerlink" href="#pyrado.tasks.base.TaskWrapper.env_spec" title="Permalink to this definition"></a></dt>
<dd><p>Get the specification of environment the task is in.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyrado.tasks.base.TaskWrapper.has_failed">
<span class="sig-name descname"><span class="pre">has_failed</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">numpy.ndarray</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">bool</span></span></span><a class="reference internal" href="_modules/pyrado/tasks/base.html#TaskWrapper.has_failed"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.tasks.base.TaskWrapper.has_failed" title="Permalink to this definition"></a></dt>
<dd><p>Check the environment if the agent failed.
The default implementation checks if the state is out of bounds.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>state</strong> – environments current state</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><cite>True</cite> if failed</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyrado.tasks.base.TaskWrapper.has_succeeded">
<span class="sig-name descname"><span class="pre">has_succeeded</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">numpy.ndarray</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">bool</span></span></span><a class="reference internal" href="_modules/pyrado/tasks/base.html#TaskWrapper.has_succeeded"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.tasks.base.TaskWrapper.has_succeeded" title="Permalink to this definition"></a></dt>
<dd><p>Check the environment if the agent succeeded.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>state</strong> – environments current state</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><cite>True</cite> if succeeded</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyrado.tasks.base.TaskWrapper.is_done">
<span class="sig-name descname"><span class="pre">is_done</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">numpy.ndarray</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">bool</span></span></span><a class="reference internal" href="_modules/pyrado/tasks/base.html#TaskWrapper.is_done"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.tasks.base.TaskWrapper.is_done" title="Permalink to this definition"></a></dt>
<dd><p>Check if a final state is reached.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>It is strongly recommended to call this method every environment step.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>state</strong> – current state</p></li>
<li><p><strong>act</strong> – current action</p></li>
</ul>
</dd>
<dt class="field-even">Return done</dt>
<dd class="field-even"><p>done flag</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyrado.tasks.base.TaskWrapper.reset">
<span class="sig-name descname"><span class="pre">reset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/tasks/base.html#TaskWrapper.reset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.tasks.base.TaskWrapper.reset" title="Permalink to this definition"></a></dt>
<dd><p>Reset the task.
Since the environment specification may change at every reset of the environment, we have to reset the task.
This might also include resetting the members of the reward function if there are any.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>kwargs</strong> – optional arguments e.g. environment specification or new desired state</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="pyrado.tasks.base.TaskWrapper.rew_fcn">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">rew_fcn</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="#pyrado.tasks.reward_functions.RewFcn" title="pyrado.tasks.reward_functions.RewFcn"><span class="pre">pyrado.tasks.reward_functions.RewFcn</span></a></em><a class="headerlink" href="#pyrado.tasks.base.TaskWrapper.rew_fcn" title="Permalink to this definition"></a></dt>
<dd><p>Get the reward function.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="pyrado.tasks.base.TaskWrapper.space_des">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">space_des</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="spaces.html#pyrado.spaces.base.Space" title="pyrado.spaces.base.Space"><span class="pre">pyrado.spaces.base.Space</span></a></em><a class="headerlink" href="#pyrado.tasks.base.TaskWrapper.space_des" title="Permalink to this definition"></a></dt>
<dd><p>Get the desired state (same dimensions as the environment’s state).
Only override this if the task has a desired state.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="pyrado.tasks.base.TaskWrapper.state_des">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">state_des</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">numpy.ndarray</span></em><a class="headerlink" href="#pyrado.tasks.base.TaskWrapper.state_des" title="Permalink to this definition"></a></dt>
<dd><p>Get the desired state (same dimensions as the environment’s state).
Only override this if the task has a desired state.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyrado.tasks.base.TaskWrapper.step_rew">
<span class="sig-name descname"><span class="pre">step_rew</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">numpy.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">act</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">numpy.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">remaining_steps</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">float</span></span></span><a class="reference internal" href="_modules/pyrado/tasks/base.html#TaskWrapper.step_rew"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.tasks.base.TaskWrapper.step_rew" title="Permalink to this definition"></a></dt>
<dd><p>Get the step reward, e.g. from a function of the states and actions.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>It is strongly recommended to call this method every environment step.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>state</strong> – current state</p></li>
<li><p><strong>act</strong> – current action</p></li>
<li><p><strong>remaining_steps</strong> – number of time steps left in the episode</p></li>
</ul>
</dd>
<dt class="field-even">Return rew</dt>
<dd class="field-even"><p>current reward</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="pyrado.tasks.base.TaskWrapper.wrapped_task">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">wrapped_task</span></span><a class="headerlink" href="#pyrado.tasks.base.TaskWrapper.wrapped_task" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyrado.tasks.base.all_tasks">
<span class="sig-name descname"><span class="pre">all_tasks</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">task</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/tasks/base.html#all_tasks"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.tasks.base.all_tasks" title="Permalink to this definition"></a></dt>
<dd><p>Iterates over the task chain.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>task</strong> – outermost task of the chain</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>an iterable over the whole chain from outermost to innermost</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-pyrado.tasks.condition_only">
<span id="condition-only"></span><h2>condition_only<a class="headerlink" href="#module-pyrado.tasks.condition_only" title="Permalink to this headline"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="pyrado.tasks.condition_only.ConditionOnlyTask">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">ConditionOnlyTask</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">env_spec</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="utils.html#pyrado.utils.data_types.EnvSpec" title="pyrado.utils.data_types.EnvSpec"><span class="pre">pyrado.utils.data_types.EnvSpec</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">condition_fcn</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Callable</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">is_success_condition</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/tasks/condition_only.html#ConditionOnlyTask"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.tasks.condition_only.ConditionOnlyTask" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#pyrado.tasks.base.Task" title="pyrado.tasks.base.Task"><code class="xref py py-class docutils literal notranslate"><span class="pre">pyrado.tasks.base.Task</span></code></a></p>
<p>Task class which yields zero reward at every time and terminates if the given function is true.
This class is intended to be wrapped by <cite>FinalRewTask</cite>.</p>
<p>Constructor</p>
<dl class="field-list simple">
<dt class="field-odd">Usage</dt>
<dd class="field-odd"><p></p></dd>
</dl>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">task</span> <span class="o">=</span> <span class="n">FinalRewTask</span><span class="p">(</span>
           <span class="n">ConditionOnlyTask</span><span class="p">(</span><span class="o">&lt;</span><span class="n">some</span> <span class="n">EnvSpec</span><span class="o">&gt;</span><span class="p">,</span> <span class="o">&lt;</span><span class="n">some</span> <span class="n">Callable</span><span class="o">&gt;</span><span class="p">,</span> <span class="o">&lt;</span><span class="kc">True</span> <span class="ow">or</span> <span class="kc">False</span><span class="o">&gt;</span><span class="p">),</span>
           <span class="n">mode</span><span class="o">=</span><span class="n">FinalRewMode</span><span class="p">(</span><span class="n">time_dependent</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="p">)</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>env_spec</strong> – environment specification of a simulated or real environment</p></li>
<li><p><strong>condition_fcn</strong> – function to determine if the task was solved, by default (<cite>None</cite>) this task runs endlessly</p></li>
<li><p><strong>is_success_condition</strong> – if <cite>True</cite> the <cite>condition_fcn</cite> returns <cite>True</cite> for a success,
if <cite>False</cite> the <cite>condition_fcn</cite> returns <cite>True</cite> for a failure</p></li>
</ul>
</dd>
</dl>
<dl class="py property">
<dt class="sig sig-object py" id="pyrado.tasks.condition_only.ConditionOnlyTask.env_spec">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">env_spec</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="utils.html#pyrado.utils.data_types.EnvSpec" title="pyrado.utils.data_types.EnvSpec"><span class="pre">pyrado.utils.data_types.EnvSpec</span></a></em><a class="headerlink" href="#pyrado.tasks.condition_only.ConditionOnlyTask.env_spec" title="Permalink to this definition"></a></dt>
<dd><p>Get the specification of environment the task is in.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyrado.tasks.condition_only.ConditionOnlyTask.has_failed">
<span class="sig-name descname"><span class="pre">has_failed</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">numpy.ndarray</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">bool</span></span></span><a class="reference internal" href="_modules/pyrado/tasks/condition_only.html#ConditionOnlyTask.has_failed"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.tasks.condition_only.ConditionOnlyTask.has_failed" title="Permalink to this definition"></a></dt>
<dd><p>Check the environment if the agent failed.
The default implementation checks if the state is out of bounds.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>state</strong> – environments current state</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><cite>True</cite> if failed</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyrado.tasks.condition_only.ConditionOnlyTask.has_succeeded">
<span class="sig-name descname"><span class="pre">has_succeeded</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">numpy.ndarray</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">bool</span></span></span><a class="reference internal" href="_modules/pyrado/tasks/condition_only.html#ConditionOnlyTask.has_succeeded"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.tasks.condition_only.ConditionOnlyTask.has_succeeded" title="Permalink to this definition"></a></dt>
<dd><p>Check the environment if the agent succeeded.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>state</strong> – environments current state</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><cite>True</cite> if succeeded</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyrado.tasks.condition_only.ConditionOnlyTask.reset">
<span class="sig-name descname"><span class="pre">reset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">env_spec</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="utils.html#pyrado.utils.data_types.EnvSpec" title="pyrado.utils.data_types.EnvSpec"><span class="pre">pyrado.utils.data_types.EnvSpec</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">condition_fcn</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Callable</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">is_success_condition</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">bool</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/tasks/condition_only.html#ConditionOnlyTask.reset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.tasks.condition_only.ConditionOnlyTask.reset" title="Permalink to this definition"></a></dt>
<dd><p>Reset the task.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>env_spec</strong> – environment specification</p></li>
<li><p><strong>condition_fcn</strong> – function to determine if the task was solved, by default (<cite>None</cite>) this task runs endlessly</p></li>
<li><p><strong>is_success_condition</strong> – if <cite>True</cite> the <cite>condition_fcn</cite> returns <cite>True</cite> for a success,
if <cite>False</cite> the <cite>condition_fcn</cite> returns <cite>True</cite> for a failure</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="pyrado.tasks.condition_only.ConditionOnlyTask.rew_fcn">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">rew_fcn</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="#pyrado.tasks.reward_functions.RewFcn" title="pyrado.tasks.reward_functions.RewFcn"><span class="pre">pyrado.tasks.reward_functions.RewFcn</span></a></em><a class="headerlink" href="#pyrado.tasks.condition_only.ConditionOnlyTask.rew_fcn" title="Permalink to this definition"></a></dt>
<dd><p>Get the reward function.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyrado.tasks.condition_only.ConditionOnlyTask.step_rew">
<span class="sig-name descname"><span class="pre">step_rew</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">numpy.ndarray</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">act</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">numpy.ndarray</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">remaining_steps</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">float</span></span></span><a class="reference internal" href="_modules/pyrado/tasks/condition_only.html#ConditionOnlyTask.step_rew"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.tasks.condition_only.ConditionOnlyTask.step_rew" title="Permalink to this definition"></a></dt>
<dd><p>Get the step reward, e.g. from a function of the states and actions.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>It is strongly recommended to call this method every environment step.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>state</strong> – current state</p></li>
<li><p><strong>act</strong> – current action</p></li>
<li><p><strong>remaining_steps</strong> – number of time steps left in the episode</p></li>
</ul>
</dd>
<dt class="field-even">Return rew</dt>
<dd class="field-even"><p>current reward</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-pyrado.tasks.desired_space">
<span id="desired-space"></span><h2>desired_space<a class="headerlink" href="#module-pyrado.tasks.desired_space" title="Permalink to this headline"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="pyrado.tasks.desired_space.DesSpaceTask">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">DesSpaceTask</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">env_spec:</span> <span class="pre">pyrado.utils.data_types.EnvSpec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">space_des:</span> <span class="pre">pyrado.spaces.base.Space</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rew_fcn:</span> <span class="pre">pyrado.tasks.reward_functions.RewFcn</span> <span class="pre">=</span> <span class="pre">&lt;class</span> <span class="pre">'pyrado.tasks.reward_functions.ZeroPerStepRewFcn'&gt;</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/tasks/desired_space.html#DesSpaceTask"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.tasks.desired_space.DesSpaceTask" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#pyrado.tasks.base.Task" title="pyrado.tasks.base.Task"><code class="xref py py-class docutils literal notranslate"><span class="pre">pyrado.tasks.base.Task</span></code></a></p>
<p>Task class for moving to a (fixed) desired state space.
This task is designed with the idea in mind that it is only important if the state is in the desired (sub)space.
If the state is in the desired space, the <cite>done</cite> flag is raised. Until then, the step reward is returned.</p>
<p>Constructor</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>env_spec</strong> – environment specification of a simulated or real environment</p></li>
<li><p><strong>space_des</strong> – desired state a.k.a. goal state</p></li>
<li><p><strong>rew_fcn</strong> – reward function, an instance of a subclass of RewFcn</p></li>
</ul>
</dd>
</dl>
<dl class="py property">
<dt class="sig sig-object py" id="pyrado.tasks.desired_space.DesSpaceTask.env_spec">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">env_spec</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="utils.html#pyrado.utils.data_types.EnvSpec" title="pyrado.utils.data_types.EnvSpec"><span class="pre">pyrado.utils.data_types.EnvSpec</span></a></em><a class="headerlink" href="#pyrado.tasks.desired_space.DesSpaceTask.env_spec" title="Permalink to this definition"></a></dt>
<dd><p>Get the specification of environment the task is in.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyrado.tasks.desired_space.DesSpaceTask.has_succeeded">
<span class="sig-name descname"><span class="pre">has_succeeded</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">numpy.ndarray</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">bool</span></span></span><a class="reference internal" href="_modules/pyrado/tasks/desired_space.html#DesSpaceTask.has_succeeded"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.tasks.desired_space.DesSpaceTask.has_succeeded" title="Permalink to this definition"></a></dt>
<dd><p>Check the environment if the agent succeeded.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>state</strong> – environments current state</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><cite>True</cite> if succeeded</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyrado.tasks.desired_space.DesSpaceTask.reset">
<span class="sig-name descname"><span class="pre">reset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">env_spec</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="utils.html#pyrado.utils.data_types.EnvSpec" title="pyrado.utils.data_types.EnvSpec"><span class="pre">pyrado.utils.data_types.EnvSpec</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">space_des</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="spaces.html#pyrado.spaces.base.Space" title="pyrado.spaces.base.Space"><span class="pre">pyrado.spaces.base.Space</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/tasks/desired_space.html#DesSpaceTask.reset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.tasks.desired_space.DesSpaceTask.reset" title="Permalink to this definition"></a></dt>
<dd><p>Reset the task.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>env_spec</strong> – environment specification</p></li>
<li><p><strong>space_des</strong> – new desired state a.k.a. goal state</p></li>
<li><p><strong>kwargs</strong> – keyword arguments forwarded to the reward function, e.g. the initial state</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="pyrado.tasks.desired_space.DesSpaceTask.rew_fcn">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">rew_fcn</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="#pyrado.tasks.reward_functions.RewFcn" title="pyrado.tasks.reward_functions.RewFcn"><span class="pre">pyrado.tasks.reward_functions.RewFcn</span></a></em><a class="headerlink" href="#pyrado.tasks.desired_space.DesSpaceTask.rew_fcn" title="Permalink to this definition"></a></dt>
<dd><p>Get the reward function.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="pyrado.tasks.desired_space.DesSpaceTask.space_des">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">space_des</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="spaces.html#pyrado.spaces.base.Space" title="pyrado.spaces.base.Space"><span class="pre">pyrado.spaces.base.Space</span></a></em><a class="headerlink" href="#pyrado.tasks.desired_space.DesSpaceTask.space_des" title="Permalink to this definition"></a></dt>
<dd><p>Get the desired state (same dimensions as the environment’s state).
Only override this if the task has a desired state.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyrado.tasks.desired_space.DesSpaceTask.step_rew">
<span class="sig-name descname"><span class="pre">step_rew</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">numpy.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">act</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">numpy.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">remaining_steps</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">float</span></span></span><a class="reference internal" href="_modules/pyrado/tasks/desired_space.html#DesSpaceTask.step_rew"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.tasks.desired_space.DesSpaceTask.step_rew" title="Permalink to this definition"></a></dt>
<dd><p>Get the step reward, e.g. from a function of the states and actions.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>It is strongly recommended to call this method every environment step.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>state</strong> – current state</p></li>
<li><p><strong>act</strong> – current action</p></li>
<li><p><strong>remaining_steps</strong> – number of time steps left in the episode</p></li>
</ul>
</dd>
<dt class="field-even">Return rew</dt>
<dd class="field-even"><p>current reward</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-pyrado.tasks.desired_state">
<span id="desired-state"></span><h2>desired_state<a class="headerlink" href="#module-pyrado.tasks.desired_state" title="Permalink to this headline"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="pyrado.tasks.desired_state.DesStateTask">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">DesStateTask</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">env_spec</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="utils.html#pyrado.utils.data_types.EnvSpec" title="pyrado.utils.data_types.EnvSpec"><span class="pre">pyrado.utils.data_types.EnvSpec</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">state_des</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">numpy.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rew_fcn</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#pyrado.tasks.reward_functions.RewFcn" title="pyrado.tasks.reward_functions.RewFcn"><span class="pre">pyrado.tasks.reward_functions.RewFcn</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">success_fcn</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Callable</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/tasks/desired_state.html#DesStateTask"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.tasks.desired_state.DesStateTask" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#pyrado.tasks.base.Task" title="pyrado.tasks.base.Task"><code class="xref py py-class docutils literal notranslate"><span class="pre">pyrado.tasks.base.Task</span></code></a></p>
<p>Task class for moving to a desired state. Operates on the error in state and action.</p>
<p>Constructor</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>env_spec</strong> – environment specification of a simulated or real environment</p></li>
<li><p><strong>state_des</strong> – desired state a.k.a. goal state</p></li>
<li><p><strong>rew_fcn</strong> – reward function, an instance of a subclass of RewFcn</p></li>
<li><p><strong>success_fcn</strong> – function to determine if the task was solved, by default (<cite>None</cite>) this task runs endlessly</p></li>
</ul>
</dd>
</dl>
<dl class="py property">
<dt class="sig sig-object py" id="pyrado.tasks.desired_state.DesStateTask.env_spec">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">env_spec</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="utils.html#pyrado.utils.data_types.EnvSpec" title="pyrado.utils.data_types.EnvSpec"><span class="pre">pyrado.utils.data_types.EnvSpec</span></a></em><a class="headerlink" href="#pyrado.tasks.desired_state.DesStateTask.env_spec" title="Permalink to this definition"></a></dt>
<dd><p>Get the specification of environment the task is in.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyrado.tasks.desired_state.DesStateTask.has_succeeded">
<span class="sig-name descname"><span class="pre">has_succeeded</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">numpy.ndarray</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">bool</span></span></span><a class="reference internal" href="_modules/pyrado/tasks/desired_state.html#DesStateTask.has_succeeded"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.tasks.desired_state.DesStateTask.has_succeeded" title="Permalink to this definition"></a></dt>
<dd><p>Check the environment if the agent succeeded.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>state</strong> – environments current state</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><cite>True</cite> if succeeded</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyrado.tasks.desired_state.DesStateTask.reset">
<span class="sig-name descname"><span class="pre">reset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">env_spec</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="utils.html#pyrado.utils.data_types.EnvSpec" title="pyrado.utils.data_types.EnvSpec"><span class="pre">pyrado.utils.data_types.EnvSpec</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">state_des</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">numpy.ndarray</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/tasks/desired_state.html#DesStateTask.reset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.tasks.desired_state.DesStateTask.reset" title="Permalink to this definition"></a></dt>
<dd><p>Reset the task.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>env_spec</strong> – environment specification</p></li>
<li><p><strong>state_des</strong> – new desired state a.k.a. goal state</p></li>
<li><p><strong>kwargs</strong> – keyword arguments forwarded to the reward function, e.g. the initial state</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="pyrado.tasks.desired_state.DesStateTask.rew_fcn">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">rew_fcn</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="#pyrado.tasks.reward_functions.RewFcn" title="pyrado.tasks.reward_functions.RewFcn"><span class="pre">pyrado.tasks.reward_functions.RewFcn</span></a></em><a class="headerlink" href="#pyrado.tasks.desired_state.DesStateTask.rew_fcn" title="Permalink to this definition"></a></dt>
<dd><p>Get the reward function.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="pyrado.tasks.desired_state.DesStateTask.state_des">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">state_des</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">numpy.ndarray</span></em><a class="headerlink" href="#pyrado.tasks.desired_state.DesStateTask.state_des" title="Permalink to this definition"></a></dt>
<dd><p>Get the desired state (same dimensions as the environment’s state).
Only override this if the task has a desired state.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyrado.tasks.desired_state.DesStateTask.step_rew">
<span class="sig-name descname"><span class="pre">step_rew</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">numpy.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">act</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">numpy.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">remaining_steps</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">float</span></span></span><a class="reference internal" href="_modules/pyrado/tasks/desired_state.html#DesStateTask.step_rew"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.tasks.desired_state.DesStateTask.step_rew" title="Permalink to this definition"></a></dt>
<dd><p>Get the step reward, e.g. from a function of the states and actions.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>It is strongly recommended to call this method every environment step.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>state</strong> – current state</p></li>
<li><p><strong>act</strong> – current action</p></li>
<li><p><strong>remaining_steps</strong> – number of time steps left in the episode</p></li>
</ul>
</dd>
<dt class="field-even">Return rew</dt>
<dd class="field-even"><p>current reward</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="pyrado.tasks.desired_state.RadiallySymmDesStateTask">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">RadiallySymmDesStateTask</span></span><a class="reference internal" href="_modules/pyrado/tasks/desired_state.html#RadiallySymmDesStateTask"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.tasks.desired_state.RadiallySymmDesStateTask" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#pyrado.tasks.desired_state.DesStateTask" title="pyrado.tasks.desired_state.DesStateTask"><code class="xref py py-class docutils literal notranslate"><span class="pre">pyrado.tasks.desired_state.DesStateTask</span></code></a></p>
<p>Task class for moving to a desired state. Operates on the error in state and action.
In contrast to DesStateTask, a subset of the state is radially symmetric, e.g. and angular position.</p>
<p>Constructor</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>env_spec</strong> – environment specification of a simulated or real environment</p></li>
<li><p><strong>state_des</strong> – desired state a.k.a. goal state</p></li>
<li><p><strong>rew_fcn</strong> – reward function, an instance of a subclass of RewFcn</p></li>
<li><p><strong>idcs</strong> – indices of the state dimension(s) to apply the modulation</p></li>
<li><p><strong>modulation</strong> – factor for the modulo operation, can be specified separately for every of <cite>idcs</cite></p></li>
<li><p><strong>success_fcn</strong> – function to determine if the task was solved, by default (<cite>None</cite>) this task runs endlessly</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyrado.tasks.desired_state.RadiallySymmDesStateTask.step_rew">
<span class="sig-name descname"><span class="pre">step_rew</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">numpy.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">act</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">numpy.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">remaining_steps</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">float</span></span></span><a class="reference internal" href="_modules/pyrado/tasks/desired_state.html#RadiallySymmDesStateTask.step_rew"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.tasks.desired_state.RadiallySymmDesStateTask.step_rew" title="Permalink to this definition"></a></dt>
<dd><p>Get the step reward, e.g. from a function of the states and actions.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>It is strongly recommended to call this method every environment step.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>state</strong> – current state</p></li>
<li><p><strong>act</strong> – current action</p></li>
<li><p><strong>remaining_steps</strong> – number of time steps left in the episode</p></li>
</ul>
</dd>
<dt class="field-even">Return rew</dt>
<dd class="field-even"><p>current reward</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-pyrado.tasks.endless_flipping">
<span id="endless-flipping"></span><h2>endless_flipping<a class="headerlink" href="#module-pyrado.tasks.endless_flipping" title="Permalink to this headline"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="pyrado.tasks.endless_flipping.FlippingTask">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">FlippingTask</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">env_spec</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="utils.html#pyrado.utils.data_types.EnvSpec" title="pyrado.utils.data_types.EnvSpec"><span class="pre">pyrado.utils.data_types.EnvSpec</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">des_angle_delta</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rew_fcn</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#pyrado.tasks.reward_functions.RewFcn" title="pyrado.tasks.reward_functions.RewFcn"><span class="pre">pyrado.tasks.reward_functions.RewFcn</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">angle_tol</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.017453292519943295</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">endless</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/tasks/endless_flipping.html#FlippingTask"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.tasks.endless_flipping.FlippingTask" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#pyrado.tasks.base.Task" title="pyrado.tasks.base.Task"><code class="xref py py-class docutils literal notranslate"><span class="pre">pyrado.tasks.base.Task</span></code></a></p>
<p>Task class for flipping an object around one axis about a desired angle. Once the new angle is equal to the
old angle plus/minus a given angle delta, the new angle becomes the old one and the flipping continues.</p>
<p>Constructor</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>env_spec</strong> – environment specification of a simulated or real environment</p></li>
<li><p><strong>des_angle_delta</strong> – desired angle that counts as a flip</p></li>
<li><p><strong>rew_fcn</strong> – reward function, an instance of a subclass of RewFcn</p></li>
<li><p><strong>angle_tol</strong> – tolerance</p></li>
<li><p><strong>endless</strong> – tolerance</p></li>
</ul>
</dd>
</dl>
<dl class="py property">
<dt class="sig sig-object py" id="pyrado.tasks.endless_flipping.FlippingTask.env_spec">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">env_spec</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="utils.html#pyrado.utils.data_types.EnvSpec" title="pyrado.utils.data_types.EnvSpec"><span class="pre">pyrado.utils.data_types.EnvSpec</span></a></em><a class="headerlink" href="#pyrado.tasks.endless_flipping.FlippingTask.env_spec" title="Permalink to this definition"></a></dt>
<dd><p>Get the specification of environment the task is in.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyrado.tasks.endless_flipping.FlippingTask.has_succeeded">
<span class="sig-name descname"><span class="pre">has_succeeded</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">numpy.ndarray</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">bool</span></span></span><a class="reference internal" href="_modules/pyrado/tasks/endless_flipping.html#FlippingTask.has_succeeded"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.tasks.endless_flipping.FlippingTask.has_succeeded" title="Permalink to this definition"></a></dt>
<dd><p>Check the environment if the agent succeeded.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>state</strong> – environments current state</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><cite>True</cite> if succeeded</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyrado.tasks.endless_flipping.FlippingTask.reset">
<span class="sig-name descname"><span class="pre">reset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">env_spec</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="utils.html#pyrado.utils.data_types.EnvSpec" title="pyrado.utils.data_types.EnvSpec"><span class="pre">pyrado.utils.data_types.EnvSpec</span></a></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/tasks/endless_flipping.html#FlippingTask.reset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.tasks.endless_flipping.FlippingTask.reset" title="Permalink to this definition"></a></dt>
<dd><p>Reset the task.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>env_spec</strong> – environment specification</p></li>
<li><p><strong>kwargs</strong> – keyword arguments forwarded to the reward function, e.g. the initial state</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="pyrado.tasks.endless_flipping.FlippingTask.rew_fcn">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">rew_fcn</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="#pyrado.tasks.reward_functions.RewFcn" title="pyrado.tasks.reward_functions.RewFcn"><span class="pre">pyrado.tasks.reward_functions.RewFcn</span></a></em><a class="headerlink" href="#pyrado.tasks.endless_flipping.FlippingTask.rew_fcn" title="Permalink to this definition"></a></dt>
<dd><p>Get the reward function.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyrado.tasks.endless_flipping.FlippingTask.step_rew">
<span class="sig-name descname"><span class="pre">step_rew</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">numpy.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">act</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">numpy.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">remaining_steps</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">float</span></span></span><a class="reference internal" href="_modules/pyrado/tasks/endless_flipping.html#FlippingTask.step_rew"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.tasks.endless_flipping.FlippingTask.step_rew" title="Permalink to this definition"></a></dt>
<dd><p>Get the step reward, e.g. from a function of the states and actions.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>It is strongly recommended to call this method every environment step.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>state</strong> – current state</p></li>
<li><p><strong>act</strong> – current action</p></li>
<li><p><strong>remaining_steps</strong> – number of time steps left in the episode</p></li>
</ul>
</dd>
<dt class="field-even">Return rew</dt>
<dd class="field-even"><p>current reward</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-pyrado.tasks.final_reward">
<span id="final-reward"></span><h2>final_reward<a class="headerlink" href="#module-pyrado.tasks.final_reward" title="Permalink to this headline"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="pyrado.tasks.final_reward.BestStateFinalRewTask">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">BestStateFinalRewTask</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">wrapped_task</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#pyrado.tasks.base.Task" title="pyrado.tasks.base.Task"><span class="pre">pyrado.tasks.base.Task</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">factor</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/tasks/final_reward.html#BestStateFinalRewTask"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.tasks.final_reward.BestStateFinalRewTask" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#pyrado.tasks.base.TaskWrapper" title="pyrado.tasks.base.TaskWrapper"><code class="xref py py-class docutils literal notranslate"><span class="pre">pyrado.tasks.base.TaskWrapper</span></code></a></p>
<p>Wrapper for tasks which yields a reward / cost on success / failure based on the best reward / cost observed in the
current trajectory.</p>
<p>Constructor</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>wrapped_task</strong> – task to wrap</p></li>
<li><p><strong>factor</strong> – value to scale the final reward</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyrado.tasks.final_reward.BestStateFinalRewTask.compute_final_rew">
<span class="sig-name descname"><span class="pre">compute_final_rew</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">numpy.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">remaining_steps</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">float</span></span></span><a class="reference internal" href="_modules/pyrado/tasks/final_reward.html#BestStateFinalRewTask.compute_final_rew"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.tasks.final_reward.BestStateFinalRewTask.compute_final_rew" title="Permalink to this definition"></a></dt>
<dd><p>Compute the reward / cost on task completion / fail of this task.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>state</strong> – current state of the environment</p></li>
<li><p><strong>remaining_steps</strong> – number of time steps left in the episode</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>final reward of this task</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyrado.tasks.final_reward.BestStateFinalRewTask.reset">
<span class="sig-name descname"><span class="pre">reset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/tasks/final_reward.html#BestStateFinalRewTask.reset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.tasks.final_reward.BestStateFinalRewTask.reset" title="Permalink to this definition"></a></dt>
<dd><p>Reset the task.
Since the environment specification may change at every reset of the environment, we have to reset the task.
This might also include resetting the members of the reward function if there are any.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>kwargs</strong> – optional arguments e.g. environment specification or new desired state</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyrado.tasks.final_reward.BestStateFinalRewTask.step_rew">
<span class="sig-name descname"><span class="pre">step_rew</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">numpy.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">act</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">numpy.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">remaining_steps</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">float</span></span></span><a class="reference internal" href="_modules/pyrado/tasks/final_reward.html#BestStateFinalRewTask.step_rew"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.tasks.final_reward.BestStateFinalRewTask.step_rew" title="Permalink to this definition"></a></dt>
<dd><p>Get the step reward, e.g. from a function of the states and actions.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>It is strongly recommended to call this method every environment step.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>state</strong> – current state</p></li>
<li><p><strong>act</strong> – current action</p></li>
<li><p><strong>remaining_steps</strong> – number of time steps left in the episode</p></li>
</ul>
</dd>
<dt class="field-even">Return rew</dt>
<dd class="field-even"><p>current reward</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="pyrado.tasks.final_reward.BestStateFinalRewTask.yielded_final_rew">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">yielded_final_rew</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#pyrado.tasks.final_reward.BestStateFinalRewTask.yielded_final_rew" title="Permalink to this definition"></a></dt>
<dd><p>Get the flag that signals if this instance already yielded its final reward.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="pyrado.tasks.final_reward.FinalRewMode">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">FinalRewMode</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state_dependent</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_dependent</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">always_positive</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">always_negative</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">user_input</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/tasks/final_reward.html#FinalRewMode"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.tasks.final_reward.FinalRewMode" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code></p>
<p>The specification of how the final state should be rewarded or punished</p>
<p>Create new instance of FinalRewMode(state_dependent, time_dependent, always_positive, always_negative, user_input)</p>
<dl class="py property">
<dt class="sig sig-object py" id="pyrado.tasks.final_reward.FinalRewMode.always_negative">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">always_negative</span></span><a class="headerlink" href="#pyrado.tasks.final_reward.FinalRewMode.always_negative" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 3</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="pyrado.tasks.final_reward.FinalRewMode.always_positive">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">always_positive</span></span><a class="headerlink" href="#pyrado.tasks.final_reward.FinalRewMode.always_positive" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 2</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="pyrado.tasks.final_reward.FinalRewMode.state_dependent">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">state_dependent</span></span><a class="headerlink" href="#pyrado.tasks.final_reward.FinalRewMode.state_dependent" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 0</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="pyrado.tasks.final_reward.FinalRewMode.time_dependent">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">time_dependent</span></span><a class="headerlink" href="#pyrado.tasks.final_reward.FinalRewMode.time_dependent" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 1</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="pyrado.tasks.final_reward.FinalRewMode.user_input">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">user_input</span></span><a class="headerlink" href="#pyrado.tasks.final_reward.FinalRewMode.user_input" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 4</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="pyrado.tasks.final_reward.FinalRewTask">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">FinalRewTask</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">wrapped_task</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#pyrado.tasks.base.Task" title="pyrado.tasks.base.Task"><span class="pre">pyrado.tasks.base.Task</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#pyrado.tasks.final_reward.FinalRewMode" title="pyrado.tasks.final_reward.FinalRewMode"><span class="pre">pyrado.tasks.final_reward.FinalRewMode</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">factor</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1000.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/tasks/final_reward.html#FinalRewTask"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.tasks.final_reward.FinalRewTask" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#pyrado.tasks.base.TaskWrapper" title="pyrado.tasks.base.TaskWrapper"><code class="xref py py-class docutils literal notranslate"><span class="pre">pyrado.tasks.base.TaskWrapper</span></code></a></p>
<p>Wrapper for tasks which yields a reward / cost on success / failure</p>
<dl class="field-list simple">
<dt class="field-odd">Usage</dt>
<dd class="field-odd"><p></p></dd>
</dl>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">task</span> <span class="o">=</span> <span class="n">FinalRewTask</span><span class="p">(</span><span class="n">DesStateTask</span><span class="p">(</span><span class="n">spec</span><span class="p">,</span> <span class="n">state_des</span><span class="p">,</span> <span class="n">rew_fcn</span><span class="p">,</span> <span class="n">success_fcn</span><span class="p">),</span> <span class="n">mode</span><span class="o">=</span><span class="n">FinalRewMode</span><span class="p">(),</span> <span class="n">factor</span><span class="o">=</span><span class="mf">1e3</span><span class="p">)</span>
</pre></div>
</div>
<p>Constructor</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>wrapped_task</strong> – task to wrap</p></li>
<li><p><strong>mode</strong> – mode for calculating the final reward</p></li>
<li><p><strong>factor</strong> – (positive) value to scale the final reward.
The <cite>factor</cite> is ignored if <cite>mode.time_dependent</cite> is <cite>True</cite></p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyrado.tasks.final_reward.FinalRewTask.compute_final_rew">
<span class="sig-name descname"><span class="pre">compute_final_rew</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">numpy.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">remaining_steps</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">float</span></span></span><a class="reference internal" href="_modules/pyrado/tasks/final_reward.html#FinalRewTask.compute_final_rew"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.tasks.final_reward.FinalRewTask.compute_final_rew" title="Permalink to this definition"></a></dt>
<dd><p>Compute the reward / cost on task completion / fail of this task.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>state</strong> – current state of the environment</p></li>
<li><p><strong>remaining_steps</strong> – number of time steps left in the episode</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>final reward of this task</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyrado.tasks.final_reward.FinalRewTask.reset">
<span class="sig-name descname"><span class="pre">reset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/tasks/final_reward.html#FinalRewTask.reset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.tasks.final_reward.FinalRewTask.reset" title="Permalink to this definition"></a></dt>
<dd><p>Reset the task.
Since the environment specification may change at every reset of the environment, we have to reset the task.
This might also include resetting the members of the reward function if there are any.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>kwargs</strong> – optional arguments e.g. environment specification or new desired state</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="pyrado.tasks.final_reward.FinalRewTask.yielded_final_rew">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">yielded_final_rew</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#pyrado.tasks.final_reward.FinalRewTask.yielded_final_rew" title="Permalink to this definition"></a></dt>
<dd><p>Get the flag that signals if this instance already yielded its final reward.</p>
</dd></dl>

</dd></dl>

</section>
<section id="module-pyrado.tasks.goalless">
<span id="goalless"></span><h2>goalless<a class="headerlink" href="#module-pyrado.tasks.goalless" title="Permalink to this headline"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="pyrado.tasks.goalless.GoallessTask">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">GoallessTask</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">env_spec</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="utils.html#pyrado.utils.data_types.EnvSpec" title="pyrado.utils.data_types.EnvSpec"><span class="pre">pyrado.utils.data_types.EnvSpec</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">rew_fcn</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#pyrado.tasks.reward_functions.RewFcn" title="pyrado.tasks.reward_functions.RewFcn"><span class="pre">pyrado.tasks.reward_functions.RewFcn</span></a></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/tasks/goalless.html#GoallessTask"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.tasks.goalless.GoallessTask" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#pyrado.tasks.base.Task" title="pyrado.tasks.base.Task"><code class="xref py py-class docutils literal notranslate"><span class="pre">pyrado.tasks.base.Task</span></code></a></p>
<p>Task which has no desired state or desired space, this runs endlessly</p>
<p>Constructor</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>env_spec</strong> – environment specification</p></li>
<li><p><strong>rew_fcn</strong> – reward function, an instance of a subclass of RewFcn</p></li>
</ul>
</dd>
</dl>
<dl class="py property">
<dt class="sig sig-object py" id="pyrado.tasks.goalless.GoallessTask.env_spec">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">env_spec</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="utils.html#pyrado.utils.data_types.EnvSpec" title="pyrado.utils.data_types.EnvSpec"><span class="pre">pyrado.utils.data_types.EnvSpec</span></a></em><a class="headerlink" href="#pyrado.tasks.goalless.GoallessTask.env_spec" title="Permalink to this definition"></a></dt>
<dd><p>Get the specification of environment the task is in.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyrado.tasks.goalless.GoallessTask.has_succeeded">
<span class="sig-name descname"><span class="pre">has_succeeded</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">numpy.ndarray</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">bool</span></span></span><a class="reference internal" href="_modules/pyrado/tasks/goalless.html#GoallessTask.has_succeeded"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.tasks.goalless.GoallessTask.has_succeeded" title="Permalink to this definition"></a></dt>
<dd><p>Check the environment if the agent succeeded.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>state</strong> – environments current state</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><cite>True</cite> if succeeded</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyrado.tasks.goalless.GoallessTask.reset">
<span class="sig-name descname"><span class="pre">reset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">env_spec</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="utils.html#pyrado.utils.data_types.EnvSpec" title="pyrado.utils.data_types.EnvSpec"><span class="pre">pyrado.utils.data_types.EnvSpec</span></a></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/tasks/goalless.html#GoallessTask.reset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.tasks.goalless.GoallessTask.reset" title="Permalink to this definition"></a></dt>
<dd><p>Reset the task.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>env_spec</strong> – environment specification</p></li>
<li><p><strong>kwargs</strong> – keyword arguments forwarded to the reward function, e.g. the initial state</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="pyrado.tasks.goalless.GoallessTask.rew_fcn">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">rew_fcn</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="#pyrado.tasks.reward_functions.RewFcn" title="pyrado.tasks.reward_functions.RewFcn"><span class="pre">pyrado.tasks.reward_functions.RewFcn</span></a></em><a class="headerlink" href="#pyrado.tasks.goalless.GoallessTask.rew_fcn" title="Permalink to this definition"></a></dt>
<dd><p>Get the reward function.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyrado.tasks.goalless.GoallessTask.step_rew">
<span class="sig-name descname"><span class="pre">step_rew</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">numpy.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">act</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">numpy.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">remaining_steps</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">float</span></span></span><a class="reference internal" href="_modules/pyrado/tasks/goalless.html#GoallessTask.step_rew"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.tasks.goalless.GoallessTask.step_rew" title="Permalink to this definition"></a></dt>
<dd><p>Get the step reward, e.g. from a function of the states and actions.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>It is strongly recommended to call this method every environment step.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>state</strong> – current state</p></li>
<li><p><strong>act</strong> – current action</p></li>
<li><p><strong>remaining_steps</strong> – number of time steps left in the episode</p></li>
</ul>
</dd>
<dt class="field-even">Return rew</dt>
<dd class="field-even"><p>current reward</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="pyrado.tasks.goalless.OptimProxyTask">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">OptimProxyTask</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">env_spec</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="utils.html#pyrado.utils.data_types.EnvSpec" title="pyrado.utils.data_types.EnvSpec"><span class="pre">pyrado.utils.data_types.EnvSpec</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">rew_fcn</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#pyrado.tasks.reward_functions.StateBasedRewFcn" title="pyrado.tasks.reward_functions.StateBasedRewFcn"><span class="pre">pyrado.tasks.reward_functions.StateBasedRewFcn</span></a></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/tasks/goalless.html#OptimProxyTask"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.tasks.goalless.OptimProxyTask" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#pyrado.tasks.base.Task" title="pyrado.tasks.base.Task"><code class="xref py py-class docutils literal notranslate"><span class="pre">pyrado.tasks.base.Task</span></code></a></p>
<p>Task for wrapping classical optimization problems a.k.a. (nonlinear) programming into Pyrado</p>
<p>Constructor</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>env_spec</strong> – environment specification</p></li>
<li><p><strong>rew_fcn</strong> – state-based reward function that maps the state to an scalar value</p></li>
</ul>
</dd>
</dl>
<dl class="py property">
<dt class="sig sig-object py" id="pyrado.tasks.goalless.OptimProxyTask.env_spec">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">env_spec</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="utils.html#pyrado.utils.data_types.EnvSpec" title="pyrado.utils.data_types.EnvSpec"><span class="pre">pyrado.utils.data_types.EnvSpec</span></a></em><a class="headerlink" href="#pyrado.tasks.goalless.OptimProxyTask.env_spec" title="Permalink to this definition"></a></dt>
<dd><p>Get the specification of environment the task is in.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyrado.tasks.goalless.OptimProxyTask.has_succeeded">
<span class="sig-name descname"><span class="pre">has_succeeded</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">numpy.ndarray</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">bool</span></span></span><a class="reference internal" href="_modules/pyrado/tasks/goalless.html#OptimProxyTask.has_succeeded"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.tasks.goalless.OptimProxyTask.has_succeeded" title="Permalink to this definition"></a></dt>
<dd><p>Check the environment if the agent succeeded.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>state</strong> – environments current state</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><cite>True</cite> if succeeded</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyrado.tasks.goalless.OptimProxyTask.reset">
<span class="sig-name descname"><span class="pre">reset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">env_spec</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/tasks/goalless.html#OptimProxyTask.reset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.tasks.goalless.OptimProxyTask.reset" title="Permalink to this definition"></a></dt>
<dd><p>Reset the task.
Since the environment specification may change at every reset of the environment, we have to reset the task.
This might also include resetting the members of the reward function if there are any.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>kwargs</strong> – optional arguments e.g. environment specification or new desired state</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="pyrado.tasks.goalless.OptimProxyTask.rew_fcn">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">rew_fcn</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="#pyrado.tasks.reward_functions.StateBasedRewFcn" title="pyrado.tasks.reward_functions.StateBasedRewFcn"><span class="pre">pyrado.tasks.reward_functions.StateBasedRewFcn</span></a></em><a class="headerlink" href="#pyrado.tasks.goalless.OptimProxyTask.rew_fcn" title="Permalink to this definition"></a></dt>
<dd><p>Get the reward function.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyrado.tasks.goalless.OptimProxyTask.step_rew">
<span class="sig-name descname"><span class="pre">step_rew</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">numpy.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">act</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">numpy.ndarray</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">remaining_steps</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">float</span></span></span><a class="reference internal" href="_modules/pyrado/tasks/goalless.html#OptimProxyTask.step_rew"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.tasks.goalless.OptimProxyTask.step_rew" title="Permalink to this definition"></a></dt>
<dd><p>Get the step reward, e.g. from a function of the states and actions.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>It is strongly recommended to call this method every environment step.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>state</strong> – current state</p></li>
<li><p><strong>act</strong> – current action</p></li>
<li><p><strong>remaining_steps</strong> – number of time steps left in the episode</p></li>
</ul>
</dd>
<dt class="field-even">Return rew</dt>
<dd class="field-even"><p>current reward</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-pyrado.tasks.masked">
<span id="masked"></span><h2>masked<a class="headerlink" href="#module-pyrado.tasks.masked" title="Permalink to this headline"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="pyrado.tasks.masked.MaskedTask">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">MaskedTask</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">env_spec</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="utils.html#pyrado.utils.data_types.EnvSpec" title="pyrado.utils.data_types.EnvSpec"><span class="pre">pyrado.utils.data_types.EnvSpec</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">wrapped_task</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#pyrado.tasks.base.Task" title="pyrado.tasks.base.Task"><span class="pre">pyrado.tasks.base.Task</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">state_idcs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">action_idcs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/tasks/masked.html#MaskedTask"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.tasks.masked.MaskedTask" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#pyrado.tasks.base.Task" title="pyrado.tasks.base.Task"><code class="xref py py-class docutils literal notranslate"><span class="pre">pyrado.tasks.base.Task</span></code></a></p>
<p>Task using only a subset of state and actions</p>
<p>Constructor</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>env_spec</strong> – environment specification</p></li>
<li><p><strong>wrapped_task</strong> – task for the selected part of the state-action space</p></li>
<li><p><strong>state_idcs</strong> – indices of the selected states</p></li>
<li><p><strong>action_idcs</strong> – indices of the selected actions</p></li>
</ul>
</dd>
</dl>
<dl class="py property">
<dt class="sig sig-object py" id="pyrado.tasks.masked.MaskedTask.env_spec">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">env_spec</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="utils.html#pyrado.utils.data_types.EnvSpec" title="pyrado.utils.data_types.EnvSpec"><span class="pre">pyrado.utils.data_types.EnvSpec</span></a></em><a class="headerlink" href="#pyrado.tasks.masked.MaskedTask.env_spec" title="Permalink to this definition"></a></dt>
<dd><p>Get the specification of environment the task is in.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyrado.tasks.masked.MaskedTask.final_rew">
<span class="sig-name descname"><span class="pre">final_rew</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">numpy.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">remaining_steps</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">float</span></span></span><a class="reference internal" href="_modules/pyrado/tasks/masked.html#MaskedTask.final_rew"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.tasks.masked.MaskedTask.final_rew" title="Permalink to this definition"></a></dt>
<dd><p>Get the final reward, e.g. bonus for success or a malus for failure.
This function loops through all tasks (unfolding the wrappers) and calls their <cite>compute_final_rew</cite> method.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>state</strong> – current state forwarded to <cite>compute_final_rew</cite></p></li>
<li><p><strong>remaining_steps</strong> – number of time steps left in the episode forwarded to <cite>compute_final_rew</cite></p></li>
</ul>
</dd>
<dt class="field-even">Return rew</dt>
<dd class="field-even"><p>summed final reward</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyrado.tasks.masked.MaskedTask.has_failed">
<span class="sig-name descname"><span class="pre">has_failed</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">numpy.ndarray</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">bool</span></span></span><a class="reference internal" href="_modules/pyrado/tasks/masked.html#MaskedTask.has_failed"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.tasks.masked.MaskedTask.has_failed" title="Permalink to this definition"></a></dt>
<dd><p>Check the environment if the agent failed.
The default implementation checks if the state is out of bounds.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>state</strong> – environments current state</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><cite>True</cite> if failed</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyrado.tasks.masked.MaskedTask.has_succeeded">
<span class="sig-name descname"><span class="pre">has_succeeded</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">numpy.ndarray</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">bool</span></span></span><a class="reference internal" href="_modules/pyrado/tasks/masked.html#MaskedTask.has_succeeded"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.tasks.masked.MaskedTask.has_succeeded" title="Permalink to this definition"></a></dt>
<dd><p>Check the environment if the agent succeeded.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>state</strong> – environments current state</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><cite>True</cite> if succeeded</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyrado.tasks.masked.MaskedTask.is_done">
<span class="sig-name descname"><span class="pre">is_done</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">numpy.ndarray</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">bool</span></span></span><a class="reference internal" href="_modules/pyrado/tasks/masked.html#MaskedTask.is_done"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.tasks.masked.MaskedTask.is_done" title="Permalink to this definition"></a></dt>
<dd><p>Check if a final state is reached.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>It is strongly recommended to call this method every environment step.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>state</strong> – current state</p></li>
<li><p><strong>act</strong> – current action</p></li>
</ul>
</dd>
<dt class="field-even">Return done</dt>
<dd class="field-even"><p>done flag</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyrado.tasks.masked.MaskedTask.reset">
<span class="sig-name descname"><span class="pre">reset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">env_spec</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="utils.html#pyrado.utils.data_types.EnvSpec" title="pyrado.utils.data_types.EnvSpec"><span class="pre">pyrado.utils.data_types.EnvSpec</span></a></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/tasks/masked.html#MaskedTask.reset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.tasks.masked.MaskedTask.reset" title="Permalink to this definition"></a></dt>
<dd><p>Reset the task.
Since the environment specification may change at every reset of the environment, we have to reset the task.
This might also include resetting the members of the reward function if there are any.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>kwargs</strong> – optional arguments e.g. environment specification or new desired state</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="pyrado.tasks.masked.MaskedTask.rew_fcn">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">rew_fcn</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="#pyrado.tasks.reward_functions.RewFcn" title="pyrado.tasks.reward_functions.RewFcn"><span class="pre">pyrado.tasks.reward_functions.RewFcn</span></a></em><a class="headerlink" href="#pyrado.tasks.masked.MaskedTask.rew_fcn" title="Permalink to this definition"></a></dt>
<dd><p>Get the reward function.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="pyrado.tasks.masked.MaskedTask.state_des">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">state_des</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">numpy.ndarray</span></em><a class="headerlink" href="#pyrado.tasks.masked.MaskedTask.state_des" title="Permalink to this definition"></a></dt>
<dd><p>Get the desired state (same dimensions as the environment’s state).
Only override this if the task has a desired state.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyrado.tasks.masked.MaskedTask.step_rew">
<span class="sig-name descname"><span class="pre">step_rew</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">numpy.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">act</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">numpy.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">remaining_steps</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">float</span></span></span><a class="reference internal" href="_modules/pyrado/tasks/masked.html#MaskedTask.step_rew"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.tasks.masked.MaskedTask.step_rew" title="Permalink to this definition"></a></dt>
<dd><p>Get the step reward, e.g. from a function of the states and actions.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>It is strongly recommended to call this method every environment step.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>state</strong> – current state</p></li>
<li><p><strong>act</strong> – current action</p></li>
<li><p><strong>remaining_steps</strong> – number of time steps left in the episode</p></li>
</ul>
</dd>
<dt class="field-even">Return rew</dt>
<dd class="field-even"><p>current reward</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="pyrado.tasks.masked.MaskedTask.wrapped_task">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">wrapped_task</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="#pyrado.tasks.base.Task" title="pyrado.tasks.base.Task"><span class="pre">pyrado.tasks.base.Task</span></a></em><a class="headerlink" href="#pyrado.tasks.masked.MaskedTask.wrapped_task" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

</section>
<section id="module-pyrado.tasks.parallel">
<span id="parallel"></span><h2>parallel<a class="headerlink" href="#module-pyrado.tasks.parallel" title="Permalink to this headline"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="pyrado.tasks.parallel.ParallelTasks">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">ParallelTasks</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tasks</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Sequence</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#pyrado.tasks.base.Task" title="pyrado.tasks.base.Task"><span class="pre">pyrado.tasks.base.Task</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hold_rew_when_done</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">allow_failures</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">easily_satisfied</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/tasks/parallel.html#ParallelTasks"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.tasks.parallel.ParallelTasks" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#pyrado.tasks.base.Task" title="pyrado.tasks.base.Task"><code class="xref py py-class docutils literal notranslate"><span class="pre">pyrado.tasks.base.Task</span></code></a></p>
<p>Task class for a set of tasks a.k.a. goals which can be achieved in any order or parallel</p>
<p>Constructor</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tasks</strong> – sequence of tasks a.k.a. goals, the order matters</p></li>
<li><p><strong>hold_rew_when_done</strong> – if <cite>True</cite> reward values for done tasks will be stored and added every step</p></li>
<li><p><strong>allow_failures</strong> – if <cite>True</cite> this allows to continue after one sub-task failed, by default <cite>False</cite></p></li>
<li><p><strong>easily_satisfied</strong> – if <cite>True</cite> one successful subtask is enough to make the complete task successful,
by default <cite>False</cite>. Use this wisely.</p></li>
<li><p><strong>verbose</strong> – print messages on task completion</p></li>
</ul>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This task can also be wrapped by a <cite>FinalRewTask</cite> to enjoy modularity.</p>
<p><cite>hold_rew_when_done=True</cite> only makes sense for positive rewards.</p>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="pyrado.tasks.parallel.ParallelTasks.compute_final_rew">
<span class="sig-name descname"><span class="pre">compute_final_rew</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">numpy.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">remaining_steps</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">float</span></span></span><a class="reference internal" href="_modules/pyrado/tasks/parallel.html#ParallelTasks.compute_final_rew"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.tasks.parallel.ParallelTasks.compute_final_rew" title="Permalink to this definition"></a></dt>
<dd><p>Compute the reward / cost on task completion / fail of this task.
Since this task holds multiple sub-tasks, the final reward / cost is computed for them, too.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The <cite>ParallelTasks</cite> class is not a subclass of <cite>TaskWrapper</cite>, i.e. this function only looks at the
immediate sub-tasks.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>state</strong> – current state of the environment</p></li>
<li><p><strong>remaining_steps</strong> – number of time steps left in the episode</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>final reward of all sub-tasks</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="pyrado.tasks.parallel.ParallelTasks.env_spec">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">env_spec</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="utils.html#pyrado.utils.data_types.EnvSpec" title="pyrado.utils.data_types.EnvSpec"><span class="pre">pyrado.utils.data_types.EnvSpec</span></a></em><a class="headerlink" href="#pyrado.tasks.parallel.ParallelTasks.env_spec" title="Permalink to this definition"></a></dt>
<dd><p>Get the specification of environment the task is in.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyrado.tasks.parallel.ParallelTasks.has_failed">
<span class="sig-name descname"><span class="pre">has_failed</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">numpy.ndarray</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">bool</span></span></span><a class="reference internal" href="_modules/pyrado/tasks/parallel.html#ParallelTasks.has_failed"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.tasks.parallel.ParallelTasks.has_failed" title="Permalink to this definition"></a></dt>
<dd><p>Check if this task has failed.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyrado.tasks.parallel.ParallelTasks.has_succeeded">
<span class="sig-name descname"><span class="pre">has_succeeded</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">numpy.ndarray</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">bool</span></span></span><a class="reference internal" href="_modules/pyrado/tasks/parallel.html#ParallelTasks.has_succeeded"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.tasks.parallel.ParallelTasks.has_succeeded" title="Permalink to this definition"></a></dt>
<dd><p>Check if this tasks is done. The ParallelTasks is successful if all sub-tasks are successful.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>state</strong> – environments current state</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><cite>True</cite> if succeeded</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyrado.tasks.parallel.ParallelTasks.reset">
<span class="sig-name descname"><span class="pre">reset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/tasks/parallel.html#ParallelTasks.reset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.tasks.parallel.ParallelTasks.reset" title="Permalink to this definition"></a></dt>
<dd><p>Reset all tasks.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="pyrado.tasks.parallel.ParallelTasks.rew_fcn">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">rew_fcn</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">list</span></em><a class="headerlink" href="#pyrado.tasks.parallel.ParallelTasks.rew_fcn" title="Permalink to this definition"></a></dt>
<dd><p>Get a list of all reward functions.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="pyrado.tasks.parallel.ParallelTasks.space_des">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">space_des</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">list</span></em><a class="headerlink" href="#pyrado.tasks.parallel.ParallelTasks.space_des" title="Permalink to this definition"></a></dt>
<dd><p>Get a list of all desired spaces.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="pyrado.tasks.parallel.ParallelTasks.state_des">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">state_des</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">list</span></em><a class="headerlink" href="#pyrado.tasks.parallel.ParallelTasks.state_des" title="Permalink to this definition"></a></dt>
<dd><p>Get a list of all desired states.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyrado.tasks.parallel.ParallelTasks.step_rew">
<span class="sig-name descname"><span class="pre">step_rew</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">numpy.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">act</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">numpy.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">remaining_steps</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">float</span></span></span><a class="reference internal" href="_modules/pyrado/tasks/parallel.html#ParallelTasks.step_rew"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.tasks.parallel.ParallelTasks.step_rew" title="Permalink to this definition"></a></dt>
<dd><p>Get the step reward accumulated from every non-done task.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="pyrado.tasks.parallel.ParallelTasks.tasks">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">tasks</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Sequence</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#pyrado.tasks.base.Task" title="pyrado.tasks.base.Task"><span class="pre">pyrado.tasks.base.Task</span></a><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#pyrado.tasks.parallel.ParallelTasks.tasks" title="Permalink to this definition"></a></dt>
<dd><p>Get the list of tasks.</p>
</dd></dl>

</dd></dl>

</section>
<section id="module-pyrado.tasks.predefined">
<span id="predefined"></span><h2>predefined<a class="headerlink" href="#module-pyrado.tasks.predefined" title="Permalink to this headline"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="pyrado.tasks.predefined.create_check_all_boundaries_task">
<span class="sig-name descname"><span class="pre">create_check_all_boundaries_task</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">env_spec</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="utils.html#pyrado.utils.data_types.EnvSpec" title="pyrado.utils.data_types.EnvSpec"><span class="pre">pyrado.utils.data_types.EnvSpec</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">penalty</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#pyrado.tasks.final_reward.FinalRewTask" title="pyrado.tasks.final_reward.FinalRewTask"><span class="pre">pyrado.tasks.final_reward.FinalRewTask</span></a></span></span><a class="reference internal" href="_modules/pyrado/tasks/predefined.html#create_check_all_boundaries_task"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.tasks.predefined.create_check_all_boundaries_task" title="Permalink to this definition"></a></dt>
<dd><p>Create a task that is checking if any of the state space bounds is violated.
This checks every limit and not just of a subspace of the state state as it could happen when using a <cite>MaskedTask</cite>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This task was designed with an RcsPySim environment in mind, but is not restricted to these environments.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>env_spec</strong> – environment specification</p></li>
<li><p><strong>penalty</strong> – scalar cost (positive values) for violating the bounds</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>masked task that only considers a subspace of all observations</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyrado.tasks.predefined.create_collision_task">
<span class="sig-name descname"><span class="pre">create_collision_task</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">env_spec</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="utils.html#pyrado.utils.data_types.EnvSpec" title="pyrado.utils.data_types.EnvSpec"><span class="pre">pyrado.utils.data_types.EnvSpec</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">factor</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#pyrado.tasks.masked.MaskedTask" title="pyrado.tasks.masked.MaskedTask"><span class="pre">pyrado.tasks.masked.MaskedTask</span></a></span></span><a class="reference internal" href="_modules/pyrado/tasks/predefined.html#create_collision_task"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.tasks.predefined.create_collision_task" title="Permalink to this definition"></a></dt>
<dd><p>Create a task which punishes collision costs given a collision model with pairs of bodies.
This task only looks at the instantaneous collision cost.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This task was designed with an RcsPySim environment in mind, but is not restricted to these environments.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>env_spec</strong> – environment specification</p></li>
<li><p><strong>factor</strong> – cost / reward function scaling factor</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>masked task that only considers a subspace of all observations</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyrado.tasks.predefined.create_flipping_task">
<span class="sig-name descname"><span class="pre">create_flipping_task</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">env_spec</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="utils.html#pyrado.utils.data_types.EnvSpec" title="pyrado.utils.data_types.EnvSpec"><span class="pre">pyrado.utils.data_types.EnvSpec</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">obs_labels</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Sequence</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">des_angle_delta</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1.5707963267948966</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">endless</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#pyrado.tasks.masked.MaskedTask" title="pyrado.tasks.masked.MaskedTask"><span class="pre">pyrado.tasks.masked.MaskedTask</span></a></span></span><a class="reference internal" href="_modules/pyrado/tasks/predefined.html#create_flipping_task"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.tasks.predefined.create_flipping_task" title="Permalink to this definition"></a></dt>
<dd><p>Create a task for rotating an object.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This task was designed with an RcsPySim environment in mind, but is not restricted to these environments.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>env_spec</strong> – environment specification</p></li>
<li><p><strong>obs_labels</strong> – labels for selection, e.g. [‘Box_A’]. This needs to match the observations’ names in RcsPySim</p></li>
<li><p><strong>des_angle_delta</strong> – desired angle to rotate. If reached, the task is reset, and rotating continues.</p></li>
<li><p><strong>endless</strong> – if <cite>True</cite>, the task will promote endlessly repeated flipping about the desired angle, else only one
flip is desired</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>masked task that only considers a subspace of all observations</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyrado.tasks.predefined.create_forcemin_task">
<span class="sig-name descname"><span class="pre">create_forcemin_task</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">env_spec</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="utils.html#pyrado.utils.data_types.EnvSpec" title="pyrado.utils.data_types.EnvSpec"><span class="pre">pyrado.utils.data_types.EnvSpec</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">obs_labels</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Sequence</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Q</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">numpy.ndarray</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#pyrado.tasks.masked.MaskedTask" title="pyrado.tasks.masked.MaskedTask"><span class="pre">pyrado.tasks.masked.MaskedTask</span></a></span></span><a class="reference internal" href="_modules/pyrado/tasks/predefined.html#create_forcemin_task"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.tasks.predefined.create_forcemin_task" title="Permalink to this definition"></a></dt>
<dd><p>Create a task which punishes the amount of used force.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This task was designed with an RcsPySim environment in mind, but is not restricted to these environments.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>env_spec</strong> – environment specification</p></li>
<li><p><strong>obs_labels</strong> – labels for selection, e.g. [‘WristLoadCellLBR_R_Fy’]. This needs to match the observations’
names in RcsPySim</p></li>
<li><p><strong>Q</strong> – weight matrix of dim NxN with N=num_forces for the quadratic force costs</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>masked task that only considers a subspace of all observations</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyrado.tasks.predefined.create_goal_dist_distvel_task">
<span class="sig-name descname"><span class="pre">create_goal_dist_distvel_task</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">env_spec</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="utils.html#pyrado.utils.data_types.EnvSpec" title="pyrado.utils.data_types.EnvSpec"><span class="pre">pyrado.utils.data_types.EnvSpec</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">ds_label</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rew_fcn</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#pyrado.tasks.reward_functions.RewFcn" title="pyrado.tasks.reward_functions.RewFcn"><span class="pre">pyrado.tasks.reward_functions.RewFcn</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">succ_thold</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.01</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#pyrado.tasks.masked.MaskedTask" title="pyrado.tasks.masked.MaskedTask"><span class="pre">pyrado.tasks.masked.MaskedTask</span></a></span></span><a class="reference internal" href="_modules/pyrado/tasks/predefined.html#create_goal_dist_distvel_task"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.tasks.predefined.create_goal_dist_distvel_task" title="Permalink to this definition"></a></dt>
<dd><p>Create a task that rewards minimizing the <cite>GoalDistance</cite> as well as its rate of change of dynamical system
movements primitives (see RcsPySim).</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This task was designed with an RcsPySim environment in mind, but is not restricted to these environments.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>env_spec</strong> – environment specification</p></li>
<li><p><strong>ds_label</strong> – label of the dynamical system (see RcsPySim)</p></li>
<li><p><strong>rew_fcn</strong> – reward function</p></li>
<li><p><strong>succ_thold</strong> – once the object of interest is closer than this threshold, the task is considered successfully</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>masked task that only considers a subspace of all observations</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyrado.tasks.predefined.create_goal_dist_task">
<span class="sig-name descname"><span class="pre">create_goal_dist_task</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">env_spec</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="utils.html#pyrado.utils.data_types.EnvSpec" title="pyrado.utils.data_types.EnvSpec"><span class="pre">pyrado.utils.data_types.EnvSpec</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">ds_label</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rew_fcn</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#pyrado.tasks.reward_functions.RewFcn" title="pyrado.tasks.reward_functions.RewFcn"><span class="pre">pyrado.tasks.reward_functions.RewFcn</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">succ_thold</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.01</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#pyrado.tasks.masked.MaskedTask" title="pyrado.tasks.masked.MaskedTask"><span class="pre">pyrado.tasks.masked.MaskedTask</span></a></span></span><a class="reference internal" href="_modules/pyrado/tasks/predefined.html#create_goal_dist_task"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.tasks.predefined.create_goal_dist_task" title="Permalink to this definition"></a></dt>
<dd><p>Create a task that rewards minimizing the <cite>GoalDistance</cite> of dynamical system movements primitives (see RcsPySim).</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This task was designed with an RcsPySim environment in mind, but is not restricted to these environments.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>env_spec</strong> – environment specification</p></li>
<li><p><strong>ds_label</strong> – label of the dynamical system (see RcsPySim)</p></li>
<li><p><strong>rew_fcn</strong> – reward function</p></li>
<li><p><strong>succ_thold</strong> – once the object of interest is closer than this threshold, the task is considered successfully</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>masked task that only considers a subspace of all observations</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyrado.tasks.predefined.create_home_pos_task">
<span class="sig-name descname"><span class="pre">create_home_pos_task</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">env_spec</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="utils.html#pyrado.utils.data_types.EnvSpec" title="pyrado.utils.data_types.EnvSpec"><span class="pre">pyrado.utils.data_types.EnvSpec</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">obs_labels</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Sequence</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">state_des</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">numpy.ndarray</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#pyrado.tasks.masked.MaskedTask" title="pyrado.tasks.masked.MaskedTask"><span class="pre">pyrado.tasks.masked.MaskedTask</span></a></span></span><a class="reference internal" href="_modules/pyrado/tasks/predefined.html#create_home_pos_task"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.tasks.predefined.create_home_pos_task" title="Permalink to this definition"></a></dt>
<dd><p>Create a task for moving the robot to safe position.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This task was designed with an RcsPySim environment in mind, but is not restricted to these environments.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>env_spec</strong> – environment specification</p></li>
<li><p><strong>obs_labels</strong> – labels for selection, e.g. [‘PowerGrasp_R_Y’, ‘PowerGrasp_R_Z’]. This needs to match the
observations’ names in RcsPySim</p></li>
<li><p><strong>state_des</strong> – desired state (depends of the coordinate system). If reached, the task is over.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>masked task that only considers a subspace of all observations</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyrado.tasks.predefined.create_lifting_task">
<span class="sig-name descname"><span class="pre">create_lifting_task</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">env_spec</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="utils.html#pyrado.utils.data_types.EnvSpec" title="pyrado.utils.data_types.EnvSpec"><span class="pre">pyrado.utils.data_types.EnvSpec</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">obs_labels</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Sequence</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">des_height</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">numpy.ndarray</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">succ_thold</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.01</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#pyrado.tasks.masked.MaskedTask" title="pyrado.tasks.masked.MaskedTask"><span class="pre">pyrado.tasks.masked.MaskedTask</span></a></span></span><a class="reference internal" href="_modules/pyrado/tasks/predefined.html#create_lifting_task"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.tasks.predefined.create_lifting_task" title="Permalink to this definition"></a></dt>
<dd><p>Create a task for lifting an object.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This task was designed with an RcsPySim environment in mind, but is not restricted to these environments.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>env_spec</strong> – environment specification</p></li>
<li><p><strong>obs_labels</strong> – labels for selection, e.g. [‘Box_Z’]. This needs to match the observations’ names in RcsPySim</p></li>
<li><p><strong>des_height</strong> – desired height of the object (depends of the coordinate system). If reached, the task is over.</p></li>
<li><p><strong>succ_thold</strong> – once the object of interest is closer than this threshold, the task is considered successfully</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>masked task that only considers a subspace of all observations</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyrado.tasks.predefined.create_task_space_discrepancy_task">
<span class="sig-name descname"><span class="pre">create_task_space_discrepancy_task</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">env_spec</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="utils.html#pyrado.utils.data_types.EnvSpec" title="pyrado.utils.data_types.EnvSpec"><span class="pre">pyrado.utils.data_types.EnvSpec</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">rew_fcn</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#pyrado.tasks.reward_functions.RewFcn" title="pyrado.tasks.reward_functions.RewFcn"><span class="pre">pyrado.tasks.reward_functions.RewFcn</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#pyrado.tasks.masked.MaskedTask" title="pyrado.tasks.masked.MaskedTask"><span class="pre">pyrado.tasks.masked.MaskedTask</span></a></span></span><a class="reference internal" href="_modules/pyrado/tasks/predefined.html#create_task_space_discrepancy_task"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.tasks.predefined.create_task_space_discrepancy_task" title="Permalink to this definition"></a></dt>
<dd><p>Create a task which punishes the discrepancy between the actual and the commanded state of the observed body.
The observed body is specified in in the associated experiment configuration file in RcsPySim.
This task only looks at the X and Z coordinates.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This task was designed with an RcsPySim environment in mind, but is not restricted to these environments.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>env_spec</strong> – environment specification</p></li>
<li><p><strong>rew_fcn</strong> – reward function</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>masked task that only considers a subspace of all observations</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-pyrado.tasks.reward_functions">
<span id="reward-functions"></span><h2>reward_functions<a class="headerlink" href="#module-pyrado.tasks.reward_functions" title="Permalink to this headline"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="pyrado.tasks.reward_functions.AbsErrRewFcn">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">AbsErrRewFcn</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">q</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">numpy.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">numpy.ndarray</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/tasks/reward_functions.html#AbsErrRewFcn"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.tasks.reward_functions.AbsErrRewFcn" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#pyrado.tasks.reward_functions.RewFcn" title="pyrado.tasks.reward_functions.RewFcn"><code class="xref py py-class docutils literal notranslate"><span class="pre">pyrado.tasks.reward_functions.RewFcn</span></code></a></p>
<p>Reward function that returns the negative weighted sum of the absolute errors.</p>
<p>Constructor</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>q</strong> – weight vector for the state errors</p></li>
<li><p><strong>r</strong> – weight vector for the action errors</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="pyrado.tasks.reward_functions.CompoundRewFcn">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">CompoundRewFcn</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rew_fcns</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Sequence</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/tasks/reward_functions.html#CompoundRewFcn"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.tasks.reward_functions.CompoundRewFcn" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#pyrado.tasks.reward_functions.RewFcn" title="pyrado.tasks.reward_functions.RewFcn"><code class="xref py py-class docutils literal notranslate"><span class="pre">pyrado.tasks.reward_functions.RewFcn</span></code></a></p>
<p>Combine multiple reward functions</p>
<p>Constuctor</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>rew_fcns</strong> – sequence, e.g. list or tuple, of reward functions to combine</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyrado.tasks.reward_functions.CompoundRewFcn.reset">
<span class="sig-name descname"><span class="pre">reset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/tasks/reward_functions.html#CompoundRewFcn.reset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.tasks.reward_functions.CompoundRewFcn.reset" title="Permalink to this definition"></a></dt>
<dd><p>Reset internal members. This function is called from the <cite>Task.reset()</cite> function.
The default implementation does nothing.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="pyrado.tasks.reward_functions.CosOfOneEleRewFcn">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">CosOfOneEleRewFcn</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">idx</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/tasks/reward_functions.html#CosOfOneEleRewFcn"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.tasks.reward_functions.CosOfOneEleRewFcn" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#pyrado.tasks.reward_functions.RewFcn" title="pyrado.tasks.reward_functions.RewFcn"><code class="xref py py-class docutils literal notranslate"><span class="pre">pyrado.tasks.reward_functions.RewFcn</span></code></a></p>
<p>Reward function that takes the cosine of one element of the state, given by an index.
Maximum reward of +1 at state[idx] = +/- state_des[idx], minimum reward of -1 at state[idx] = 0.</p>
<p>Constructor</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>idx</strong> – index of the element (angle) of interest</p>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="pyrado.tasks.reward_functions.ExpQuadrErrRewFcn">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">ExpQuadrErrRewFcn</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Q</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">numpy.ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">list</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">R</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">numpy.ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">list</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/tasks/reward_functions.html#ExpQuadrErrRewFcn"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.tasks.reward_functions.ExpQuadrErrRewFcn" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#pyrado.tasks.reward_functions.QuadrErrRewFcn" title="pyrado.tasks.reward_functions.QuadrErrRewFcn"><code class="xref py py-class docutils literal notranslate"><span class="pre">pyrado.tasks.reward_functions.QuadrErrRewFcn</span></code></a></p>
<p>Reward function that returns the exp of the weighted sum of squared errors</p>
<p>Constructor</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Q</strong> – weight matrix for the state errors (positive semi-definite)</p></li>
<li><p><strong>R</strong> – weight matrix for the action errors (positive definite)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="pyrado.tasks.reward_functions.ForwardVelocityRewFcn">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">ForwardVelocityRewFcn</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dt</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">idx_fwd</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fwd_rew_weight</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ctrl_cost_weight</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/tasks/reward_functions.html#ForwardVelocityRewFcn"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.tasks.reward_functions.ForwardVelocityRewFcn" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#pyrado.tasks.reward_functions.RewFcn" title="pyrado.tasks.reward_functions.RewFcn"><code class="xref py py-class docutils literal notranslate"><span class="pre">pyrado.tasks.reward_functions.RewFcn</span></code></a></p>
<p>Reward function for the <cite>HalfCheetahSim</cite> and <cite>SwimmerSim</cite> environment, encouraging to run forward</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The OpenAi Gym calculates the velocity via forward differences, while here we get the velocity directly from
the simulator.</p>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference external" href="https://github.com/openai/gym/blob/master/gym/envs/mujoco/half_cheetah.py">https://github.com/openai/gym/blob/master/gym/envs/mujoco/half_cheetah.py</a>
<a class="reference external" href="https://github.com/openai/gym/blob/master/gym/envs/mujoco/swimmer_v3.py">https://github.com/openai/gym/blob/master/gym/envs/mujoco/swimmer_v3.py</a></p>
</div>
<p>Constructor</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The last x position, which is rewarded, is initialized by <cite>reset()</cite>, since the (sampled) initial state is
unknown at construction time of the task, i.e. this reward function.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dt</strong> – simulation step size [s]</p></li>
<li><p><strong>idx_fwd</strong> – index of the state dimension that marks the forward direction</p></li>
<li><p><strong>fwd_rew_weight</strong> – scaling factor for the forward velocity reward</p></li>
<li><p><strong>ctrl_cost_weight</strong> – scaling factor for the control cost</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyrado.tasks.reward_functions.ForwardVelocityRewFcn.reset">
<span class="sig-name descname"><span class="pre">reset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">init_state</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/tasks/reward_functions.html#ForwardVelocityRewFcn.reset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.tasks.reward_functions.ForwardVelocityRewFcn.reset" title="Permalink to this definition"></a></dt>
<dd><p>Reset internal members. This function is called from the <cite>Task.reset()</cite> function.
The default implementation does nothing.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="pyrado.tasks.reward_functions.ForwardVelocityRewFcnAnt">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">ForwardVelocityRewFcnAnt</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dt</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">contact_force_range</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">contact_cost_weight</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.0005</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ctrl_cost_weight</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">healthy_reward</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">terminate_when_unhealthy</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">healthy_z_range</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">(0.2,</span> <span class="pre">1.0)</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/tasks/reward_functions.html#ForwardVelocityRewFcnAnt"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.tasks.reward_functions.ForwardVelocityRewFcnAnt" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#pyrado.tasks.reward_functions.RewFcn" title="pyrado.tasks.reward_functions.RewFcn"><code class="xref py py-class docutils literal notranslate"><span class="pre">pyrado.tasks.reward_functions.RewFcn</span></code></a></p>
<p>Reward function for the <cite>AntSim</cite> environment, encouraging to run forward</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The OpenAi Gym calculates the velocity via forward differences, while here we get the velocity directly from
the simulator.</p>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference external" href="https://github.com/openai/gym/blob/master/gym/envs/mujoco/ant_v3.py">https://github.com/openai/gym/blob/master/gym/envs/mujoco/ant_v3.py</a></p>
</div>
<p>Constructor</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The last x position, which is rewarded, is initialized by <cite>reset()</cite>, since the (sampled) initial state is
unknown at construction time of the task, i.e. this reward function.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dt</strong> – simulation step size [s]</p></li>
<li><p><strong>idx_fwd</strong> – index of the state dimension that marks the forward direction</p></li>
<li><p><strong>fwd_rew_weight</strong> – scaling factor for the forward velocity reward</p></li>
<li><p><strong>ctrl_cost_weight</strong> – scaling factor for the control cost</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyrado.tasks.reward_functions.ForwardVelocityRewFcnAnt.contact_forces">
<span class="sig-name descname"><span class="pre">contact_forces</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">raw_contact_forces</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/tasks/reward_functions.html#ForwardVelocityRewFcnAnt.contact_forces"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.tasks.reward_functions.ForwardVelocityRewFcnAnt.contact_forces" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="pyrado.tasks.reward_functions.ForwardVelocityRewFcnAnt.healthy_reward">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">healthy_reward</span></span><a class="headerlink" href="#pyrado.tasks.reward_functions.ForwardVelocityRewFcnAnt.healthy_reward" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="pyrado.tasks.reward_functions.ForwardVelocityRewFcnAnt.is_healthy">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">is_healthy</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#pyrado.tasks.reward_functions.ForwardVelocityRewFcnAnt.is_healthy" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyrado.tasks.reward_functions.ForwardVelocityRewFcnAnt.reset">
<span class="sig-name descname"><span class="pre">reset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">init_state</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/tasks/reward_functions.html#ForwardVelocityRewFcnAnt.reset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.tasks.reward_functions.ForwardVelocityRewFcnAnt.reset" title="Permalink to this definition"></a></dt>
<dd><p>Reset internal members. This function is called from the <cite>Task.reset()</cite> function.
The default implementation does nothing.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="pyrado.tasks.reward_functions.ForwardVelocityRewFcnHumanoid">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">ForwardVelocityRewFcnHumanoid</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dt</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">contact_cost_weight</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">5e-07</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ctrl_cost_weight</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">forward_reward_weight</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1.25</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">healthy_reward</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">5.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">terminate_when_unhealthy</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">healthy_z_range</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">(1.0,</span> <span class="pre">2.0)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">contact_cost_range</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">(-</span> <span class="pre">inf,</span> <span class="pre">10.0)</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/tasks/reward_functions.html#ForwardVelocityRewFcnHumanoid"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.tasks.reward_functions.ForwardVelocityRewFcnHumanoid" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#pyrado.tasks.reward_functions.RewFcn" title="pyrado.tasks.reward_functions.RewFcn"><code class="xref py py-class docutils literal notranslate"><span class="pre">pyrado.tasks.reward_functions.RewFcn</span></code></a></p>
<p>Reward function for the <cite>HumanoidSim</cite> environment, encouraging to run forward</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The OpenAi Gym calculates the velocity via forward differences, while here we get the velocity directly from
the simulator.</p>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference external" href="https://github.com/openai/gym/blob/master/gym/envs/mujoco/humanoid_v3.py">https://github.com/openai/gym/blob/master/gym/envs/mujoco/humanoid_v3.py</a></p>
</div>
<p>Constructor</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The last x position, which is rewarded, is initialized by <cite>reset()</cite>, since the (sampled) initial state is
unknown at construction time of the task, i.e. this reward function.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dt</strong> – simulation step size [s]</p></li>
<li><p><strong>idx_fwd</strong> – index of the state dimension that marks the forward direction</p></li>
<li><p><strong>fwd_rew_weight</strong> – scaling factor for the forward velocity reward</p></li>
<li><p><strong>ctrl_cost_weight</strong> – scaling factor for the control cost</p></li>
</ul>
</dd>
</dl>
<dl class="py property">
<dt class="sig sig-object py" id="pyrado.tasks.reward_functions.ForwardVelocityRewFcnHumanoid.healthy_reward">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">healthy_reward</span></span><a class="headerlink" href="#pyrado.tasks.reward_functions.ForwardVelocityRewFcnHumanoid.healthy_reward" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="pyrado.tasks.reward_functions.ForwardVelocityRewFcnHumanoid.is_healthy">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">is_healthy</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#pyrado.tasks.reward_functions.ForwardVelocityRewFcnHumanoid.is_healthy" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyrado.tasks.reward_functions.ForwardVelocityRewFcnHumanoid.reset">
<span class="sig-name descname"><span class="pre">reset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">init_state</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/tasks/reward_functions.html#ForwardVelocityRewFcnHumanoid.reset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.tasks.reward_functions.ForwardVelocityRewFcnHumanoid.reset" title="Permalink to this definition"></a></dt>
<dd><p>Reset internal members. This function is called from the <cite>Task.reset()</cite> function.
The default implementation does nothing.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="pyrado.tasks.reward_functions.MinusOnePerStepRewFcn">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">MinusOnePerStepRewFcn</span></span><a class="reference internal" href="_modules/pyrado/tasks/reward_functions.html#MinusOnePerStepRewFcn"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.tasks.reward_functions.MinusOnePerStepRewFcn" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#pyrado.tasks.reward_functions.RewFcn" title="pyrado.tasks.reward_functions.RewFcn"><code class="xref py py-class docutils literal notranslate"><span class="pre">pyrado.tasks.reward_functions.RewFcn</span></code></a></p>
<p>Reward function that yields -1 reward every time step.
A positive or negative final reward can be specified on the Task-level.</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="pyrado.tasks.reward_functions.PlusOnePerStepRewFcn">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">PlusOnePerStepRewFcn</span></span><a class="reference internal" href="_modules/pyrado/tasks/reward_functions.html#PlusOnePerStepRewFcn"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.tasks.reward_functions.PlusOnePerStepRewFcn" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#pyrado.tasks.reward_functions.RewFcn" title="pyrado.tasks.reward_functions.RewFcn"><code class="xref py py-class docutils literal notranslate"><span class="pre">pyrado.tasks.reward_functions.RewFcn</span></code></a></p>
<p>Reward function that yields +1 reward every time step.
A positive or negative final reward can be specified on the Task-level.</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="pyrado.tasks.reward_functions.QCartPoleSwingUpRewFcn">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">QCartPoleSwingUpRewFcn</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">factor</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.9</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/tasks/reward_functions.html#QCartPoleSwingUpRewFcn"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.tasks.reward_functions.QCartPoleSwingUpRewFcn" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#pyrado.tasks.reward_functions.RewFcn" title="pyrado.tasks.reward_functions.RewFcn"><code class="xref py py-class docutils literal notranslate"><span class="pre">pyrado.tasks.reward_functions.RewFcn</span></code></a></p>
<p>Custom reward function for QCartPoleSwingUpSim.</p>
<p>Constructor</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>factor</strong> – weighting factor of rotation error to position error</p>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="pyrado.tasks.reward_functions.QuadrErrRewFcn">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">QuadrErrRewFcn</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Q</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">numpy.ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">list</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">R</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">numpy.ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">list</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/tasks/reward_functions.html#QuadrErrRewFcn"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.tasks.reward_functions.QuadrErrRewFcn" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#pyrado.tasks.reward_functions.RewFcn" title="pyrado.tasks.reward_functions.RewFcn"><code class="xref py py-class docutils literal notranslate"><span class="pre">pyrado.tasks.reward_functions.RewFcn</span></code></a></p>
<p>Reward function that returns the exp of the weighted sum of squared errors.</p>
<p>Constructor</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Q</strong> – weight matrix for the state errors (positive semi-definite)</p></li>
<li><p><strong>R</strong> – weight matrix for the action errors (positive definite)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="pyrado.tasks.reward_functions.RewFcn">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">RewFcn</span></span><a class="reference internal" href="_modules/pyrado/tasks/reward_functions.html#RewFcn"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.tasks.reward_functions.RewFcn" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">abc.ABC</span></code></p>
<p>Base class for all reward functions</p>
<dl class="py method">
<dt class="sig sig-object py" id="pyrado.tasks.reward_functions.RewFcn.reset">
<span class="sig-name descname"><span class="pre">reset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/tasks/reward_functions.html#RewFcn.reset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.tasks.reward_functions.RewFcn.reset" title="Permalink to this definition"></a></dt>
<dd><p>Reset internal members. This function is called from the <cite>Task.reset()</cite> function.
The default implementation does nothing.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="pyrado.tasks.reward_functions.SSCosOfOneEleRewFcn">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">SSCosOfOneEleRewFcn</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">idx</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/tasks/reward_functions.html#SSCosOfOneEleRewFcn"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.tasks.reward_functions.SSCosOfOneEleRewFcn" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#pyrado.tasks.reward_functions.CosOfOneEleRewFcn" title="pyrado.tasks.reward_functions.CosOfOneEleRewFcn"><code class="xref py py-class docutils literal notranslate"><span class="pre">pyrado.tasks.reward_functions.CosOfOneEleRewFcn</span></code></a></p>
<p>Reward function that takes the shifted and scaled cosine of one element of the state, given by an index.
Maximum reward of +1 at state[idx] = +/- state_des[idx], minimum reward of 0 at state[idx] = 0.</p>
<p>Constructor</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>idx</strong> – index of the element (angle) of interest</p>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="pyrado.tasks.reward_functions.ScaledExpQuadrErrRewFcn">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">ScaledExpQuadrErrRewFcn</span></span><a class="reference internal" href="_modules/pyrado/tasks/reward_functions.html#ScaledExpQuadrErrRewFcn"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.tasks.reward_functions.ScaledExpQuadrErrRewFcn" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#pyrado.tasks.reward_functions.QuadrErrRewFcn" title="pyrado.tasks.reward_functions.QuadrErrRewFcn"><code class="xref py py-class docutils literal notranslate"><span class="pre">pyrado.tasks.reward_functions.QuadrErrRewFcn</span></code></a></p>
<p>Reward function that returns the exp of the scaled weighted sum of squared errors</p>
<p>Constructor</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This reward function type depends on environment specific parameters. Due to the domain randomization,
have to re-init the reward function after every randomization of the env, since obs_max and act_max can
change when randomizing the domain parameters.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Q</strong> – weight matrix for the state errors (positive semi-definite)</p></li>
<li><p><strong>R</strong> – weight matrix for the action errors (positive definite)</p></li>
<li><p><strong>state_space</strong> – for extracting the worst case (max cost) observation</p></li>
<li><p><strong>act_space</strong> – for extracting the worst case (max cost) action</p></li>
<li><p><strong>min_rew</strong> – minimum reward (only used for the scaling factor in the exponential reward function)</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyrado.tasks.reward_functions.ScaledExpQuadrErrRewFcn.reset">
<span class="sig-name descname"><span class="pre">reset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state_space</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="spaces.html#pyrado.spaces.base.Space" title="pyrado.spaces.base.Space"><span class="pre">pyrado.spaces.base.Space</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">act_space</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="spaces.html#pyrado.spaces.base.Space" title="pyrado.spaces.base.Space"><span class="pre">pyrado.spaces.base.Space</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_rew</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0001</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/tasks/reward_functions.html#ScaledExpQuadrErrRewFcn.reset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.tasks.reward_functions.ScaledExpQuadrErrRewFcn.reset" title="Permalink to this definition"></a></dt>
<dd><p>Reset internal members. This function is called from the <cite>Task.reset()</cite> function.
The default implementation does nothing.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="pyrado.tasks.reward_functions.StateBasedRewFcn">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">StateBasedRewFcn</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fcn</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Callable</span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">[</span></span><span class="pre">numpy.ndarray</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flip_sign</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/tasks/reward_functions.html#StateBasedRewFcn"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.tasks.reward_functions.StateBasedRewFcn" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Reward function which directly operates on the state a.k.a. solution. This class is supposed to be used for wrapping
classical optimization problems into Pyrado, thus it is negative of the loss function.</p>
<p>Constructor</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>fcn</strong> – function for evaluating the state a.k.a. solution</p></li>
<li><p><strong>flip_sign</strong> – return negative of fcn, useful to turn minimization problems into maximization problems</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="pyrado.tasks.reward_functions.UnderActuatedSwingUpRewFcn">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">UnderActuatedSwingUpRewFcn</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">c_pole</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">c_cart</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">c_act</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.001</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">c_theta_sq</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">c_theta_log</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">idx_x</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">idx_th</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/tasks/reward_functions.html#UnderActuatedSwingUpRewFcn"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.tasks.reward_functions.UnderActuatedSwingUpRewFcn" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#pyrado.tasks.reward_functions.RewFcn" title="pyrado.tasks.reward_functions.RewFcn"><code class="xref py py-class docutils literal notranslate"><span class="pre">pyrado.tasks.reward_functions.RewFcn</span></code></a></p>
<p>Reward function for the swing-up task on the Cart-Pole system similar to [1].</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt>[1] W. Yu, J. Tan, C.K. Liu, G. Turk, “Preparing for the Unknown: Learning a Universal Policy with Online System</dt><dd><p>Identification”, RSS, 2017</p>
</dd>
</dl>
</div>
<p>Constructor</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>c_pole</strong> – scaling parameter for the pole angle cost</p></li>
<li><p><strong>c_cart</strong> – scaling parameter for the cart position cost</p></li>
<li><p><strong>c_act</strong> – scaling parameter for the control cost</p></li>
<li><p><strong>c_theta_sq</strong> – scaling parameter for the quadratic angle deviation</p></li>
<li><p><strong>c_theta_log</strong> – shifting parameter for the logarithm of the quadratic angle deviation</p></li>
<li><p><strong>idx_x</strong> – index of he state representing the driving component of the system (e.g. cart position x)</p></li>
<li><p><strong>idx_th</strong> – index of he state representing the rotating of the system (e.g. pole angle theta)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="pyrado.tasks.reward_functions.ZeroPerStepRewFcn">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">ZeroPerStepRewFcn</span></span><a class="reference internal" href="_modules/pyrado/tasks/reward_functions.html#ZeroPerStepRewFcn"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.tasks.reward_functions.ZeroPerStepRewFcn" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#pyrado.tasks.reward_functions.RewFcn" title="pyrado.tasks.reward_functions.RewFcn"><code class="xref py py-class docutils literal notranslate"><span class="pre">pyrado.tasks.reward_functions.RewFcn</span></code></a></p>
<p>Reward function that yields 0 reward every time step.
A positive or negative final reward can be specified on the Task-level.</p>
</dd></dl>

</section>
<section id="module-pyrado.tasks.sequential">
<span id="sequential"></span><h2>sequential<a class="headerlink" href="#module-pyrado.tasks.sequential" title="Permalink to this headline"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="pyrado.tasks.sequential.SequentialTasks">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">SequentialTasks</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tasks</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Sequence</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#pyrado.tasks.base.Task" title="pyrado.tasks.base.Task"><span class="pre">pyrado.tasks.base.Task</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start_idx</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hold_rew_when_done</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/tasks/sequential.html#SequentialTasks"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.tasks.sequential.SequentialTasks" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#pyrado.tasks.base.Task" title="pyrado.tasks.base.Task"><code class="xref py py-class docutils literal notranslate"><span class="pre">pyrado.tasks.base.Task</span></code></a></p>
<p>Task class for a sequence of tasks a.k.a. goals</p>
<p>Constructor</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tasks</strong> – sequence of tasks a.k.a. goals, the order matters</p></li>
<li><p><strong>start_idx</strong> – index of the task to start with, by default with the first one in the list</p></li>
<li><p><strong>hold_rew_when_done</strong> – if <cite>True</cite> reward values for done tasks will be stored and added every step</p></li>
<li><p><strong>verbose</strong> – print messages on task completion</p></li>
</ul>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><cite>hold_rew_when_done=True</cite> only makes sense for positive rewards.</p>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="pyrado.tasks.sequential.SequentialTasks.compute_final_rew">
<span class="sig-name descname"><span class="pre">compute_final_rew</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">numpy.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">remaining_steps</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">float</span></span></span><a class="reference internal" href="_modules/pyrado/tasks/sequential.html#SequentialTasks.compute_final_rew"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.tasks.sequential.SequentialTasks.compute_final_rew" title="Permalink to this definition"></a></dt>
<dd><p>Compute the reward / cost on task completion / fail of this task.
Since this task holds multiple sub-tasks, the final reward / cost is computed for them, too.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The <cite>ParallelTasks</cite> class is not a subclass of <cite>TaskWrapper</cite>, i.e. this function only looks at the
immediate sub-tasks.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>state</strong> – current state of the environment</p></li>
<li><p><strong>remaining_steps</strong> – number of time steps left in the episode</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>final reward of all sub-tasks</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="pyrado.tasks.sequential.SequentialTasks.env_spec">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">env_spec</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="utils.html#pyrado.utils.data_types.EnvSpec" title="pyrado.utils.data_types.EnvSpec"><span class="pre">pyrado.utils.data_types.EnvSpec</span></a></em><a class="headerlink" href="#pyrado.tasks.sequential.SequentialTasks.env_spec" title="Permalink to this definition"></a></dt>
<dd><p>Get the specification of environment the task is in.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyrado.tasks.sequential.SequentialTasks.has_succeeded">
<span class="sig-name descname"><span class="pre">has_succeeded</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">numpy.ndarray</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">bool</span></span></span><a class="reference internal" href="_modules/pyrado/tasks/sequential.html#SequentialTasks.has_succeeded"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.tasks.sequential.SequentialTasks.has_succeeded" title="Permalink to this definition"></a></dt>
<dd><p>Check if this tasks is done. The SequentialTasks is successful if all sub-tasks are successful.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>state</strong> – environments current state</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><cite>True</cite> if succeeded</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="pyrado.tasks.sequential.SequentialTasks.idx_curr">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">idx_curr</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><a class="headerlink" href="#pyrado.tasks.sequential.SequentialTasks.idx_curr" title="Permalink to this definition"></a></dt>
<dd><p>Get the index of the currently active task.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyrado.tasks.sequential.SequentialTasks.reset">
<span class="sig-name descname"><span class="pre">reset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/tasks/sequential.html#SequentialTasks.reset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.tasks.sequential.SequentialTasks.reset" title="Permalink to this definition"></a></dt>
<dd><p>Reset all tasks.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="pyrado.tasks.sequential.SequentialTasks.rew_fcn">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">rew_fcn</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="#pyrado.tasks.reward_functions.RewFcn" title="pyrado.tasks.reward_functions.RewFcn"><span class="pre">pyrado.tasks.reward_functions.RewFcn</span></a></em><a class="headerlink" href="#pyrado.tasks.sequential.SequentialTasks.rew_fcn" title="Permalink to this definition"></a></dt>
<dd><p>Get the reward function of the current task.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="pyrado.tasks.sequential.SequentialTasks.space_des">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">space_des</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="spaces.html#pyrado.spaces.base.Space" title="pyrado.spaces.base.Space"><span class="pre">pyrado.spaces.base.Space</span></a></em><a class="headerlink" href="#pyrado.tasks.sequential.SequentialTasks.space_des" title="Permalink to this definition"></a></dt>
<dd><p>Get the desired space the current task.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="pyrado.tasks.sequential.SequentialTasks.state_des">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">state_des</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">numpy.ndarray</span></em><a class="headerlink" href="#pyrado.tasks.sequential.SequentialTasks.state_des" title="Permalink to this definition"></a></dt>
<dd><p>Get the desired state the current task.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyrado.tasks.sequential.SequentialTasks.step_rew">
<span class="sig-name descname"><span class="pre">step_rew</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">numpy.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">act</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">numpy.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">remaining_steps</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">float</span></span></span><a class="reference internal" href="_modules/pyrado/tasks/sequential.html#SequentialTasks.step_rew"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.tasks.sequential.SequentialTasks.step_rew" title="Permalink to this definition"></a></dt>
<dd><p>Get the step reward from the current task.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="pyrado.tasks.sequential.SequentialTasks.tasks">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">tasks</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Sequence</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#pyrado.tasks.base.Task" title="pyrado.tasks.base.Task"><span class="pre">pyrado.tasks.base.Task</span></a><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#pyrado.tasks.sequential.SequentialTasks.tasks" title="Permalink to this definition"></a></dt>
<dd><p>Get the list of tasks.</p>
</dd></dl>

</dd></dl>

</section>
<section id="module-pyrado.tasks.utils">
<span id="utils"></span><h2>utils<a class="headerlink" href="#module-pyrado.tasks.utils" title="Permalink to this headline"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="pyrado.tasks.utils.never_succeeded">
<span class="sig-name descname"><span class="pre">never_succeeded</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">err</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">numpy.ndarray</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">bool</span></span></span><a class="reference internal" href="_modules/pyrado/tasks/utils.html#never_succeeded"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.tasks.utils.never_succeeded" title="Permalink to this definition"></a></dt>
<dd><p>The task is never marked successful, i.e. runs until the environments state or time is out of bounds.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyrado.tasks.utils.proximity_succeeded">
<span class="sig-name descname"><span class="pre">proximity_succeeded</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">err</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">numpy.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">thold_dist</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dims</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">-</span> <span class="pre">1</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">bool</span></span></span><a class="reference internal" href="_modules/pyrado/tasks/utils.html#proximity_succeeded"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.tasks.utils.proximity_succeeded" title="Permalink to this definition"></a></dt>
<dd><p>The task is done successfully if the L2-norm of the selected dimensions of the state is smaller than some threshold.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>err</strong> – error in state, i.e. difference between desired and current state</p></li>
<li><p><strong>thold_dist</strong> – threshold for being solved</p></li>
<li><p><strong>dims</strong> – selected dimensions, i.e. indices, for the state, by default all dimensions are selected</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><cite>True</cite> if successful</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-pyrado.tasks">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-pyrado.tasks" title="Permalink to this headline"></a></h2>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="spaces.html" class="btn btn-neutral float-left" title="spaces" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="sampling.html" class="btn btn-neutral float-right" title="sampling" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2020.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>