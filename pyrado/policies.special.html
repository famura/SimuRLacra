<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>special &mdash; Pyrado 0.7.1 documentation</title>
      <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="_static/graphviz.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/sphinx_highlight.js"></script>
        <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="spaces" href="spaces.html" />
    <link rel="prev" title="recurrent" href="policies.recurrent.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="index.html" class="icon icon-home"> Pyrado
          </a>
              <div class="version">
                0.7.1
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Examples:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="examples/1_basic_experiment.html">How to run an experiment</a></li>
<li class="toctree-l1"><a class="reference internal" href="examples/2_wrapping_environments.html">How to wrap an environment</a></li>
<li class="toctree-l1"><a class="reference internal" href="examples/3_algorithm_skeleton.html">How to create an algorithm</a></li>
<li class="toctree-l1"><a class="reference internal" href="examples/4_creating_rcspysim_environments.html">How to create an RcsPySim environment</a></li>
<li class="toctree-l1"><a class="reference internal" href="examples/5_panda3d_visualization.html"><strong>How to create a visualization</strong></a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Environments:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="environments.html">environments</a></li>
<li class="toctree-l1"><a class="reference internal" href="environments.barrett_wam.html">barrett_wam</a></li>
<li class="toctree-l1"><a class="reference internal" href="environments.mujoco.html">mujoco</a></li>
<li class="toctree-l1"><a class="reference internal" href="environments.pysim.html">pysim</a></li>
<li class="toctree-l1"><a class="reference internal" href="environments.quanser.html">quanser</a></li>
<li class="toctree-l1"><a class="reference internal" href="environments.rcspysim.html">rcspysim</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Environment Wrappers:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="environment_wrappers.html">environment_wrappers</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Domain Randomization:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="domain_randomization.html">domain_randomization</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Algorithms:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="algorithms.html">algorithms</a></li>
<li class="toctree-l1"><a class="reference internal" href="algorithms.episodic.html">episodic</a></li>
<li class="toctree-l1"><a class="reference internal" href="algorithms.step_based.html">step_based</a></li>
<li class="toctree-l1"><a class="reference internal" href="algorithms.meta.html">meta</a></li>
<li class="toctree-l1"><a class="reference internal" href="algorithms.regression.html">regression</a></li>
<li class="toctree-l1"><a class="reference internal" href="algorithms.stopping_criteria.html">stopping_criteria</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Exploration:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="exploration.html">exploration</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Policies:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="policies.html">policies</a></li>
<li class="toctree-l1"><a class="reference internal" href="policies.feed_back.html">feed_back</a></li>
<li class="toctree-l1"><a class="reference internal" href="policies.feed_forward.html">feed_forward</a></li>
<li class="toctree-l1"><a class="reference internal" href="policies.recurrent.html">recurrent</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">special</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#module-pyrado.policies.special.domain_distribution">domain_distribution</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#pyrado.policies.special.domain_distribution.DomainDistrParamPolicy"><code class="docutils literal notranslate"><span class="pre">DomainDistrParamPolicy</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#pyrado.policies.special.domain_distribution.DomainDistrParamPolicy.forward"><code class="docutils literal notranslate"><span class="pre">DomainDistrParamPolicy.forward()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pyrado.policies.special.domain_distribution.DomainDistrParamPolicy.init_param"><code class="docutils literal notranslate"><span class="pre">DomainDistrParamPolicy.init_param()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pyrado.policies.special.domain_distribution.DomainDistrParamPolicy.mapping"><code class="docutils literal notranslate"><span class="pre">DomainDistrParamPolicy.mapping</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pyrado.policies.special.domain_distribution.DomainDistrParamPolicy.name"><code class="docutils literal notranslate"><span class="pre">DomainDistrParamPolicy.name</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pyrado.policies.special.domain_distribution.DomainDistrParamPolicy.transform_to_ddp_space"><code class="docutils literal notranslate"><span class="pre">DomainDistrParamPolicy.transform_to_ddp_space()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-pyrado.policies.special.environment_specific">environment_specific</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#pyrado.policies.special.environment_specific.QBallBalancerPDCtrl"><code class="docutils literal notranslate"><span class="pre">QBallBalancerPDCtrl</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#pyrado.policies.special.environment_specific.QBallBalancerPDCtrl.forward"><code class="docutils literal notranslate"><span class="pre">QBallBalancerPDCtrl.forward()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pyrado.policies.special.environment_specific.QBallBalancerPDCtrl.init_param"><code class="docutils literal notranslate"><span class="pre">QBallBalancerPDCtrl.init_param()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pyrado.policies.special.environment_specific.QBallBalancerPDCtrl.name"><code class="docutils literal notranslate"><span class="pre">QBallBalancerPDCtrl.name</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pyrado.policies.special.environment_specific.QBallBalancerPDCtrl.reset"><code class="docutils literal notranslate"><span class="pre">QBallBalancerPDCtrl.reset()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#pyrado.policies.special.environment_specific.QCartPoleGoToLimCtrl"><code class="docutils literal notranslate"><span class="pre">QCartPoleGoToLimCtrl</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#pyrado.policies.special.environment_specific.QCartPoleSwingUpAndBalanceCtrl"><code class="docutils literal notranslate"><span class="pre">QCartPoleSwingUpAndBalanceCtrl</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#pyrado.policies.special.environment_specific.QCartPoleSwingUpAndBalanceCtrl.K_pd"><code class="docutils literal notranslate"><span class="pre">QCartPoleSwingUpAndBalanceCtrl.K_pd</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pyrado.policies.special.environment_specific.QCartPoleSwingUpAndBalanceCtrl.forward"><code class="docutils literal notranslate"><span class="pre">QCartPoleSwingUpAndBalanceCtrl.forward()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pyrado.policies.special.environment_specific.QCartPoleSwingUpAndBalanceCtrl.init_param"><code class="docutils literal notranslate"><span class="pre">QCartPoleSwingUpAndBalanceCtrl.init_param()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pyrado.policies.special.environment_specific.QCartPoleSwingUpAndBalanceCtrl.k_e"><code class="docutils literal notranslate"><span class="pre">QCartPoleSwingUpAndBalanceCtrl.k_e</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pyrado.policies.special.environment_specific.QCartPoleSwingUpAndBalanceCtrl.k_p"><code class="docutils literal notranslate"><span class="pre">QCartPoleSwingUpAndBalanceCtrl.k_p</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pyrado.policies.special.environment_specific.QCartPoleSwingUpAndBalanceCtrl.name"><code class="docutils literal notranslate"><span class="pre">QCartPoleSwingUpAndBalanceCtrl.name</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pyrado.policies.special.environment_specific.QCartPoleSwingUpAndBalanceCtrl.u_max"><code class="docutils literal notranslate"><span class="pre">QCartPoleSwingUpAndBalanceCtrl.u_max</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#pyrado.policies.special.environment_specific.QQubeEnergyCtrl"><code class="docutils literal notranslate"><span class="pre">QQubeEnergyCtrl</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#pyrado.policies.special.environment_specific.QQubeEnergyCtrl.E_gain"><code class="docutils literal notranslate"><span class="pre">QQubeEnergyCtrl.E_gain</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pyrado.policies.special.environment_specific.QQubeEnergyCtrl.E_ref"><code class="docutils literal notranslate"><span class="pre">QQubeEnergyCtrl.E_ref</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pyrado.policies.special.environment_specific.QQubeEnergyCtrl.forward"><code class="docutils literal notranslate"><span class="pre">QQubeEnergyCtrl.forward()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pyrado.policies.special.environment_specific.QQubeEnergyCtrl.init_param"><code class="docutils literal notranslate"><span class="pre">QQubeEnergyCtrl.init_param()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pyrado.policies.special.environment_specific.QQubeEnergyCtrl.reset"><code class="docutils literal notranslate"><span class="pre">QQubeEnergyCtrl.reset()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pyrado.policies.special.environment_specific.QQubeEnergyCtrl.training"><code class="docutils literal notranslate"><span class="pre">QQubeEnergyCtrl.training</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#pyrado.policies.special.environment_specific.QQubeGoToLimCtrl"><code class="docutils literal notranslate"><span class="pre">QQubeGoToLimCtrl</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#pyrado.policies.special.environment_specific.QQubePDCtrl"><code class="docutils literal notranslate"><span class="pre">QQubePDCtrl</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#pyrado.policies.special.environment_specific.QQubePDCtrl.forward"><code class="docutils literal notranslate"><span class="pre">QQubePDCtrl.forward()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pyrado.policies.special.environment_specific.QQubePDCtrl.init_param"><code class="docutils literal notranslate"><span class="pre">QQubePDCtrl.init_param()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pyrado.policies.special.environment_specific.QQubePDCtrl.training"><code class="docutils literal notranslate"><span class="pre">QQubePDCtrl.training</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#pyrado.policies.special.environment_specific.QQubeSwingUpAndBalanceCtrl"><code class="docutils literal notranslate"><span class="pre">QQubeSwingUpAndBalanceCtrl</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#pyrado.policies.special.environment_specific.QQubeSwingUpAndBalanceCtrl.forward"><code class="docutils literal notranslate"><span class="pre">QQubeSwingUpAndBalanceCtrl.forward()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pyrado.policies.special.environment_specific.QQubeSwingUpAndBalanceCtrl.init_param"><code class="docutils literal notranslate"><span class="pre">QQubeSwingUpAndBalanceCtrl.init_param()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pyrado.policies.special.environment_specific.QQubeSwingUpAndBalanceCtrl.name"><code class="docutils literal notranslate"><span class="pre">QQubeSwingUpAndBalanceCtrl.name</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pyrado.policies.special.environment_specific.QQubeSwingUpAndBalanceCtrl.pd_enabled"><code class="docutils literal notranslate"><span class="pre">QQubeSwingUpAndBalanceCtrl.pd_enabled()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pyrado.policies.special.environment_specific.QQubeSwingUpAndBalanceCtrl.reset"><code class="docutils literal notranslate"><span class="pre">QQubeSwingUpAndBalanceCtrl.reset()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#pyrado.policies.special.environment_specific.create_mg_joint_pos_policy"><code class="docutils literal notranslate"><span class="pre">create_mg_joint_pos_policy()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#pyrado.policies.special.environment_specific.create_pend_excitation_policy"><code class="docutils literal notranslate"><span class="pre">create_pend_excitation_policy()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#pyrado.policies.special.environment_specific.wam_jsp_7dof_sin"><code class="docutils literal notranslate"><span class="pre">wam_jsp_7dof_sin()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-pyrado.policies.special">Module contents</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Spaces:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="spaces.html">spaces</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Tasks &amp; Rewards:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="tasks.html">tasks</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Sampling:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="sampling.html">sampling</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Plotting:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="plotting.html">plotting</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Utilities:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="utils.html">utils</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Pyrado</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home"></a></li>
      <li class="breadcrumb-item active">special</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/policies.special.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="special">
<h1>special<a class="headerlink" href="#special" title="Permalink to this heading"></a></h1>
<section id="module-pyrado.policies.special.domain_distribution">
<span id="domain-distribution"></span><h2>domain_distribution<a class="headerlink" href="#module-pyrado.policies.special.domain_distribution" title="Permalink to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="pyrado.policies.special.domain_distribution.DomainDistrParamPolicy">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">DomainDistrParamPolicy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mapping</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">trafo_mask</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">list</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Tensor</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prior</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="domain_randomization.html#pyrado.domain_randomization.domain_randomizer.DomainRandomizer" title="pyrado.domain_randomization.domain_randomizer.DomainRandomizer"><span class="pre">DomainRandomizer</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scale_params</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_cuda</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/policies/special/domain_distribution.html#DomainDistrParamPolicy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.policies.special.domain_distribution.DomainDistrParamPolicy" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="policies.html#pyrado.policies.base.Policy" title="pyrado.policies.base.Policy"><code class="xref py py-class docutils literal notranslate"><span class="pre">Policy</span></code></a></p>
<p>A proxy to the Policy class in order to use the policy’s parameters as domain distribution parameters</p>
<p>Constructor</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mapping</strong> – mapping from subsequent integers to domain distribution parameters, where the first string of
the value tuple is the name of the domain parameter (e.g. mass, length) and the second string is
the name of the distribution parameter (e.g. mean, std).  The integers are indices of the numpy
array which come from the algorithm.</p></li>
<li><p><strong>trafo_mask</strong> – every domain parameter that is set to <cite>True</cite> in this mask will be learned via a ‘virtual’
parameter, i.e. in sqrt-space, and then finally squared to retrieve the domain parameter.
This transformation is useful to avoid setting a negative variance.</p></li>
<li><p><strong>prior</strong> – prior believe about the distribution parameters in from of a <cite>DomainRandomizer</cite></p></li>
<li><p><strong>scale_params</strong> – if <cite>True</cite>, the sqrt-transformed policy parameters are scaled in the range of <span class="math notranslate nohighlight">\([-0.5, 0.5]\)</span>.
The advantage of this is to make the parameter-based exploration easier.</p></li>
<li><p><strong>use_cuda</strong> – <cite>True</cite> to move the policy to the GPU, <cite>False</cite> (default) to use the CPU</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyrado.policies.special.domain_distribution.DomainDistrParamPolicy.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">obs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Tensor</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tensor</span></span></span><a class="reference internal" href="_modules/pyrado/policies/special/domain_distribution.html#DomainDistrParamPolicy.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.policies.special.domain_distribution.DomainDistrParamPolicy.forward" title="Permalink to this definition"></a></dt>
<dd><p>Get the action according to the policy and the observations (forward pass).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>args</strong> – inputs, e.g. an observation from the environment or an observation and a hidden state</p></li>
<li><p><strong>kwargs</strong> – inputs, e.g. an observation from the environment or an observation and a hidden state</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>outputs, e.g. an action or an action and a hidden state</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyrado.policies.special.domain_distribution.DomainDistrParamPolicy.init_param">
<span class="sig-name descname"><span class="pre">init_param</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">init_values</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Tensor</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/policies/special/domain_distribution.html#DomainDistrParamPolicy.init_param"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.policies.special.domain_distribution.DomainDistrParamPolicy.init_param" title="Permalink to this definition"></a></dt>
<dd><p>Initialize the policy’s parameters. By default the parameters are initialized randomly.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>init_values</strong> – tensor of fixed initial policy parameter values</p></li>
<li><p><strong>kwargs</strong> – additional keyword arguments for the policy parameter initialization</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="pyrado.policies.special.domain_distribution.DomainDistrParamPolicy.mapping">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">mapping</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#pyrado.policies.special.domain_distribution.DomainDistrParamPolicy.mapping" title="Permalink to this definition"></a></dt>
<dd><p>Get the mapping from subsequent integers to domain distribution parameters, where the first string of the value
tuple is the name of the domain parameter and the second string is the name of the distribution parameter.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pyrado.policies.special.domain_distribution.DomainDistrParamPolicy.name">
<span class="sig-name descname"><span class="pre">name</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'ddp'</span></em><a class="headerlink" href="#pyrado.policies.special.domain_distribution.DomainDistrParamPolicy.name" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyrado.policies.special.domain_distribution.DomainDistrParamPolicy.transform_to_ddp_space">
<span class="sig-name descname"><span class="pre">transform_to_ddp_space</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tensor</span></span></span><a class="reference internal" href="_modules/pyrado/policies/special/domain_distribution.html#DomainDistrParamPolicy.transform_to_ddp_space"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.policies.special.domain_distribution.DomainDistrParamPolicy.transform_to_ddp_space" title="Permalink to this definition"></a></dt>
<dd><p>Get the transformed domain distribution parameters. Where ever the mask is <cite>True</cite>, the corresponding policy
parameter is learned in sqrt space. Moreover, the policy parameters can be scaled.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>params</strong> – policy parameters (can be the sqrt of the actual domain distribution parameter value)</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>policy parameters transformed according to the mask</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-pyrado.policies.special.environment_specific">
<span id="environment-specific"></span><h2>environment_specific<a class="headerlink" href="#module-pyrado.policies.special.environment_specific" title="Permalink to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="pyrado.policies.special.environment_specific.QBallBalancerPDCtrl">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">QBallBalancerPDCtrl</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">env_spec</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="utils.html#pyrado.utils.data_types.EnvSpec" title="pyrado.utils.data_types.EnvSpec"><span class="pre">EnvSpec</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">state_des</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">tensor([0.0,</span> <span class="pre">0.0])</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kp</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Tensor</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kd</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Tensor</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_cuda</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/policies/special/environment_specific.html#QBallBalancerPDCtrl"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.policies.special.environment_specific.QBallBalancerPDCtrl" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="policies.html#pyrado.policies.base.Policy" title="pyrado.policies.base.Policy"><code class="xref py py-class docutils literal notranslate"><span class="pre">Policy</span></code></a></p>
<p>PD-controller for the Quanser Ball Balancer.
The only but significant difference of this controller to the other PD controller is the clipping of the actions.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This class’s desired state specification deviates from the Pyrado policies which interact with a <cite>Task</cite>.</p>
</div>
<p>Constructor</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>env_spec</strong> – environment specification</p></li>
<li><p><strong>state_des</strong> – tensor of desired x and y ball position [m]</p></li>
<li><p><strong>kp</strong> – 2x2 tensor of constant controller feedback coefficients for error [V/m]</p></li>
<li><p><strong>kd</strong> – 2x2 tensor of constant controller feedback coefficients for error time derivative [Vs/m]</p></li>
<li><p><strong>use_cuda</strong> – <cite>True</cite> to move the policy to the GPU, <cite>False</cite> (default) to use the CPU</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyrado.policies.special.environment_specific.QBallBalancerPDCtrl.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">obs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tensor</span></span></span><a class="reference internal" href="_modules/pyrado/policies/special/environment_specific.html#QBallBalancerPDCtrl.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.policies.special.environment_specific.QBallBalancerPDCtrl.forward" title="Permalink to this definition"></a></dt>
<dd><p>Calculate the controller output.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>obs</strong> – observation from the environment</p>
</dd>
<dt class="field-even">Return act</dt>
<dd class="field-even"><p>controller output [V]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyrado.policies.special.environment_specific.QBallBalancerPDCtrl.init_param">
<span class="sig-name descname"><span class="pre">init_param</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">kp</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Tensor</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kd</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Tensor</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/policies/special/environment_specific.html#QBallBalancerPDCtrl.init_param"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.policies.special.environment_specific.QBallBalancerPDCtrl.init_param" title="Permalink to this definition"></a></dt>
<dd><p>Initialize controller parameters.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>kp</strong> – 2x2 tensor of constant controller feedback coefficients for error [V/m]</p></li>
<li><p><strong>kd</strong> – 2x2 tensor of constant controller feedback coefficients for error time derivative [Vs/m]</p></li>
<li><p><strong>verbose</strong> – print the controller’s gains</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pyrado.policies.special.environment_specific.QBallBalancerPDCtrl.name">
<span class="sig-name descname"><span class="pre">name</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'qbb-pd'</span></em><a class="headerlink" href="#pyrado.policies.special.environment_specific.QBallBalancerPDCtrl.name" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyrado.policies.special.environment_specific.QBallBalancerPDCtrl.reset">
<span class="sig-name descname"><span class="pre">reset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/policies/special/environment_specific.html#QBallBalancerPDCtrl.reset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.policies.special.environment_specific.QBallBalancerPDCtrl.reset" title="Permalink to this definition"></a></dt>
<dd><p>Set the domain parameters defining the controller’s model using a dict called <cite>domain_param</cite>.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="pyrado.policies.special.environment_specific.QCartPoleGoToLimCtrl">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">QCartPoleGoToLimCtrl</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">init_state</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">positive</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/policies/special/environment_specific.html#QCartPoleGoToLimCtrl"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.policies.special.environment_specific.QCartPoleGoToLimCtrl" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Controller for going to one of the joint limits (part of the calibration routine)</p>
<p>Constructor</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>init_state</strong> – initial state of the system</p></li>
<li><p><strong>positive</strong> – direction switch</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="pyrado.policies.special.environment_specific.QCartPoleSwingUpAndBalanceCtrl">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">QCartPoleSwingUpAndBalanceCtrl</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">env_spec</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="utils.html#pyrado.utils.data_types.EnvSpec" title="pyrado.utils.data_types.EnvSpec"><span class="pre">EnvSpec</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">long</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_cuda</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/policies/special/environment_specific.html#QCartPoleSwingUpAndBalanceCtrl"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.policies.special.environment_specific.QCartPoleSwingUpAndBalanceCtrl" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="policies.html#pyrado.policies.base.Policy" title="pyrado.policies.base.Policy"><code class="xref py py-class docutils literal notranslate"><span class="pre">Policy</span></code></a></p>
<p>Swing-up and balancing controller for the Quanser Cart-Pole</p>
<p>Constructor</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>env_spec</strong> – environment specification</p></li>
<li><p><strong>long</strong> – flag for long or short pole</p></li>
<li><p><strong>use_cuda</strong> – <cite>True</cite> to move the policy to the GPU, <cite>False</cite> (default) to use the CPU</p></li>
</ul>
</dd>
</dl>
<dl class="py property">
<dt class="sig sig-object py" id="pyrado.policies.special.environment_specific.QCartPoleSwingUpAndBalanceCtrl.K_pd">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">K_pd</span></span><a class="headerlink" href="#pyrado.policies.special.environment_specific.QCartPoleSwingUpAndBalanceCtrl.K_pd" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyrado.policies.special.environment_specific.QCartPoleSwingUpAndBalanceCtrl.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">obs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tensor</span></span></span><a class="reference internal" href="_modules/pyrado/policies/special/environment_specific.html#QCartPoleSwingUpAndBalanceCtrl.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.policies.special.environment_specific.QCartPoleSwingUpAndBalanceCtrl.forward" title="Permalink to this definition"></a></dt>
<dd><p>Calculate the controller output.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>obs</strong> – observation from the environment</p>
</dd>
<dt class="field-even">Return act</dt>
<dd class="field-even"><p>controller output [V]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyrado.policies.special.environment_specific.QCartPoleSwingUpAndBalanceCtrl.init_param">
<span class="sig-name descname"><span class="pre">init_param</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">init_values</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Tensor</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/policies/special/environment_specific.html#QCartPoleSwingUpAndBalanceCtrl.init_param"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.policies.special.environment_specific.QCartPoleSwingUpAndBalanceCtrl.init_param" title="Permalink to this definition"></a></dt>
<dd><p>Initialize the policy’s parameters. By default the parameters are initialized randomly.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>init_values</strong> – tensor of fixed initial policy parameter values</p></li>
<li><p><strong>kwargs</strong> – additional keyword arguments for the policy parameter initialization</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="pyrado.policies.special.environment_specific.QCartPoleSwingUpAndBalanceCtrl.k_e">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">k_e</span></span><a class="headerlink" href="#pyrado.policies.special.environment_specific.QCartPoleSwingUpAndBalanceCtrl.k_e" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="pyrado.policies.special.environment_specific.QCartPoleSwingUpAndBalanceCtrl.k_p">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">k_p</span></span><a class="headerlink" href="#pyrado.policies.special.environment_specific.QCartPoleSwingUpAndBalanceCtrl.k_p" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pyrado.policies.special.environment_specific.QCartPoleSwingUpAndBalanceCtrl.name">
<span class="sig-name descname"><span class="pre">name</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'qcp-sub'</span></em><a class="headerlink" href="#pyrado.policies.special.environment_specific.QCartPoleSwingUpAndBalanceCtrl.name" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="pyrado.policies.special.environment_specific.QCartPoleSwingUpAndBalanceCtrl.u_max">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">u_max</span></span><a class="headerlink" href="#pyrado.policies.special.environment_specific.QCartPoleSwingUpAndBalanceCtrl.u_max" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="pyrado.policies.special.environment_specific.QQubeEnergyCtrl">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">QQubeEnergyCtrl</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">env_spec</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="utils.html#pyrado.utils.data_types.EnvSpec" title="pyrado.utils.data_types.EnvSpec"><span class="pre">EnvSpec</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">ref_energy</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">energy_gain</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">th_gain</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">acc_max</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reset_domain_param</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_cuda</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/policies/special/environment_specific.html#QQubeEnergyCtrl"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.policies.special.environment_specific.QQubeEnergyCtrl" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="policies.html#pyrado.policies.base.Policy" title="pyrado.policies.base.Policy"><code class="xref py py-class docutils literal notranslate"><span class="pre">Policy</span></code></a></p>
<p>Energy-based controller used to swing the Furuta pendulum up</p>
<p>Constructor</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>env_spec</strong> – environment specification</p></li>
<li><p><strong>ref_energy</strong> – reference energy level [J]</p></li>
<li><p><strong>energy_gain</strong> – P-gain on the energy [m/s/J]</p></li>
<li><p><strong>th_gain</strong> – P-gain on angle theta</p></li>
<li><p><strong>acc_max</strong> – maximum linear acceleration of the pendulum pivot [m/s**2]</p></li>
<li><p><strong>reset_domain_param</strong> – if <cite>True</cite> the domain parameters are reset if the they are present as a entry in the
kwargs passed to <cite>reset()</cite>. If <cite>False</cite> they are ignored.</p></li>
<li><p><strong>use_cuda</strong> – <cite>True</cite> to move the policy to the GPU, <cite>False</cite> (default) to use the CPU</p></li>
</ul>
</dd>
</dl>
<dl class="py property">
<dt class="sig sig-object py" id="pyrado.policies.special.environment_specific.QQubeEnergyCtrl.E_gain">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">E_gain</span></span><a class="headerlink" href="#pyrado.policies.special.environment_specific.QQubeEnergyCtrl.E_gain" title="Permalink to this definition"></a></dt>
<dd><p>Get the energy gain, called <span class="math notranslate nohighlight">\(\mu\)</span> in the Quanser documentation.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="pyrado.policies.special.environment_specific.QQubeEnergyCtrl.E_ref">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">E_ref</span></span><a class="headerlink" href="#pyrado.policies.special.environment_specific.QQubeEnergyCtrl.E_ref" title="Permalink to this definition"></a></dt>
<dd><p>Get the reference energy level.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyrado.policies.special.environment_specific.QQubeEnergyCtrl.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">obs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tensor</span></span></span><a class="reference internal" href="_modules/pyrado/policies/special/environment_specific.html#QQubeEnergyCtrl.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.policies.special.environment_specific.QQubeEnergyCtrl.forward" title="Permalink to this definition"></a></dt>
<dd><p>Control step of energy-based controller which is used in the swing-up controller</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>obs</strong> – observations pre-processed in the <cite>forward</cite> method of <cite>QQubeSwingUpAndBalanceCtrl</cite></p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>action</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyrado.policies.special.environment_specific.QQubeEnergyCtrl.init_param">
<span class="sig-name descname"><span class="pre">init_param</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">init_values</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Tensor</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/policies/special/environment_specific.html#QQubeEnergyCtrl.init_param"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.policies.special.environment_specific.QQubeEnergyCtrl.init_param" title="Permalink to this definition"></a></dt>
<dd><p>Initialize the policy’s parameters. By default the parameters are initialized randomly.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>init_values</strong> – tensor of fixed initial policy parameter values</p></li>
<li><p><strong>kwargs</strong> – additional keyword arguments for the policy parameter initialization</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyrado.policies.special.environment_specific.QQubeEnergyCtrl.reset">
<span class="sig-name descname"><span class="pre">reset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/policies/special/environment_specific.html#QQubeEnergyCtrl.reset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.policies.special.environment_specific.QQubeEnergyCtrl.reset" title="Permalink to this definition"></a></dt>
<dd><p>If desired, set the domain parameters defining the controller’s model using a dict called <cite>domain_param</cite>.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pyrado.policies.special.environment_specific.QQubeEnergyCtrl.training">
<span class="sig-name descname"><span class="pre">training</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#pyrado.policies.special.environment_specific.QQubeEnergyCtrl.training" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="pyrado.policies.special.environment_specific.QQubeGoToLimCtrl">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">QQubeGoToLimCtrl</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">positive</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cnt_done</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">250</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/policies/special/environment_specific.html#QQubeGoToLimCtrl"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.policies.special.environment_specific.QQubeGoToLimCtrl" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Controller for going to one of the joint limits (part of the calibration routine)</p>
<p>Constructor</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>positive</strong> – direction switch</p>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="pyrado.policies.special.environment_specific.QQubePDCtrl">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">QQubePDCtrl</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">env_spec</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="utils.html#pyrado.utils.data_types.EnvSpec" title="pyrado.utils.data_types.EnvSpec"><span class="pre">EnvSpec</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">pd_gains</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">tensor([4.0,</span> <span class="pre">0.0,</span> <span class="pre">1.0,</span> <span class="pre">0.0])</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">th_des</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">al_des</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tols</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">tensor([0.0262,</span> <span class="pre">0.0087,</span> <span class="pre">0.0017,</span> <span class="pre">0.0017],</span> <span class="pre">dtype=torch.float64)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_cuda</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/policies/special/environment_specific.html#QQubePDCtrl"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.policies.special.environment_specific.QQubePDCtrl" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="policies.html#pyrado.policies.base.Policy" title="pyrado.policies.base.Policy"><code class="xref py py-class docutils literal notranslate"><span class="pre">Policy</span></code></a></p>
<p>PD-controller for the Quanser Qube.
Drives Qube to <span class="math notranslate nohighlight">\(x_{des} = [\theta_{des}, \alpha_{des}, 0.0, 0.0]\)</span>.
Flag done is set when <span class="math notranslate nohighlight">\(|x_des - x| &lt; tol\)</span>.</p>
<p>Constructor</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>env_spec</strong> – environment specification</p></li>
<li><p><strong>pd_gains</strong> – controller gains, the default values stabilize the pendulum at the center hanging down</p></li>
<li><p><strong>th_des</strong> – desired rotary pole angle [rad]</p></li>
<li><p><strong>al_des</strong> – desired pendulum pole angle [rad]</p></li>
<li><p><strong>tols</strong> – tolerances for the desired angles <span class="math notranslate nohighlight">\(\theta\)</span> and <span class="math notranslate nohighlight">\(\alpha\)</span> [rad]</p></li>
<li><p><strong>use_cuda</strong> – <cite>True</cite> to move the policy to the GPU, <cite>False</cite> (default) to use the CPU</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyrado.policies.special.environment_specific.QQubePDCtrl.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">meas</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tensor</span></span></span><a class="reference internal" href="_modules/pyrado/policies/special/environment_specific.html#QQubePDCtrl.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.policies.special.environment_specific.QQubePDCtrl.forward" title="Permalink to this definition"></a></dt>
<dd><p>Get the action according to the policy and the observations (forward pass).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>args</strong> – inputs, e.g. an observation from the environment or an observation and a hidden state</p></li>
<li><p><strong>kwargs</strong> – inputs, e.g. an observation from the environment or an observation and a hidden state</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>outputs, e.g. an action or an action and a hidden state</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyrado.policies.special.environment_specific.QQubePDCtrl.init_param">
<span class="sig-name descname"><span class="pre">init_param</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">init_values</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Tensor</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/policies/special/environment_specific.html#QQubePDCtrl.init_param"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.policies.special.environment_specific.QQubePDCtrl.init_param" title="Permalink to this definition"></a></dt>
<dd><p>Initialize the policy’s parameters. By default the parameters are initialized randomly.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>init_values</strong> – tensor of fixed initial policy parameter values</p></li>
<li><p><strong>kwargs</strong> – additional keyword arguments for the policy parameter initialization</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pyrado.policies.special.environment_specific.QQubePDCtrl.training">
<span class="sig-name descname"><span class="pre">training</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#pyrado.policies.special.environment_specific.QQubePDCtrl.training" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="pyrado.policies.special.environment_specific.QQubeSwingUpAndBalanceCtrl">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">QQubeSwingUpAndBalanceCtrl</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">env_spec</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="utils.html#pyrado.utils.data_types.EnvSpec" title="pyrado.utils.data_types.EnvSpec"><span class="pre">EnvSpec</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">ref_energy</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.025</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">energy_gain</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">50.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">energy_th_gain</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.4</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">acc_max</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">5.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha_max_pd_enable</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">20.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pd_gains</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">tensor([-2.0,</span> <span class="pre">35.0,</span> <span class="pre">-1.5,</span> <span class="pre">3.0])</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reset_domain_param</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_cuda</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/policies/special/environment_specific.html#QQubeSwingUpAndBalanceCtrl"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.policies.special.environment_specific.QQubeSwingUpAndBalanceCtrl" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="policies.html#pyrado.policies.base.Policy" title="pyrado.policies.base.Policy"><code class="xref py py-class docutils literal notranslate"><span class="pre">Policy</span></code></a></p>
<p>Hybrid controller (QQubeEnergyCtrl, QQubePDCtrl) switching based on the pendulum pole angle alpha</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Extracted Quanser’s values from q_qube2_swingup.mdl</p>
</div>
<p>Constructor</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>env_spec</strong> – environment specification</p></li>
<li><p><strong>ref_energy</strong> – reference energy level</p></li>
<li><p><strong>energy_gain</strong> – P-gain on the difference to the reference energy</p></li>
<li><p><strong>energy_th_gain</strong> – P-gain on angle theta for the Energy controller. This term does not exist in Quanser’s
implementation. Its purpose it to keep the Qube from moving too much around the
vertical axis, i.e. prevent bouncing against the mechanical boundaries.</p></li>
<li><p><strong>acc_max</strong> – maximum acceleration</p></li>
<li><p><strong>alpha_max_pd_enable</strong> – angle threshold for enabling the PD -controller [deg]</p></li>
<li><p><strong>pd_gains</strong> – gains for the PD-controller</p></li>
<li><p><strong>use_cuda</strong> – <cite>True</cite> to move the policy to the GPU, <cite>False</cite> (default) to use the CPU</p></li>
</ul>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The controller’s parameters strongly depend on the frequency at which it is operating.</p>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="pyrado.policies.special.environment_specific.QQubeSwingUpAndBalanceCtrl.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">obs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">tensor</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/policies/special/environment_specific.html#QQubeSwingUpAndBalanceCtrl.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.policies.special.environment_specific.QQubeSwingUpAndBalanceCtrl.forward" title="Permalink to this definition"></a></dt>
<dd><p>Get the action according to the policy and the observations (forward pass).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>args</strong> – inputs, e.g. an observation from the environment or an observation and a hidden state</p></li>
<li><p><strong>kwargs</strong> – inputs, e.g. an observation from the environment or an observation and a hidden state</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>outputs, e.g. an action or an action and a hidden state</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyrado.policies.special.environment_specific.QQubeSwingUpAndBalanceCtrl.init_param">
<span class="sig-name descname"><span class="pre">init_param</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">init_values</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Tensor</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/policies/special/environment_specific.html#QQubeSwingUpAndBalanceCtrl.init_param"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.policies.special.environment_specific.QQubeSwingUpAndBalanceCtrl.init_param" title="Permalink to this definition"></a></dt>
<dd><p>Initialize the policy’s parameters. By default the parameters are initialized randomly.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>init_values</strong> – tensor of fixed initial policy parameter values</p></li>
<li><p><strong>kwargs</strong> – additional keyword arguments for the policy parameter initialization</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pyrado.policies.special.environment_specific.QQubeSwingUpAndBalanceCtrl.name">
<span class="sig-name descname"><span class="pre">name</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'qq-sub'</span></em><a class="headerlink" href="#pyrado.policies.special.environment_specific.QQubeSwingUpAndBalanceCtrl.name" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyrado.policies.special.environment_specific.QQubeSwingUpAndBalanceCtrl.pd_enabled">
<span class="sig-name descname"><span class="pre">pd_enabled</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">cos_al:</span> <span class="pre">[&lt;class</span> <span class="pre">'float'&gt;,</span> <span class="pre">&lt;class</span> <span class="pre">'torch.Tensor'&gt;]</span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">bool</span></span></span><a class="reference internal" href="_modules/pyrado/policies/special/environment_specific.html#QQubeSwingUpAndBalanceCtrl.pd_enabled"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.policies.special.environment_specific.QQubeSwingUpAndBalanceCtrl.pd_enabled" title="Permalink to this definition"></a></dt>
<dd><p>Check if the PD-controller should be enabled based oin a predefined threshold on the alpha angle.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>cos_al</strong> – cosine of the pendulum pole angle</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>bool if condition is met</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyrado.policies.special.environment_specific.QQubeSwingUpAndBalanceCtrl.reset">
<span class="sig-name descname"><span class="pre">reset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/policies/special/environment_specific.html#QQubeSwingUpAndBalanceCtrl.reset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.policies.special.environment_specific.QQubeSwingUpAndBalanceCtrl.reset" title="Permalink to this definition"></a></dt>
<dd><p>Reset the policy’s internal state. This should be called at the start of a rollout.
The default implementation does nothing.</p>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyrado.policies.special.environment_specific.create_mg_joint_pos_policy">
<span class="sig-name descname"><span class="pre">create_mg_joint_pos_policy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">env</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="environments.html#pyrado.environments.sim_base.SimEnv" title="pyrado.environments.sim_base.SimEnv"><span class="pre">SimEnv</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">t_strike_end</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.5</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="policies.feed_forward.html#pyrado.policies.feed_forward.time.TimePolicy" title="pyrado.policies.feed_forward.time.TimePolicy"><span class="pre">TimePolicy</span></a></span></span><a class="reference internal" href="_modules/pyrado/policies/special/environment_specific.html#create_mg_joint_pos_policy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.policies.special.environment_specific.create_mg_joint_pos_policy" title="Permalink to this definition"></a></dt>
<dd><p>Create a policy that executes the strike for mini golf by setting joint position commands.
Used in the experiments of [1].</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p>[1] F. Muratore, T. Gruner, F. Wiese, B. Belousov, M. Gienger, J. Peters, “TITLE”, VENUE, YEAR</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>env</strong> – mini golf simulation environment</p>
</dd>
</dl>
<p>:param t_strike_end:time when to finish the movement [s]
:return: policy which executes the strike solely dependent on the time</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyrado.policies.special.environment_specific.create_pend_excitation_policy">
<span class="sig-name descname"><span class="pre">create_pend_excitation_policy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">env</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="environments.pysim.html#pyrado.environments.pysim.pendulum.PendulumSim" title="pyrado.environments.pysim.pendulum.PendulumSim"><span class="pre">PendulumSim</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_rollouts</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f_sin</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1.0</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="policies.feed_forward.html#pyrado.policies.feed_forward.playback.PlaybackPolicy" title="pyrado.policies.feed_forward.playback.PlaybackPolicy"><span class="pre">PlaybackPolicy</span></a></span></span><a class="reference internal" href="_modules/pyrado/policies/special/environment_specific.html#create_pend_excitation_policy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.policies.special.environment_specific.create_pend_excitation_policy" title="Permalink to this definition"></a></dt>
<dd><p>Create a policy that returns a previously recorded action time series.
Used in the experiments of [1].</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p>[1] F. Muratore, T. Gruner, F. Wiese, B. Belousov, M. Gienger, J. Peters, “TITLE”, VENUE, YEAR</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>env</strong> – pendulum simulation environment</p></li>
<li><p><strong>num_rollouts</strong> – number of rollouts to store in the policy’s buffer</p></li>
<li><p><strong>f_sin</strong> – frequency of the sinus [Hz]</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>policy with recorded action time series</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyrado.policies.special.environment_specific.wam_jsp_7dof_sin">
<span class="sig-name descname"><span class="pre">wam_jsp_7dof_sin</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flip_sign</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/policies/special/environment_specific.html#wam_jsp_7dof_sin"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.policies.special.environment_specific.wam_jsp_7dof_sin" title="Permalink to this definition"></a></dt>
<dd><p>A sin-based excitation function for the 7-DoF WAM, describing desired a desired joint angle offset and its velocity
at every point in time</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>t</strong> – time</p></li>
<li><p><strong>flip_sign</strong> – if <cite>True</cite>, flip the sign</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>joint angle positions and velocities</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-pyrado.policies.special">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-pyrado.policies.special" title="Permalink to this heading"></a></h2>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="policies.recurrent.html" class="btn btn-neutral float-left" title="recurrent" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="spaces.html" class="btn btn-neutral float-right" title="spaces" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2020.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>