<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>meta &mdash; Pyrado 0.7.1 documentation</title>
      <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="_static/graphviz.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/sphinx_highlight.js"></script>
        <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="regression" href="algorithms.regression.html" />
    <link rel="prev" title="step_based" href="algorithms.step_based.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="index.html" class="icon icon-home"> Pyrado
          </a>
              <div class="version">
                0.7.1
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Examples:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="examples/1_basic_experiment.html">How to run an experiment</a></li>
<li class="toctree-l1"><a class="reference internal" href="examples/2_wrapping_environments.html">How to wrap an environment</a></li>
<li class="toctree-l1"><a class="reference internal" href="examples/3_algorithm_skeleton.html">How to create an algorithm</a></li>
<li class="toctree-l1"><a class="reference internal" href="examples/4_creating_rcspysim_environments.html">How to create an RcsPySim environment</a></li>
<li class="toctree-l1"><a class="reference internal" href="examples/5_panda3d_visualization.html"><strong>How to create a visualization</strong></a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Environments:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="environments.html">environments</a></li>
<li class="toctree-l1"><a class="reference internal" href="environments.barrett_wam.html">barrett_wam</a></li>
<li class="toctree-l1"><a class="reference internal" href="environments.mujoco.html">mujoco</a></li>
<li class="toctree-l1"><a class="reference internal" href="environments.pysim.html">pysim</a></li>
<li class="toctree-l1"><a class="reference internal" href="environments.quanser.html">quanser</a></li>
<li class="toctree-l1"><a class="reference internal" href="environments.rcspysim.html">rcspysim</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Environment Wrappers:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="environment_wrappers.html">environment_wrappers</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Domain Randomization:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="domain_randomization.html">domain_randomization</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Algorithms:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="algorithms.html">algorithms</a></li>
<li class="toctree-l1"><a class="reference internal" href="algorithms.episodic.html">episodic</a></li>
<li class="toctree-l1"><a class="reference internal" href="algorithms.step_based.html">step_based</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">meta</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#module-pyrado.algorithms.meta.adr">adr</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#pyrado.algorithms.meta.adr.ADR"><code class="docutils literal notranslate"><span class="pre">ADR</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#pyrado.algorithms.meta.adr.ADR.compute_params"><code class="docutils literal notranslate"><span class="pre">ADR.compute_params()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pyrado.algorithms.meta.adr.ADR.convert_and_detach"><code class="docutils literal notranslate"><span class="pre">ADR.convert_and_detach()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pyrado.algorithms.meta.adr.ADR.name"><code class="docutils literal notranslate"><span class="pre">ADR.name</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pyrado.algorithms.meta.adr.ADR.sample_count"><code class="docutils literal notranslate"><span class="pre">ADR.sample_count</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pyrado.algorithms.meta.adr.ADR.save_snapshot"><code class="docutils literal notranslate"><span class="pre">ADR.save_snapshot()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pyrado.algorithms.meta.adr.ADR.step"><code class="docutils literal notranslate"><span class="pre">ADR.step()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#pyrado.algorithms.meta.adr.RewardGenerator"><code class="docutils literal notranslate"><span class="pre">RewardGenerator</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#pyrado.algorithms.meta.adr.RewardGenerator.get_reward"><code class="docutils literal notranslate"><span class="pre">RewardGenerator.get_reward()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pyrado.algorithms.meta.adr.RewardGenerator.train"><code class="docutils literal notranslate"><span class="pre">RewardGenerator.train()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#pyrado.algorithms.meta.adr.SVPGAdapter"><code class="docutils literal notranslate"><span class="pre">SVPGAdapter</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#pyrado.algorithms.meta.adr.SVPGAdapter.act_space"><code class="docutils literal notranslate"><span class="pre">SVPGAdapter.act_space</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pyrado.algorithms.meta.adr.SVPGAdapter.array_to_dict"><code class="docutils literal notranslate"><span class="pre">SVPGAdapter.array_to_dict()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pyrado.algorithms.meta.adr.SVPGAdapter.eval_states"><code class="docutils literal notranslate"><span class="pre">SVPGAdapter.eval_states()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pyrado.algorithms.meta.adr.SVPGAdapter.nominal"><code class="docutils literal notranslate"><span class="pre">SVPGAdapter.nominal()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pyrado.algorithms.meta.adr.SVPGAdapter.nominal_dict"><code class="docutils literal notranslate"><span class="pre">SVPGAdapter.nominal_dict()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pyrado.algorithms.meta.adr.SVPGAdapter.obs_space"><code class="docutils literal notranslate"><span class="pre">SVPGAdapter.obs_space</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pyrado.algorithms.meta.adr.SVPGAdapter.params"><code class="docutils literal notranslate"><span class="pre">SVPGAdapter.params()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pyrado.algorithms.meta.adr.SVPGAdapter.reset"><code class="docutils literal notranslate"><span class="pre">SVPGAdapter.reset()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pyrado.algorithms.meta.adr.SVPGAdapter.step"><code class="docutils literal notranslate"><span class="pre">SVPGAdapter.step()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#pyrado.algorithms.meta.adr.preprocess_rollout"><code class="docutils literal notranslate"><span class="pre">preprocess_rollout()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-pyrado.algorithms.meta.arpl">arpl</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#pyrado.algorithms.meta.arpl.ARPL"><code class="docutils literal notranslate"><span class="pre">ARPL</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#pyrado.algorithms.meta.arpl.ARPL.name"><code class="docutils literal notranslate"><span class="pre">ARPL.name</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pyrado.algorithms.meta.arpl.ARPL.sample_count"><code class="docutils literal notranslate"><span class="pre">ARPL.sample_count</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pyrado.algorithms.meta.arpl.ARPL.save_snapshot"><code class="docutils literal notranslate"><span class="pre">ARPL.save_snapshot()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pyrado.algorithms.meta.arpl.ARPL.step"><code class="docutils literal notranslate"><span class="pre">ARPL.step()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pyrado.algorithms.meta.arpl.ARPL.wrap_env"><code class="docutils literal notranslate"><span class="pre">ARPL.wrap_env()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#bayessim">bayessim</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-pyrado.algorithms.meta.bayrn">bayrn</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#pyrado.algorithms.meta.bayrn.BayRn"><code class="docutils literal notranslate"><span class="pre">BayRn</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#pyrado.algorithms.meta.bayrn.BayRn.argmax_posterior_mean"><code class="docutils literal notranslate"><span class="pre">BayRn.argmax_posterior_mean()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pyrado.algorithms.meta.bayrn.BayRn.eval_init_policies"><code class="docutils literal notranslate"><span class="pre">BayRn.eval_init_policies()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pyrado.algorithms.meta.bayrn.BayRn.eval_policy"><code class="docutils literal notranslate"><span class="pre">BayRn.eval_policy()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pyrado.algorithms.meta.bayrn.BayRn.iteration_key"><code class="docutils literal notranslate"><span class="pre">BayRn.iteration_key</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pyrado.algorithms.meta.bayrn.BayRn.load_snapshot"><code class="docutils literal notranslate"><span class="pre">BayRn.load_snapshot()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pyrado.algorithms.meta.bayrn.BayRn.name"><code class="docutils literal notranslate"><span class="pre">BayRn.name</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pyrado.algorithms.meta.bayrn.BayRn.policy"><code class="docutils literal notranslate"><span class="pre">BayRn.policy</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pyrado.algorithms.meta.bayrn.BayRn.sample_count"><code class="docutils literal notranslate"><span class="pre">BayRn.sample_count</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pyrado.algorithms.meta.bayrn.BayRn.save_snapshot"><code class="docutils literal notranslate"><span class="pre">BayRn.save_snapshot()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pyrado.algorithms.meta.bayrn.BayRn.step"><code class="docutils literal notranslate"><span class="pre">BayRn.step()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pyrado.algorithms.meta.bayrn.BayRn.subroutine"><code class="docutils literal notranslate"><span class="pre">BayRn.subroutine</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pyrado.algorithms.meta.bayrn.BayRn.train_argmax_policy"><code class="docutils literal notranslate"><span class="pre">BayRn.train_argmax_policy()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pyrado.algorithms.meta.bayrn.BayRn.train_init_policies"><code class="docutils literal notranslate"><span class="pre">BayRn.train_init_policies()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pyrado.algorithms.meta.bayrn.BayRn.train_policy_sim"><code class="docutils literal notranslate"><span class="pre">BayRn.train_policy_sim()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-pyrado.algorithms.meta.epopt">epopt</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#pyrado.algorithms.meta.epopt.EPOpt"><code class="docutils literal notranslate"><span class="pre">EPOpt</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#pyrado.algorithms.meta.epopt.EPOpt.load_snapshot"><code class="docutils literal notranslate"><span class="pre">EPOpt.load_snapshot()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pyrado.algorithms.meta.epopt.EPOpt.name"><code class="docutils literal notranslate"><span class="pre">EPOpt.name</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pyrado.algorithms.meta.epopt.EPOpt.reset"><code class="docutils literal notranslate"><span class="pre">EPOpt.reset()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pyrado.algorithms.meta.epopt.EPOpt.sample_count"><code class="docutils literal notranslate"><span class="pre">EPOpt.sample_count</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pyrado.algorithms.meta.epopt.EPOpt.save_snapshot"><code class="docutils literal notranslate"><span class="pre">EPOpt.save_snapshot()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pyrado.algorithms.meta.epopt.EPOpt.step"><code class="docutils literal notranslate"><span class="pre">EPOpt.step()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pyrado.algorithms.meta.epopt.EPOpt.subroutine"><code class="docutils literal notranslate"><span class="pre">EPOpt.subroutine</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-pyrado.algorithms.meta.iudr">iudr</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#pyrado.algorithms.meta.iudr.IUDR"><code class="docutils literal notranslate"><span class="pre">IUDR</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#pyrado.algorithms.meta.iudr.IUDR.name"><code class="docutils literal notranslate"><span class="pre">IUDR.name</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pyrado.algorithms.meta.iudr.IUDR.reset"><code class="docutils literal notranslate"><span class="pre">IUDR.reset()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pyrado.algorithms.meta.iudr.IUDR.sample_count"><code class="docutils literal notranslate"><span class="pre">IUDR.sample_count</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pyrado.algorithms.meta.iudr.IUDR.save_snapshot"><code class="docutils literal notranslate"><span class="pre">IUDR.save_snapshot()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pyrado.algorithms.meta.iudr.IUDR.step"><code class="docutils literal notranslate"><span class="pre">IUDR.step()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#npdr">npdr</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-pyrado.algorithms.meta.pddr">pddr</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#pyrado.algorithms.meta.pddr.PDDR"><code class="docutils literal notranslate"><span class="pre">PDDR</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#pyrado.algorithms.meta.pddr.PDDR.expl_strat"><code class="docutils literal notranslate"><span class="pre">PDDR.expl_strat</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pyrado.algorithms.meta.pddr.PDDR.load_snapshot"><code class="docutils literal notranslate"><span class="pre">PDDR.load_snapshot()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pyrado.algorithms.meta.pddr.PDDR.load_teacher_experiment"><code class="docutils literal notranslate"><span class="pre">PDDR.load_teacher_experiment()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pyrado.algorithms.meta.pddr.PDDR.load_teachers"><code class="docutils literal notranslate"><span class="pre">PDDR.load_teachers()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pyrado.algorithms.meta.pddr.PDDR.name"><code class="docutils literal notranslate"><span class="pre">PDDR.name</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pyrado.algorithms.meta.pddr.PDDR.prune_teachers"><code class="docutils literal notranslate"><span class="pre">PDDR.prune_teachers()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pyrado.algorithms.meta.pddr.PDDR.sample"><code class="docutils literal notranslate"><span class="pre">PDDR.sample()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pyrado.algorithms.meta.pddr.PDDR.save_snapshot"><code class="docutils literal notranslate"><span class="pre">PDDR.save_snapshot()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pyrado.algorithms.meta.pddr.PDDR.set_random_envs"><code class="docutils literal notranslate"><span class="pre">PDDR.set_random_envs()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pyrado.algorithms.meta.pddr.PDDR.step"><code class="docutils literal notranslate"><span class="pre">PDDR.step()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pyrado.algorithms.meta.pddr.PDDR.train_teachers"><code class="docutils literal notranslate"><span class="pre">PDDR.train_teachers()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pyrado.algorithms.meta.pddr.PDDR.unpack_teachers"><code class="docutils literal notranslate"><span class="pre">PDDR.unpack_teachers()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pyrado.algorithms.meta.pddr.PDDR.update"><code class="docutils literal notranslate"><span class="pre">PDDR.update()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#sbi-base">sbi_base</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-pyrado.algorithms.meta.simopt">simopt</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#pyrado.algorithms.meta.simopt.SimOpt"><code class="docutils literal notranslate"><span class="pre">SimOpt</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#pyrado.algorithms.meta.simopt.SimOpt.eval_behav_policy"><code class="docutils literal notranslate"><span class="pre">SimOpt.eval_behav_policy()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pyrado.algorithms.meta.simopt.SimOpt.eval_ddp_policy"><code class="docutils literal notranslate"><span class="pre">SimOpt.eval_ddp_policy()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pyrado.algorithms.meta.simopt.SimOpt.iteration_key"><code class="docutils literal notranslate"><span class="pre">SimOpt.iteration_key</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pyrado.algorithms.meta.simopt.SimOpt.load_snapshot"><code class="docutils literal notranslate"><span class="pre">SimOpt.load_snapshot()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pyrado.algorithms.meta.simopt.SimOpt.name"><code class="docutils literal notranslate"><span class="pre">SimOpt.name</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pyrado.algorithms.meta.simopt.SimOpt.sample_count"><code class="docutils literal notranslate"><span class="pre">SimOpt.sample_count</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pyrado.algorithms.meta.simopt.SimOpt.save_snapshot"><code class="docutils literal notranslate"><span class="pre">SimOpt.save_snapshot()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pyrado.algorithms.meta.simopt.SimOpt.step"><code class="docutils literal notranslate"><span class="pre">SimOpt.step()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pyrado.algorithms.meta.simopt.SimOpt.subroutine_distr"><code class="docutils literal notranslate"><span class="pre">SimOpt.subroutine_distr</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pyrado.algorithms.meta.simopt.SimOpt.subroutine_policy"><code class="docutils literal notranslate"><span class="pre">SimOpt.subroutine_policy</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pyrado.algorithms.meta.simopt.SimOpt.train_ddp_policy"><code class="docutils literal notranslate"><span class="pre">SimOpt.train_ddp_policy()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pyrado.algorithms.meta.simopt.SimOpt.train_policy_sim"><code class="docutils literal notranslate"><span class="pre">SimOpt.train_policy_sim()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-pyrado.algorithms.meta.spdr">spdr</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#pyrado.algorithms.meta.spdr.MultivariateNormalWrapper"><code class="docutils literal notranslate"><span class="pre">MultivariateNormalWrapper</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#pyrado.algorithms.meta.spdr.MultivariateNormalWrapper.cov"><code class="docutils literal notranslate"><span class="pre">MultivariateNormalWrapper.cov</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pyrado.algorithms.meta.spdr.MultivariateNormalWrapper.cov_chol"><code class="docutils literal notranslate"><span class="pre">MultivariateNormalWrapper.cov_chol</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pyrado.algorithms.meta.spdr.MultivariateNormalWrapper.cov_chol_tril"><code class="docutils literal notranslate"><span class="pre">MultivariateNormalWrapper.cov_chol_tril</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pyrado.algorithms.meta.spdr.MultivariateNormalWrapper.dim"><code class="docutils literal notranslate"><span class="pre">MultivariateNormalWrapper.dim</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pyrado.algorithms.meta.spdr.MultivariateNormalWrapper.from_stacked"><code class="docutils literal notranslate"><span class="pre">MultivariateNormalWrapper.from_stacked()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pyrado.algorithms.meta.spdr.MultivariateNormalWrapper.get_stacked"><code class="docutils literal notranslate"><span class="pre">MultivariateNormalWrapper.get_stacked()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pyrado.algorithms.meta.spdr.MultivariateNormalWrapper.mean"><code class="docutils literal notranslate"><span class="pre">MultivariateNormalWrapper.mean</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pyrado.algorithms.meta.spdr.MultivariateNormalWrapper.parameters"><code class="docutils literal notranslate"><span class="pre">MultivariateNormalWrapper.parameters()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#pyrado.algorithms.meta.spdr.SPDR"><code class="docutils literal notranslate"><span class="pre">SPDR</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#pyrado.algorithms.meta.spdr.SPDR.load_snapshot"><code class="docutils literal notranslate"><span class="pre">SPDR.load_snapshot()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pyrado.algorithms.meta.spdr.SPDR.name"><code class="docutils literal notranslate"><span class="pre">SPDR.name</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pyrado.algorithms.meta.spdr.SPDR.reset"><code class="docutils literal notranslate"><span class="pre">SPDR.reset()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pyrado.algorithms.meta.spdr.SPDR.sample_count"><code class="docutils literal notranslate"><span class="pre">SPDR.sample_count</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pyrado.algorithms.meta.spdr.SPDR.save_snapshot"><code class="docutils literal notranslate"><span class="pre">SPDR.save_snapshot()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pyrado.algorithms.meta.spdr.SPDR.step"><code class="docutils literal notranslate"><span class="pre">SPDR.step()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#pyrado.algorithms.meta.spdr.ravel_tril_elements"><code class="docutils literal notranslate"><span class="pre">ravel_tril_elements()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#pyrado.algorithms.meta.spdr.unravel_tril_elements"><code class="docutils literal notranslate"><span class="pre">unravel_tril_elements()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-pyrado.algorithms.meta.spota">spota</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#pyrado.algorithms.meta.spota.SPOTA"><code class="docutils literal notranslate"><span class="pre">SPOTA</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#pyrado.algorithms.meta.spota.SPOTA.iteration_key"><code class="docutils literal notranslate"><span class="pre">SPOTA.iteration_key</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pyrado.algorithms.meta.spota.SPOTA.load_snapshot"><code class="docutils literal notranslate"><span class="pre">SPOTA.load_snapshot()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pyrado.algorithms.meta.spota.SPOTA.name"><code class="docutils literal notranslate"><span class="pre">SPOTA.name</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pyrado.algorithms.meta.spota.SPOTA.policy"><code class="docutils literal notranslate"><span class="pre">SPOTA.policy</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pyrado.algorithms.meta.spota.SPOTA.sample_count"><code class="docutils literal notranslate"><span class="pre">SPOTA.sample_count</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pyrado.algorithms.meta.spota.SPOTA.save_snapshot"><code class="docutils literal notranslate"><span class="pre">SPOTA.save_snapshot()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pyrado.algorithms.meta.spota.SPOTA.step"><code class="docutils literal notranslate"><span class="pre">SPOTA.step()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pyrado.algorithms.meta.spota.SPOTA.subroutine_cand"><code class="docutils literal notranslate"><span class="pre">SPOTA.subroutine_cand</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-pyrado.algorithms.meta.udr">udr</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#pyrado.algorithms.meta.udr.UDR"><code class="docutils literal notranslate"><span class="pre">UDR</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#pyrado.algorithms.meta.udr.UDR.load_snapshot"><code class="docutils literal notranslate"><span class="pre">UDR.load_snapshot()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pyrado.algorithms.meta.udr.UDR.name"><code class="docutils literal notranslate"><span class="pre">UDR.name</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pyrado.algorithms.meta.udr.UDR.reset"><code class="docutils literal notranslate"><span class="pre">UDR.reset()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pyrado.algorithms.meta.udr.UDR.sample_count"><code class="docutils literal notranslate"><span class="pre">UDR.sample_count</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pyrado.algorithms.meta.udr.UDR.save_snapshot"><code class="docutils literal notranslate"><span class="pre">UDR.save_snapshot()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pyrado.algorithms.meta.udr.UDR.step"><code class="docutils literal notranslate"><span class="pre">UDR.step()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pyrado.algorithms.meta.udr.UDR.subroutine"><code class="docutils literal notranslate"><span class="pre">UDR.subroutine</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-pyrado.algorithms.meta">Module contents</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="algorithms.regression.html">regression</a></li>
<li class="toctree-l1"><a class="reference internal" href="algorithms.stopping_criteria.html">stopping_criteria</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Exploration:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="exploration.html">exploration</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Policies:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="policies.html">policies</a></li>
<li class="toctree-l1"><a class="reference internal" href="policies.feed_back.html">feed_back</a></li>
<li class="toctree-l1"><a class="reference internal" href="policies.feed_forward.html">feed_forward</a></li>
<li class="toctree-l1"><a class="reference internal" href="policies.recurrent.html">recurrent</a></li>
<li class="toctree-l1"><a class="reference internal" href="policies.special.html">special</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Spaces:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="spaces.html">spaces</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Tasks &amp; Rewards:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="tasks.html">tasks</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Sampling:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="sampling.html">sampling</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Plotting:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="plotting.html">plotting</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Utilities:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="utils.html">utils</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Pyrado</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home"></a></li>
      <li class="breadcrumb-item active">meta</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/algorithms.meta.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="meta">
<h1>meta<a class="headerlink" href="#meta" title="Permalink to this heading"></a></h1>
<section id="module-pyrado.algorithms.meta.adr">
<span id="adr"></span><h2>adr<a class="headerlink" href="#module-pyrado.algorithms.meta.adr" title="Permalink to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="pyrado.algorithms.meta.adr.ADR">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">ADR</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ex_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">PathLike</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">env</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="environments.html#pyrado.environments.base.Env" title="pyrado.environments.base.Env"><span class="pre">Env</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">subrtn</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="algorithms.html#pyrado.algorithms.base.Algorithm" title="pyrado.algorithms.base.Algorithm"><span class="pre">Algorithm</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">adr_hp</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">svpg_hp</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reward_generator_hp</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_iter</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_discriminator_epoch</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">svpg_warmup</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_workers</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">4</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_trajs_per_config</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">8</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">log_exploration</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">randomized_params</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Sequence</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logger</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="logger.html#pyrado.logger.step.StepLogger" title="pyrado.logger.step.StepLogger"><span class="pre">StepLogger</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/algorithms/meta/adr.html#ADR"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.algorithms.meta.adr.ADR" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="algorithms.html#pyrado.algorithms.base.Algorithm" title="pyrado.algorithms.base.Algorithm"><code class="xref py py-class docutils literal notranslate"><span class="pre">Algorithm</span></code></a></p>
<p>Active Domain Randomization (ADR)</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p>[1] B. Mehta, M. Diaz, F. Golemo, C.J. Pal, L. Paull, “Active Domain Randomization”, arXiv, 2019</p>
</div>
<p>Constructor</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>save_dir</strong> – directory to save the snapshots i.e. the results in</p></li>
<li><p><strong>env</strong> – the environment to train in</p></li>
<li><p><strong>subrtn</strong> – algorithm which performs the policy / value-function optimization</p></li>
<li><p><strong>max_iter</strong> – maximum number of iterations</p></li>
<li><p><strong>svpg_particle_hparam</strong> – SVPG particle hyperparameters</p></li>
<li><p><strong>num_svpg_particles</strong> – number of SVPG particles</p></li>
<li><p><strong>num_discriminator_epoch</strong> – epochs in discriminator training</p></li>
<li><p><strong>batch_size</strong> – batch size for training</p></li>
<li><p><strong>svpg_learning_rate</strong> – SVPG particle optimizers’ learning rate</p></li>
<li><p><strong>svpg_temperature</strong> – SVPG temperature coefficient (how strong is the influence of the particles on each other)</p></li>
<li><p><strong>svpg_evaluation_steps</strong> – how many configurations to sample between training</p></li>
<li><p><strong>svpg_horizon</strong> – how many steps until the particles are reset</p></li>
<li><p><strong>svpg_kl_factor</strong> – kl reward coefficient</p></li>
<li><p><strong>svpg_warmup</strong> – number of iterations without SVPG training in the beginning</p></li>
<li><p><strong>svpg_serial</strong> – serial mode (see SVPG)</p></li>
<li><p><strong>num_workers</strong> – number of environments for parallel sampling</p></li>
<li><p><strong>num_trajs_per_config</strong> – number of trajectories to sample from each config</p></li>
<li><p><strong>max_step_length</strong> – maximum change of physics parameters per step</p></li>
<li><p><strong>randomized_params</strong> – which parameters to randomize</p></li>
<li><p><strong>logger</strong> – logger for every step of the algorithm, if <cite>None</cite> the default logger will be created</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyrado.algorithms.meta.adr.ADR.compute_params">
<span class="sig-name descname"><span class="pre">compute_params</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sim_instances</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/algorithms/meta/adr.html#ADR.compute_params"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.algorithms.meta.adr.ADR.compute_params" title="Permalink to this definition"></a></dt>
<dd><p>Compute the parameters.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sim_instances</strong> – Physics configurations rollout</p></li>
<li><p><strong>t</strong> – time step to chose</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>parameters at the time</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyrado.algorithms.meta.adr.ADR.convert_and_detach">
<span class="sig-name descname"><span class="pre">convert_and_detach</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">arg0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/algorithms/meta/adr.html#ADR.convert_and_detach"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.algorithms.meta.adr.ADR.convert_and_detach" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pyrado.algorithms.meta.adr.ADR.name">
<span class="sig-name descname"><span class="pre">name</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'adr'</span></em><a class="headerlink" href="#pyrado.algorithms.meta.adr.ADR.name" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="pyrado.algorithms.meta.adr.ADR.sample_count">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">sample_count</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><a class="headerlink" href="#pyrado.algorithms.meta.adr.ADR.sample_count" title="Permalink to this definition"></a></dt>
<dd><p>Get the total number of samples, i.e. steps of a rollout, used for training so far.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyrado.algorithms.meta.adr.ADR.save_snapshot">
<span class="sig-name descname"><span class="pre">save_snapshot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">meta_info</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/algorithms/meta/adr.html#ADR.save_snapshot"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.algorithms.meta.adr.ADR.save_snapshot" title="Permalink to this definition"></a></dt>
<dd><p>Save the algorithm information (e.g., environment, policy, ect.).
Subclasses should call the base method to save the policy.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>meta_info</strong> – is not <cite>None</cite> if this algorithm is run as a subroutine of a meta-algorithm,
contains a dict of information about the current iteration of the meta-algorithm</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyrado.algorithms.meta.adr.ADR.step">
<span class="sig-name descname"><span class="pre">step</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">snapshot_mode</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">meta_info</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/algorithms/meta/adr.html#ADR.step"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.algorithms.meta.adr.ADR.step" title="Permalink to this definition"></a></dt>
<dd><p>Perform a single iteration of the algorithm. This includes collecting the data, updating the parameters, and
adding the metrics of interest to the logger. Does not update the <cite>curr_iter</cite> attribute.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>snapshot_mode</strong> – determines when the snapshots are stored (e.g. on every iteration or on new highscore)</p></li>
<li><p><strong>meta_info</strong> – is not <cite>None</cite> if this algorithm is run as a subroutine of a meta-algorithm,
contains a dict of information about the current iteration of the meta-algorithm</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="pyrado.algorithms.meta.adr.RewardGenerator">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">RewardGenerator</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">env_spec</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="utils.html#pyrado.utils.data_types.EnvSpec" title="pyrado.utils.data_types.EnvSpec"><span class="pre">EnvSpec</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reward_multiplier</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lr</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.003</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hidden_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">256</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logger</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="logger.html#pyrado.logger.step.StepLogger" title="pyrado.logger.step.StepLogger"><span class="pre">StepLogger</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'cpu'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/algorithms/meta/adr.html#RewardGenerator"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.algorithms.meta.adr.RewardGenerator" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Class for generating the discriminator rewards in ADR. Generates a reward using a trained discriminator network.</p>
<p>Constructor</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>env_spec</strong> – environment specification</p></li>
<li><p><strong>batch_size</strong> – batch size for each update step</p></li>
<li><p><strong>reward_multiplier</strong> – factor for the predicted probability</p></li>
<li><p><strong>lr</strong> – learning rate</p></li>
<li><p><strong>logger</strong> – logger for every step of the algorithm, if <cite>None</cite> the default logger will be created</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyrado.algorithms.meta.adr.RewardGenerator.get_reward">
<span class="sig-name descname"><span class="pre">get_reward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">traj</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="sampling.html#pyrado.sampling.step_sequence.StepSequence" title="pyrado.sampling.step_sequence.StepSequence"><span class="pre">StepSequence</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tensor</span></span></span><a class="reference internal" href="_modules/pyrado/algorithms/meta/adr.html#RewardGenerator.get_reward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.algorithms.meta.adr.RewardGenerator.get_reward" title="Permalink to this definition"></a></dt>
<dd><p>Compute the reward of a trajectory.
Trajectories considered as not fixed yield a high reward.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>traj</strong> – trajectory to evaluate</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>a score</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>to.Tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyrado.algorithms.meta.adr.RewardGenerator.train">
<span class="sig-name descname"><span class="pre">train</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">reference_trajectory</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="sampling.html#pyrado.sampling.step_sequence.StepSequence" title="pyrado.sampling.step_sequence.StepSequence"><span class="pre">StepSequence</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">randomized_trajectory</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="sampling.html#pyrado.sampling.step_sequence.StepSequence" title="pyrado.sampling.step_sequence.StepSequence"><span class="pre">StepSequence</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_epoch</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tensor</span></span></span><a class="reference internal" href="_modules/pyrado/algorithms/meta/adr.html#RewardGenerator.train"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.algorithms.meta.adr.RewardGenerator.train" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="pyrado.algorithms.meta.adr.SVPGAdapter">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">SVPGAdapter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">wrapped_env</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="environments.html#pyrado.environments.base.Env" title="pyrado.environments.base.Env"><span class="pre">Env</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">parameters</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Sequence</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="domain_randomization.html#pyrado.domain_randomization.domain_parameter.DomainParam" title="pyrado.domain_randomization.domain_parameter.DomainParam"><span class="pre">DomainParam</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inner_policy</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="policies.html#pyrado.policies.base.Policy" title="pyrado.policies.base.Policy"><span class="pre">Policy</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">discriminator</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_particles</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">step_length</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.01</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">horizon</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">50</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_rollouts_per_config</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">8</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_workers</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">4</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_steps</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">8</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/algorithms/meta/adr.html#SVPGAdapter"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.algorithms.meta.adr.SVPGAdapter" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="environment_wrappers.html#pyrado.environment_wrappers.base.EnvWrapper" title="pyrado.environment_wrappers.base.EnvWrapper"><code class="xref py py-class docutils literal notranslate"><span class="pre">EnvWrapper</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Serializable</span></code></p>
<p>Wrapper to encapsulate the domain parameter search as an RL task.</p>
<p>Constructor</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>wrapped_env</strong> – the environment to wrap</p></li>
<li><p><strong>parameters</strong> – which physics parameters should be randomized</p></li>
<li><p><strong>inner_policy</strong> – the policy to train the subrtn on</p></li>
<li><p><strong>discriminator</strong> – the discriminator to distinguish reference environments from randomized ones</p></li>
<li><p><strong>step_length</strong> – the step size</p></li>
<li><p><strong>horizon</strong> – an svpg horizon</p></li>
<li><p><strong>num_rollouts_per_config</strong> – number of trajectories to sample per physics configuration</p></li>
<li><p><strong>num_workers</strong> – number of environments for parallel sampling</p></li>
</ul>
</dd>
</dl>
<dl class="py property">
<dt class="sig sig-object py" id="pyrado.algorithms.meta.adr.SVPGAdapter.act_space">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">act_space</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="spaces.html#pyrado.spaces.base.Space" title="pyrado.spaces.base.Space"><span class="pre">Space</span></a></em><a class="headerlink" href="#pyrado.algorithms.meta.adr.SVPGAdapter.act_space" title="Permalink to this definition"></a></dt>
<dd><p>Get the space of the actions.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyrado.algorithms.meta.adr.SVPGAdapter.array_to_dict">
<span class="sig-name descname"><span class="pre">array_to_dict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">arr</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/algorithms/meta/adr.html#SVPGAdapter.array_to_dict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.algorithms.meta.adr.SVPGAdapter.array_to_dict" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyrado.algorithms.meta.adr.SVPGAdapter.eval_states">
<span class="sig-name descname"><span class="pre">eval_states</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">states</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Sequence</span><span class="p"><span class="pre">[</span></span><span class="pre">ndarray</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/algorithms/meta/adr.html#SVPGAdapter.eval_states"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.algorithms.meta.adr.SVPGAdapter.eval_states" title="Permalink to this definition"></a></dt>
<dd><p>Evaluate the states.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>states</strong> – the states to evaluate</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>respective rewards and according trajectories</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyrado.algorithms.meta.adr.SVPGAdapter.nominal">
<span class="sig-name descname"><span class="pre">nominal</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/algorithms/meta/adr.html#SVPGAdapter.nominal"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.algorithms.meta.adr.SVPGAdapter.nominal" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyrado.algorithms.meta.adr.SVPGAdapter.nominal_dict">
<span class="sig-name descname"><span class="pre">nominal_dict</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/algorithms/meta/adr.html#SVPGAdapter.nominal_dict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.algorithms.meta.adr.SVPGAdapter.nominal_dict" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="pyrado.algorithms.meta.adr.SVPGAdapter.obs_space">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">obs_space</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="spaces.html#pyrado.spaces.base.Space" title="pyrado.spaces.base.Space"><span class="pre">Space</span></a></em><a class="headerlink" href="#pyrado.algorithms.meta.adr.SVPGAdapter.obs_space" title="Permalink to this definition"></a></dt>
<dd><p>Get the space of the observations (agent’s perception of the environment).</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyrado.algorithms.meta.adr.SVPGAdapter.params">
<span class="sig-name descname"><span class="pre">params</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/algorithms/meta/adr.html#SVPGAdapter.params"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.algorithms.meta.adr.SVPGAdapter.params" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyrado.algorithms.meta.adr.SVPGAdapter.reset">
<span class="sig-name descname"><span class="pre">reset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">i</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">init_state</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">ndarray</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">domain_param</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span></span></span><a class="reference internal" href="_modules/pyrado/algorithms/meta/adr.html#SVPGAdapter.reset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.algorithms.meta.adr.SVPGAdapter.reset" title="Permalink to this definition"></a></dt>
<dd><p>Reset the environment to its initial state and optionally set different domain parameters.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>init_state</strong> – set explicit initial state if not None</p></li>
<li><p><strong>domain_param</strong> – set explicit domain parameters if not None</p></li>
</ul>
</dd>
<dt class="field-even">Return obs</dt>
<dd class="field-even"><p>initial observation of the state.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyrado.algorithms.meta.adr.SVPGAdapter.step">
<span class="sig-name descname"><span class="pre">step</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">act</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">i</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">tuple</span></span></span><a class="reference internal" href="_modules/pyrado/algorithms/meta/adr.html#SVPGAdapter.step"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.algorithms.meta.adr.SVPGAdapter.step" title="Permalink to this definition"></a></dt>
<dd><p>Perform one time step of the simulation. When a terminal condition is met, the reset function is called.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>act</strong> – action to be taken in the step</p>
</dd>
<dt class="field-even">Return tuple of obs, reward, done, and info</dt>
<dd class="field-even"><p>obs : current observation of the environment
reward: reward depending on the selected reward function
done: indicates whether the episode has ended
env_info: contains diagnostic information about the environment</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyrado.algorithms.meta.adr.preprocess_rollout">
<span class="sig-name descname"><span class="pre">preprocess_rollout</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rollout</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="sampling.html#pyrado.sampling.step_sequence.StepSequence" title="pyrado.sampling.step_sequence.StepSequence"><span class="pre">StepSequence</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tensor</span></span></span><a class="reference internal" href="_modules/pyrado/algorithms/meta/adr.html#preprocess_rollout"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.algorithms.meta.adr.preprocess_rollout" title="Permalink to this definition"></a></dt>
<dd><p>Extract observations and actions from a <cite>StepSequence</cite> and packs them into a PyTorch tensor.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>rollout</strong> – a <cite>StepSequence</cite> instance containing a trajectory</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>a PyTorch tensor` containing the trajectory</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-pyrado.algorithms.meta.arpl">
<span id="arpl"></span><h2>arpl<a class="headerlink" href="#module-pyrado.algorithms.meta.arpl" title="Permalink to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="pyrado.algorithms.meta.arpl.ARPL">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">ARPL</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">save_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">PathLike</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">env</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="environments.html#pyrado.environments.sim_base.SimEnv" title="pyrado.environments.sim_base.SimEnv"><span class="pre">SimEnv</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="environment_wrappers.html#pyrado.environment_wrappers.state_augmentation.StateAugmentationWrapper" title="pyrado.environment_wrappers.state_augmentation.StateAugmentationWrapper"><span class="pre">StateAugmentationWrapper</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">subrtn</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="algorithms.html#pyrado.algorithms.base.Algorithm" title="pyrado.algorithms.base.Algorithm"><span class="pre">Algorithm</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">policy</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="policies.html#pyrado.policies.base.Policy" title="pyrado.policies.base.Policy"><span class="pre">Policy</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_iter</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logger</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="logger.html#pyrado.logger.step.StepLogger" title="pyrado.logger.step.StepLogger"><span class="pre">StepLogger</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/algorithms/meta/arpl.html#ARPL"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.algorithms.meta.arpl.ARPL" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="algorithms.html#pyrado.algorithms.base.Algorithm" title="pyrado.algorithms.base.Algorithm"><code class="xref py py-class docutils literal notranslate"><span class="pre">Algorithm</span></code></a></p>
<p>Adversarially Robust Policy Learning (ARPL)</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p>A. Mandlekar, Y. Zhu, A. Garg, L. Fei-Fei, S. Savarese, “Adversarially Robust Policy Learning:
Active Construction of Physically-Plausible Perturbations”, IROS, 2017</p>
</div>
<p>Constructor</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>save_dir</strong> – directory to save the snapshots i.e. the results in</p></li>
<li><p><strong>env</strong> – the environment in which the agent should be trained</p></li>
<li><p><strong>subrtn</strong> – algorithm which performs the policy / value-function optimization</p></li>
<li><p><strong>policy</strong> – policy to be updated</p></li>
<li><p><strong>max_iter</strong> – the maximum number of iterations</p></li>
<li><p><strong>logger</strong> – logger for every step of the algorithm, if <cite>None</cite> the default logger will be created</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="pyrado.algorithms.meta.arpl.ARPL.name">
<span class="sig-name descname"><span class="pre">name</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'arpl'</span></em><a class="headerlink" href="#pyrado.algorithms.meta.arpl.ARPL.name" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="pyrado.algorithms.meta.arpl.ARPL.sample_count">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">sample_count</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><a class="headerlink" href="#pyrado.algorithms.meta.arpl.ARPL.sample_count" title="Permalink to this definition"></a></dt>
<dd><p>Get the total number of samples, i.e. steps of a rollout, used for training so far.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyrado.algorithms.meta.arpl.ARPL.save_snapshot">
<span class="sig-name descname"><span class="pre">save_snapshot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">meta_info</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/algorithms/meta/arpl.html#ARPL.save_snapshot"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.algorithms.meta.arpl.ARPL.save_snapshot" title="Permalink to this definition"></a></dt>
<dd><p>Save the algorithm information (e.g., environment, policy, ect.).
Subclasses should call the base method to save the policy.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>meta_info</strong> – is not <cite>None</cite> if this algorithm is run as a subroutine of a meta-algorithm,
contains a dict of information about the current iteration of the meta-algorithm</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyrado.algorithms.meta.arpl.ARPL.step">
<span class="sig-name descname"><span class="pre">step</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">snapshot_mode</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">meta_info</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/algorithms/meta/arpl.html#ARPL.step"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.algorithms.meta.arpl.ARPL.step" title="Permalink to this definition"></a></dt>
<dd><p>Perform a single iteration of the algorithm. This includes collecting the data, updating the parameters, and
adding the metrics of interest to the logger. Does not update the <cite>curr_iter</cite> attribute.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>snapshot_mode</strong> – determines when the snapshots are stored (e.g. on every iteration or on new highscore)</p></li>
<li><p><strong>meta_info</strong> – is not <cite>None</cite> if this algorithm is run as a subroutine of a meta-algorithm,
contains a dict of information about the current iteration of the meta-algorithm</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyrado.algorithms.meta.arpl.ARPL.wrap_env">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">wrap_env</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">env</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">policy</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dynamics</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">process</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">observation</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dyn_eps</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.01</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dyn_phi</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">halfspan</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.25</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">proc_eps</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.01</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">proc_phi</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.05</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">torch_observation</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">obs_eps</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.01</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">obs_phi</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.05</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/algorithms/meta/arpl.html#ARPL.wrap_env"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.algorithms.meta.arpl.ARPL.wrap_env" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>env</strong> – the environment in which the agent should be trained</p></li>
<li><p><strong>policy</strong> – policy to be updated</p></li>
<li><p><strong>dynamics</strong> – whether adversarially generated dynamics noise should be applied</p></li>
<li><p><strong>proccess</strong> – whether adversarially generated process noise should be applied</p></li>
<li><p><strong>observation</strong> – whether adversarially generated observation noise should be applied</p></li>
<li><p><strong>dyn_eps</strong> – the intensity of generated dynamics noise</p></li>
<li><p><strong>dyn_phi</strong> – the probability of applying dynamics noise</p></li>
<li><p><strong>halfspan</strong> – the halfspan of the uniform random distribution used to sample</p></li>
<li><p><strong>proc_eps</strong> – the intensity of generated process noise</p></li>
<li><p><strong>proc_phi</strong> – the probability of applying process noise</p></li>
<li><p><strong>obs_eps</strong> – the intensity of generated observation noise</p></li>
<li><p><strong>obs_phi</strong> – the probability of applying observation noise</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="bayessim">
<h2>bayessim<a class="headerlink" href="#bayessim" title="Permalink to this heading"></a></h2>
</section>
<section id="module-pyrado.algorithms.meta.bayrn">
<span id="bayrn"></span><h2>bayrn<a class="headerlink" href="#module-pyrado.algorithms.meta.bayrn" title="Permalink to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="pyrado.algorithms.meta.bayrn.BayRn">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">BayRn</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">save_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">PathLike</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">env_sim</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="environment_wrappers.html#pyrado.environment_wrappers.domain_randomization.MetaDomainRandWrapper" title="pyrado.environment_wrappers.domain_randomization.MetaDomainRandWrapper"><span class="pre">MetaDomainRandWrapper</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">env_real</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="environments.html#pyrado.environments.real_base.RealEnv" title="pyrado.environments.real_base.RealEnv"><span class="pre">RealEnv</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="environment_wrappers.html#pyrado.environment_wrappers.base.EnvWrapper" title="pyrado.environment_wrappers.base.EnvWrapper"><span class="pre">EnvWrapper</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">subrtn</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="algorithms.html#pyrado.algorithms.base.Algorithm" title="pyrado.algorithms.base.Algorithm"><span class="pre">Algorithm</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">ddp_space</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="spaces.html#pyrado.spaces.box.BoxSpace" title="pyrado.spaces.box.BoxSpace"><span class="pre">BoxSpace</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_iter</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">acq_fc</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">acq_restarts</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">acq_samples</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">acq_param</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_init_cand</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mc_estimator</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_eval_rollouts_real</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_eval_rollouts_sim</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">50</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">thold_succ</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">inf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">thold_succ_subrtn</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">-inf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">warmstart</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">policy_param_init</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Tensor</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">valuefcn_param_init</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Tensor</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">subrtn_snapshot_mode</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'best'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_workers</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">4</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logger</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="logger.html#pyrado.logger.step.StepLogger" title="pyrado.logger.step.StepLogger"><span class="pre">StepLogger</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/algorithms/meta/bayrn.html#BayRn"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.algorithms.meta.bayrn.BayRn" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="algorithms.html#pyrado.algorithms.base.InterruptableAlgorithm" title="pyrado.algorithms.base.InterruptableAlgorithm"><code class="xref py py-class docutils literal notranslate"><span class="pre">InterruptableAlgorithm</span></code></a></p>
<p>Bayesian Domain Randomization (BayRn)</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>A candidate is a set of parameter values for the domain parameter distribution and its value is the
(estimated) real-world return.</p>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p>F. Muratore, C. Eilers, M. Gienger, J. Peters, “Bayesian Domain Randomization for Sim-to-Real Transfer”,
arXiv, 2020</p>
</div>
<p>Constructor</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If you want to continue an experiment, use the <cite>load_dir</cite> argument for the <cite>train</cite> call. If you want to
initialize every of the policies with a pre-trained policy parameters use <cite>policy_param_init</cite>.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>save_dir</strong> – directory to save the snapshots i.e. the results in</p></li>
<li><p><strong>env_sim</strong> – randomized simulation environment a.k.a. source domain</p></li>
<li><p><strong>env_real</strong> – real-world environment a.k.a. target domain</p></li>
<li><p><strong>subrtn</strong> – algorithm which performs the policy / value-function optimization</p></li>
<li><p><strong>ddp_space</strong> – space holding the boundaries for the domain distribution parameters</p></li>
<li><p><strong>max_iter</strong> – maximum number of iterations</p></li>
<li><p><strong>acq_fc</strong> – Acquisition Function
‘UCB’: Upper Confidence Bound (default <span class="math notranslate nohighlight">\(eta = 0.1\)</span>)
‘EI’: Expected Improvement
‘PI’: Probability of Improvement</p></li>
<li><p><strong>acq_restarts</strong> – number of restarts for optimizing the acquisition function</p></li>
<li><p><strong>acq_samples</strong> – number of initial samples for optimizing the acquisition function</p></li>
<li><p><strong>acq_param</strong> – hyper-parameter for the acquisition function, e.g. <span class="math notranslate nohighlight">\(eta\)</span> for UCB</p></li>
<li><p><strong>num_init_cand</strong> – number of initial policies to train, ignored if <cite>init_dir</cite> is provided</p></li>
<li><p><strong>mc_estimator</strong> – estimate the return with a sample average (<cite>True</cite>) or a lower confidence
bound (<cite>False</cite>) obtained from bootstrapping</p></li>
<li><p><strong>num_eval_rollouts_real</strong> – number of rollouts in the target domain to estimate the return</p></li>
<li><p><strong>num_eval_rollouts_sim</strong> – number of rollouts in simulation to estimate the return after training</p></li>
<li><p><strong>thold_succ</strong> – success threshold on the real system’s return for BayRn, stop the algorithm if exceeded</p></li>
<li><p><strong>thold_succ_subrtn</strong> – success threshold on the simulated system’s return for the subroutine, repeat the
subroutine until the threshold is exceeded or the for a given number of iterations</p></li>
<li><p><strong>warmstart</strong> – initialize the policy (and value function) parameters with the one of the previous iteration.
This behavior can also be overruled by passing <cite>init_policy_params</cite> (and
<cite>valuefcn_param_init</cite>) explicitly.</p></li>
<li><p><strong>policy_param_init</strong> – initial policy parameter values for the subroutine, set <cite>None</cite> to be random</p></li>
<li><p><strong>valuefcn_param_init</strong> – initial value function parameter values for the subroutine, set <cite>None</cite> to be random</p></li>
<li><p><strong>subrtn_snapshot_mode</strong> – snapshot mode for saving during training of the subroutine</p></li>
<li><p><strong>num_workers</strong> – number of environments for parallel sampling</p></li>
<li><p><strong>logger</strong> – logger for every step of the algorithm, if <cite>None</cite> the default logger will be created</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyrado.algorithms.meta.bayrn.BayRn.argmax_posterior_mean">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">argmax_posterior_mean</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cands</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cands_values</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ddp_space</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="spaces.html#pyrado.spaces.box.BoxSpace" title="pyrado.spaces.box.BoxSpace"><span class="pre">BoxSpace</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_restarts</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_samples</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tensor</span></span></span><a class="reference internal" href="_modules/pyrado/algorithms/meta/bayrn.html#BayRn.argmax_posterior_mean"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.algorithms.meta.bayrn.BayRn.argmax_posterior_mean" title="Permalink to this definition"></a></dt>
<dd><p>Compute the GP input with the maximal posterior mean.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>cands</strong> – candidates a.k.a. x</p></li>
<li><p><strong>cands_values</strong> – observed values a.k.a. y</p></li>
<li><p><strong>ddp_space</strong> – space of the domain distribution parameters, indicates the lower and upper bound</p></li>
<li><p><strong>num_restarts</strong> – number of restarts for the optimization of the acquisition function</p></li>
<li><p><strong>num_samples</strong> – number of samples for the optimization of the acquisition function</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>un-normalized candidate with maximum posterior value a.k.a. x</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyrado.algorithms.meta.bayrn.BayRn.eval_init_policies">
<span class="sig-name descname"><span class="pre">eval_init_policies</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/algorithms/meta/bayrn.html#BayRn.eval_init_policies"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.algorithms.meta.bayrn.BayRn.eval_init_policies" title="Permalink to this definition"></a></dt>
<dd><p>Execute the trained initial policies on the target device and store the estimated return per candidate.
The number of initial policies to evaluate is the number of found policies.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyrado.algorithms.meta.bayrn.BayRn.eval_policy">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">eval_policy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">save_dir:</span> <span class="pre">~typing.Optional[~pyrado.PathLike],</span> <span class="pre">env:</span> <span class="pre">[&lt;class</span> <span class="pre">'pyrado.environments.real_base.RealEnv'&gt;,</span> <span class="pre">&lt;class</span> <span class="pre">'pyrado.environments.sim_base.SimEnv'&gt;,</span> <span class="pre">&lt;class</span> <span class="pre">'pyrado.environment_wrappers.domain_randomization.MetaDomainRandWrapper'&gt;],</span> <span class="pre">policy:</span> <span class="pre">~pyrado.policies.base.Policy,</span> <span class="pre">mc_estimator:</span> <span class="pre">bool,</span> <span class="pre">prefix:</span> <span class="pre">str,</span> <span class="pre">num_rollouts:</span> <span class="pre">int,</span> <span class="pre">num_workers:</span> <span class="pre">int</span> <span class="pre">=</span> <span class="pre">4</span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tensor</span></span></span><a class="reference internal" href="_modules/pyrado/algorithms/meta/bayrn.html#BayRn.eval_policy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.algorithms.meta.bayrn.BayRn.eval_policy" title="Permalink to this definition"></a></dt>
<dd><p>Evaluate a policy either in the source or in the target domain.
This method is static to facilitate evaluation of specific policies in hindsight.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>save_dir</strong> – directory to save the snapshots i.e. the results in, if <cite>None</cite> nothing is saved</p></li>
<li><p><strong>env</strong> – target environment for evaluation, in the sim-2-sim case this is another simulation instance</p></li>
<li><p><strong>policy</strong> – policy to evaluate</p></li>
<li><p><strong>mc_estimator</strong> – estimate the return with a sample average (<cite>True</cite>) or a lower confidence
bound (<cite>False</cite>) obtained from bootrapping</p></li>
<li><p><strong>prefix</strong> – to control the saving for the evaluation of an initial policy, <cite>None</cite> to deactivate</p></li>
<li><p><strong>num_rollouts</strong> – number of rollouts to collect on the target system</p></li>
<li><p><strong>prefix</strong> – to control the saving for the evaluation of an initial policy, <cite>None</cite> to deactivate</p></li>
<li><p><strong>num_workers</strong> – number of environments for the parallel sampler (only used for a <cite>SimEnv</cite>)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>estimated return in the target domain</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pyrado.algorithms.meta.bayrn.BayRn.iteration_key">
<span class="sig-name descname"><span class="pre">iteration_key</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'bayrn_iteration'</span></em><a class="headerlink" href="#pyrado.algorithms.meta.bayrn.BayRn.iteration_key" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyrado.algorithms.meta.bayrn.BayRn.load_snapshot">
<span class="sig-name descname"><span class="pre">load_snapshot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">parsed_args</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="environments.html#pyrado.environments.base.Env" title="pyrado.environments.base.Env"><span class="pre">Env</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="policies.html#pyrado.policies.base.Policy" title="pyrado.policies.base.Policy"><span class="pre">Policy</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/pyrado/algorithms/meta/bayrn.html#BayRn.load_snapshot"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.algorithms.meta.bayrn.BayRn.load_snapshot" title="Permalink to this definition"></a></dt>
<dd><p>Load the state of an experiment, which is specific to the algorithm.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>parsed_args</strong> – arguments parsed by the <cite>argparser</cite></p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>environment, policy, and (optional) algorithm-specific output, e.g. value function</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pyrado.algorithms.meta.bayrn.BayRn.name">
<span class="sig-name descname"><span class="pre">name</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'bayrn'</span></em><a class="headerlink" href="#pyrado.algorithms.meta.bayrn.BayRn.name" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="pyrado.algorithms.meta.bayrn.BayRn.policy">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">policy</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="policies.html#pyrado.policies.base.Policy" title="pyrado.policies.base.Policy"><span class="pre">Policy</span></a></em><a class="headerlink" href="#pyrado.algorithms.meta.bayrn.BayRn.policy" title="Permalink to this definition"></a></dt>
<dd><p>Get the algorithm’s policy.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="pyrado.algorithms.meta.bayrn.BayRn.sample_count">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">sample_count</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><a class="headerlink" href="#pyrado.algorithms.meta.bayrn.BayRn.sample_count" title="Permalink to this definition"></a></dt>
<dd><p>Get the total number of samples, i.e. steps of a rollout, used for training so far.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyrado.algorithms.meta.bayrn.BayRn.save_snapshot">
<span class="sig-name descname"><span class="pre">save_snapshot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">meta_info</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/algorithms/meta/bayrn.html#BayRn.save_snapshot"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.algorithms.meta.bayrn.BayRn.save_snapshot" title="Permalink to this definition"></a></dt>
<dd><p>Save the algorithm information (e.g., environment, policy, ect.).
Subclasses should call the base method to save the policy.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>meta_info</strong> – is not <cite>None</cite> if this algorithm is run as a subroutine of a meta-algorithm,
contains a dict of information about the current iteration of the meta-algorithm</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyrado.algorithms.meta.bayrn.BayRn.step">
<span class="sig-name descname"><span class="pre">step</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">snapshot_mode</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'latest'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">meta_info</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/algorithms/meta/bayrn.html#BayRn.step"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.algorithms.meta.bayrn.BayRn.step" title="Permalink to this definition"></a></dt>
<dd><p>Perform a single iteration of the algorithm. This includes collecting the data, updating the parameters, and
adding the metrics of interest to the logger. Does not update the <cite>curr_iter</cite> attribute.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>snapshot_mode</strong> – determines when the snapshots are stored (e.g. on every iteration or on new highscore)</p></li>
<li><p><strong>meta_info</strong> – is not <cite>None</cite> if this algorithm is run as a subroutine of a meta-algorithm,
contains a dict of information about the current iteration of the meta-algorithm</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="pyrado.algorithms.meta.bayrn.BayRn.subroutine">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">subroutine</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="algorithms.html#pyrado.algorithms.base.Algorithm" title="pyrado.algorithms.base.Algorithm"><span class="pre">Algorithm</span></a></em><a class="headerlink" href="#pyrado.algorithms.meta.bayrn.BayRn.subroutine" title="Permalink to this definition"></a></dt>
<dd><p>Get the policy optimization subroutine.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyrado.algorithms.meta.bayrn.BayRn.train_argmax_policy">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">train_argmax_policy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">load_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">PathLike</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">env_sim</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="environment_wrappers.html#pyrado.environment_wrappers.domain_randomization.MetaDomainRandWrapper" title="pyrado.environment_wrappers.domain_randomization.MetaDomainRandWrapper"><span class="pre">MetaDomainRandWrapper</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">subrtn</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="algorithms.html#pyrado.algorithms.base.Algorithm" title="pyrado.algorithms.base.Algorithm"><span class="pre">Algorithm</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_restarts</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_samples</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">policy_param_init</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Tensor</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">valuefcn_param_init</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Tensor</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">subrtn_snapshot_mode</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'best'</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="policies.html#pyrado.policies.base.Policy" title="pyrado.policies.base.Policy"><span class="pre">Policy</span></a></span></span><a class="reference internal" href="_modules/pyrado/algorithms/meta/bayrn.html#BayRn.train_argmax_policy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.algorithms.meta.bayrn.BayRn.train_argmax_policy" title="Permalink to this definition"></a></dt>
<dd><p>Train a policy based on the maximizer of the posterior mean.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>load_dir</strong> – directory to load from</p></li>
<li><p><strong>env_sim</strong> – simulation environment</p></li>
<li><p><strong>subrtn</strong> – algorithm which performs the policy / value-function optimization</p></li>
<li><p><strong>num_restarts</strong> – number of restarts for the optimization of the acquisition function</p></li>
<li><p><strong>num_samples</strong> – number of samples for the optimization of the acquisition function</p></li>
<li><p><strong>policy_param_init</strong> – initial policy parameter values for the subroutine, set <cite>None</cite> to be random</p></li>
<li><p><strong>valuefcn_param_init</strong> – initial value function parameter values for the subroutine, set <cite>None</cite> to be random</p></li>
<li><p><strong>subrtn_snapshot_mode</strong> – snapshot mode for saving during training of the subroutine</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the final BayRn policy</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyrado.algorithms.meta.bayrn.BayRn.train_init_policies">
<span class="sig-name descname"><span class="pre">train_init_policies</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/algorithms/meta/bayrn.html#BayRn.train_init_policies"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.algorithms.meta.bayrn.BayRn.train_init_policies" title="Permalink to this definition"></a></dt>
<dd><p>Initialize the algorithm with a number of random distribution parameter sets a.k.a. candidates specified by
the user. Train a policy for every candidate. Finally, store the policies and candidates.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyrado.algorithms.meta.bayrn.BayRn.train_policy_sim">
<span class="sig-name descname"><span class="pre">train_policy_sim</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cand</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prefix</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cnt_rep</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">float</span></span></span><a class="reference internal" href="_modules/pyrado/algorithms/meta/bayrn.html#BayRn.train_policy_sim"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.algorithms.meta.bayrn.BayRn.train_policy_sim" title="Permalink to this definition"></a></dt>
<dd><p>Train a policy in simulation for given hyper-parameters from the domain randomizer.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>cand</strong> – hyper-parameters for the domain parameter distribution (need be compatible with the randomizer)</p></li>
<li><p><strong>prefix</strong> – set a prefix to the saved file name, use “” for no prefix</p></li>
<li><p><strong>cnt_rep</strong> – current repetition count, coming from the wrapper function</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>estimated return of the trained policy in the target domain</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-pyrado.algorithms.meta.epopt">
<span id="epopt"></span><h2>epopt<a class="headerlink" href="#module-pyrado.algorithms.meta.epopt" title="Permalink to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="pyrado.algorithms.meta.epopt.EPOpt">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">EPOpt</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">env</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="environment_wrappers.html#pyrado.environment_wrappers.base.EnvWrapper" title="pyrado.environment_wrappers.base.EnvWrapper"><span class="pre">EnvWrapper</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">subrtn</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="algorithms.html#pyrado.algorithms.base.Algorithm" title="pyrado.algorithms.base.Algorithm"><span class="pre">Algorithm</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">skip_iter</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">epsilon</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gamma</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/algorithms/meta/epopt.html#EPOpt"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.algorithms.meta.epopt.EPOpt" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="algorithms.html#pyrado.algorithms.base.Algorithm" title="pyrado.algorithms.base.Algorithm"><code class="xref py py-class docutils literal notranslate"><span class="pre">Algorithm</span></code></a></p>
<p>Ensemble Policy Optimization (EPOpt)</p>
<p>This algorithm wraps another algorithm on a shallow level. It replaces the subroutine’s sampler with a
<cite>CVaRSampler</cite>, but does not have its own logger.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p>[1] A. Rajeswaran, S. Ghotra, B. Ravindran, S. Levine, “EPOpt: Learning Robust Neural Network Policies using
Model Ensembles”, ICLR, 2017</p>
</div>
<p>Constructor</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>env</strong> – same environment as the subroutine runs in. Only used for checking and saving the randomizer.</p></li>
<li><p><strong>subrtn</strong> – algorithm which performs the policy / value-function optimization</p></li>
<li><p><strong>skip_iter</strong> – number of iterations for which all rollouts will be used (see prefix ‘full’)</p></li>
<li><p><strong>epsilon</strong> – quantile of (worst) rollouts that will be kept</p></li>
<li><p><strong>gamma</strong> – discount factor to compute the discounted return, default is 1 (no discount)</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyrado.algorithms.meta.epopt.EPOpt.load_snapshot">
<span class="sig-name descname"><span class="pre">load_snapshot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">parsed_args</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="environments.html#pyrado.environments.base.Env" title="pyrado.environments.base.Env"><span class="pre">Env</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="policies.html#pyrado.policies.base.Policy" title="pyrado.policies.base.Policy"><span class="pre">Policy</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/pyrado/algorithms/meta/epopt.html#EPOpt.load_snapshot"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.algorithms.meta.epopt.EPOpt.load_snapshot" title="Permalink to this definition"></a></dt>
<dd><p>Load the state of an experiment, which is specific to the algorithm.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>parsed_args</strong> – arguments parsed by the <cite>argparser</cite></p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>environment, policy, and (optional) algorithm-specific output, e.g. value function</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pyrado.algorithms.meta.epopt.EPOpt.name">
<span class="sig-name descname"><span class="pre">name</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'epopt'</span></em><a class="headerlink" href="#pyrado.algorithms.meta.epopt.EPOpt.name" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyrado.algorithms.meta.epopt.EPOpt.reset">
<span class="sig-name descname"><span class="pre">reset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/algorithms/meta/epopt.html#EPOpt.reset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.algorithms.meta.epopt.EPOpt.reset" title="Permalink to this definition"></a></dt>
<dd><p>Reset the algorithm to it’s initial state. This should NOT reset learned policy parameters.
By default, this resets the iteration count and the exploration strategy.
Be sure to call this function if you override it.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>seed</strong> – seed value for the random number generators, pass <cite>None</cite> for no seeding</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="pyrado.algorithms.meta.epopt.EPOpt.sample_count">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">sample_count</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><a class="headerlink" href="#pyrado.algorithms.meta.epopt.EPOpt.sample_count" title="Permalink to this definition"></a></dt>
<dd><p>Get the total number of samples, i.e. steps of a rollout, used for training so far.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyrado.algorithms.meta.epopt.EPOpt.save_snapshot">
<span class="sig-name descname"><span class="pre">save_snapshot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">meta_info</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/algorithms/meta/epopt.html#EPOpt.save_snapshot"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.algorithms.meta.epopt.EPOpt.save_snapshot" title="Permalink to this definition"></a></dt>
<dd><p>Save the algorithm information (e.g., environment, policy, ect.).
Subclasses should call the base method to save the policy.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>meta_info</strong> – is not <cite>None</cite> if this algorithm is run as a subroutine of a meta-algorithm,
contains a dict of information about the current iteration of the meta-algorithm</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyrado.algorithms.meta.epopt.EPOpt.step">
<span class="sig-name descname"><span class="pre">step</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">snapshot_mode</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">meta_info</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/algorithms/meta/epopt.html#EPOpt.step"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.algorithms.meta.epopt.EPOpt.step" title="Permalink to this definition"></a></dt>
<dd><p>Perform a single iteration of the algorithm. This includes collecting the data, updating the parameters, and
adding the metrics of interest to the logger. Does not update the <cite>curr_iter</cite> attribute.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>snapshot_mode</strong> – determines when the snapshots are stored (e.g. on every iteration or on new highscore)</p></li>
<li><p><strong>meta_info</strong> – is not <cite>None</cite> if this algorithm is run as a subroutine of a meta-algorithm,
contains a dict of information about the current iteration of the meta-algorithm</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="pyrado.algorithms.meta.epopt.EPOpt.subroutine">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">subroutine</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="algorithms.html#pyrado.algorithms.base.Algorithm" title="pyrado.algorithms.base.Algorithm"><span class="pre">Algorithm</span></a></em><a class="headerlink" href="#pyrado.algorithms.meta.epopt.EPOpt.subroutine" title="Permalink to this definition"></a></dt>
<dd><p>Get the policy optimization subroutine.</p>
</dd></dl>

</dd></dl>

</section>
<section id="module-pyrado.algorithms.meta.iudr">
<span id="iudr"></span><h2>iudr<a class="headerlink" href="#module-pyrado.algorithms.meta.iudr" title="Permalink to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="pyrado.algorithms.meta.iudr.IUDR">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">IUDR</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">env</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="environment_wrappers.html#pyrado.environment_wrappers.domain_randomization.DomainRandWrapper" title="pyrado.environment_wrappers.domain_randomization.DomainRandWrapper"><span class="pre">DomainRandWrapper</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">subroutine</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="algorithms.html#pyrado.algorithms.base.Algorithm" title="pyrado.algorithms.base.Algorithm"><span class="pre">Algorithm</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_iter</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">performance_threshold</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">param_adjustment_portion</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.9</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/algorithms/meta/iudr.html#IUDR"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.algorithms.meta.iudr.IUDR" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="algorithms.html#pyrado.algorithms.base.Algorithm" title="pyrado.algorithms.base.Algorithm"><code class="xref py py-class docutils literal notranslate"><span class="pre">Algorithm</span></code></a></p>
<p>Incremental Uniform Domain Randomization (IUDR).</p>
<p>This is an ablation of SPDR in the sense that the optimization is omitted and the contextual distribution is naively
updated in fixed steps, disregarding the performance information.</p>
<p>Constructor</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>env</strong> – environment wrapped in a <cite>DomainRandWrapper</cite></p></li>
<li><p><strong>subroutine</strong> – algorithm which performs the policy/value-function optimization; note that this algorithm
must be capable of learning a sufficient policy in its maximum number of iterations</p></li>
<li><p><strong>max_iter</strong> – iterations of the IUDR algorithm (not for the subroutine); changing the domain parameter
distribution is done by linear interpolation over this many iterations</p></li>
<li><p><strong>performance_threshold</strong> – lower bound for the performance that has to be reached until the domain parameter
randomization is changed</p></li>
<li><p><strong>param_adjustment_portion</strong> – what portion of the IUDR iterations should be spent on adjusting the domain
parameter distributions; defaults to <cite>90%</cite></p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="pyrado.algorithms.meta.iudr.IUDR.name">
<span class="sig-name descname"><span class="pre">name</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'iudr'</span></em><a class="headerlink" href="#pyrado.algorithms.meta.iudr.IUDR.name" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyrado.algorithms.meta.iudr.IUDR.reset">
<span class="sig-name descname"><span class="pre">reset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/algorithms/meta/iudr.html#IUDR.reset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.algorithms.meta.iudr.IUDR.reset" title="Permalink to this definition"></a></dt>
<dd><p>Reset the algorithm to it’s initial state. This should NOT reset learned policy parameters.
By default, this resets the iteration count and the exploration strategy.
Be sure to call this function if you override it.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>seed</strong> – seed value for the random number generators, pass <cite>None</cite> for no seeding</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="pyrado.algorithms.meta.iudr.IUDR.sample_count">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">sample_count</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><a class="headerlink" href="#pyrado.algorithms.meta.iudr.IUDR.sample_count" title="Permalink to this definition"></a></dt>
<dd><p>Get the total number of samples, i.e. steps of a rollout, used for training so far.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyrado.algorithms.meta.iudr.IUDR.save_snapshot">
<span class="sig-name descname"><span class="pre">save_snapshot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">meta_info</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/algorithms/meta/iudr.html#IUDR.save_snapshot"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.algorithms.meta.iudr.IUDR.save_snapshot" title="Permalink to this definition"></a></dt>
<dd><p>Save the algorithm information (e.g., environment, policy, ect.).
Subclasses should call the base method to save the policy.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>meta_info</strong> – is not <cite>None</cite> if this algorithm is run as a subroutine of a meta-algorithm,
contains a dict of information about the current iteration of the meta-algorithm</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyrado.algorithms.meta.iudr.IUDR.step">
<span class="sig-name descname"><span class="pre">step</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">snapshot_mode</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">meta_info</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/algorithms/meta/iudr.html#IUDR.step"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.algorithms.meta.iudr.IUDR.step" title="Permalink to this definition"></a></dt>
<dd><p>Perform a step of IUDR. This includes training the subroutine and updating the context distribution accordingly.
For a description of the parameters see <cite>pyrado.algorithms.base.Algorithm.step</cite>.</p>
</dd></dl>

</dd></dl>

</section>
<section id="npdr">
<h2>npdr<a class="headerlink" href="#npdr" title="Permalink to this heading"></a></h2>
</section>
<section id="module-pyrado.algorithms.meta.pddr">
<span id="pddr"></span><h2>pddr<a class="headerlink" href="#module-pyrado.algorithms.meta.pddr" title="Permalink to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="pyrado.algorithms.meta.pddr.PDDR">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">PDDR</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">save_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">env</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="environments.html#pyrado.environments.base.Env" title="pyrado.environments.base.Env"><span class="pre">Env</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">policy</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="policies.html#pyrado.policies.base.Policy" title="pyrado.policies.base.Policy"><span class="pre">Policy</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">lr</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.0005</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">std_init</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.15</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_steps</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1500</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_epochs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_iter</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">500</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_teachers</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">8</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">teacher_extra</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">teacher_policy</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="policies.html#pyrado.policies.base.Policy" title="pyrado.policies.base.Policy"><span class="pre">Policy</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">teacher_algo</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">callable</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">teacher_algo_hparam</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">randomizer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="domain_randomization.html#pyrado.domain_randomization.domain_randomizer.DomainRandomizer" title="pyrado.domain_randomization.domain_randomizer.DomainRandomizer"><span class="pre">DomainRandomizer</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logger</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="logger.html#pyrado.logger.step.StepLogger" title="pyrado.logger.step.StepLogger"><span class="pre">StepLogger</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_workers</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">4</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/algorithms/meta/pddr.html#PDDR"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.algorithms.meta.pddr.PDDR" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="algorithms.html#pyrado.algorithms.base.InterruptableAlgorithm" title="pyrado.algorithms.base.InterruptableAlgorithm"><code class="xref py py-class docutils literal notranslate"><span class="pre">InterruptableAlgorithm</span></code></a></p>
<p>Policy Distillation with Domain Randomization (PDDR)</p>
<p>Constructor</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>save_dir</strong> – directory to save the snapshots i.e. the results in</p></li>
<li><p><strong>env</strong> – the environment which the policy operates</p></li>
<li><p><strong>policy</strong> – policy to be updated</p></li>
<li><p><strong>lr</strong> – (initial) learning rate for the optimizer which can be by modified by the scheduler.
By default, the learning rate is constant.</p></li>
<li><p><strong>std_init</strong> – initial standard deviation on the actions for the exploration noise</p></li>
<li><p><strong>min_steps</strong> – minimum number of state transitions sampled per policy update batch</p></li>
<li><p><strong>num_epochs</strong> – number of epochs (how often we iterate over the same batch)</p></li>
<li><p><strong>max_iter</strong> – number of iterations (policy updates)</p></li>
<li><p><strong>num_teachers</strong> – number of teachers that are used for distillation</p></li>
<li><p><strong>teacher_extra</strong> – extra dict from PDDRTeachers algo. If provided, teachers are loaded from there</p></li>
<li><p><strong>teacher_policy</strong> – policy to be updated (is duplicated for each teacher)</p></li>
<li><p><strong>teacher_algo</strong> – algorithm class to be used for training the teachers</p></li>
<li><p><strong>teacher_algo_hparam</strong> – hyper-params to be used for teacher_algo</p></li>
<li><p><strong>randomizer</strong> – randomizer for sampling the teacher domain parameters; if <cite>None</cite>, the environment’s default
one is used</p></li>
<li><p><strong>logger</strong> – logger for every step of the algorithm, if <cite>None</cite> the default logger will be created</p></li>
<li><p><strong>num_workers</strong> – number of environments for parallel sampling</p></li>
</ul>
</dd>
</dl>
<dl class="py property">
<dt class="sig sig-object py" id="pyrado.algorithms.meta.pddr.PDDR.expl_strat">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">expl_strat</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="exploration.html#pyrado.exploration.stochastic_action.NormalActNoiseExplStrat" title="pyrado.exploration.stochastic_action.NormalActNoiseExplStrat"><span class="pre">NormalActNoiseExplStrat</span></a></em><a class="headerlink" href="#pyrado.algorithms.meta.pddr.PDDR.expl_strat" title="Permalink to this definition"></a></dt>
<dd><p>Get the algorithm’s exploration strategy.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyrado.algorithms.meta.pddr.PDDR.load_snapshot">
<span class="sig-name descname"><span class="pre">load_snapshot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">parsed_args</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="environments.html#pyrado.environments.base.Env" title="pyrado.environments.base.Env"><span class="pre">Env</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="policies.html#pyrado.policies.base.Policy" title="pyrado.policies.base.Policy"><span class="pre">Policy</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/pyrado/algorithms/meta/pddr.html#PDDR.load_snapshot"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.algorithms.meta.pddr.PDDR.load_snapshot" title="Permalink to this definition"></a></dt>
<dd><p>Load the state of an experiment, which is specific to the algorithm.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>parsed_args</strong> – arguments parsed by the <cite>argparser</cite></p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>environment, policy, and (optional) algorithm-specific output, e.g. value function</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyrado.algorithms.meta.pddr.PDDR.load_teacher_experiment">
<span class="sig-name descname"><span class="pre">load_teacher_experiment</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">exp</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="logger.html#pyrado.logger.experiment.Experiment" title="pyrado.logger.experiment.Experiment"><span class="pre">Experiment</span></a></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/algorithms/meta/pddr.html#PDDR.load_teacher_experiment"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.algorithms.meta.pddr.PDDR.load_teacher_experiment" title="Permalink to this definition"></a></dt>
<dd><p>Load teachers from PDDRTeachers experiment.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>exp</strong> – the teacher’s experiment object</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyrado.algorithms.meta.pddr.PDDR.load_teachers">
<span class="sig-name descname"><span class="pre">load_teachers</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/algorithms/meta/pddr.html#PDDR.load_teachers"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.algorithms.meta.pddr.PDDR.load_teachers" title="Permalink to this definition"></a></dt>
<dd><p>Recursively load all teachers that can be found in the current experiment’s directory.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pyrado.algorithms.meta.pddr.PDDR.name">
<span class="sig-name descname"><span class="pre">name</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'pddr'</span></em><a class="headerlink" href="#pyrado.algorithms.meta.pddr.PDDR.name" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyrado.algorithms.meta.pddr.PDDR.prune_teachers">
<span class="sig-name descname"><span class="pre">prune_teachers</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/algorithms/meta/pddr.html#PDDR.prune_teachers"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.algorithms.meta.pddr.PDDR.prune_teachers" title="Permalink to this definition"></a></dt>
<dd><p>Prune teachers to only use the first num_teachers of them.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyrado.algorithms.meta.pddr.PDDR.sample">
<span class="sig-name descname"><span class="pre">sample</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="sampling.html#pyrado.sampling.step_sequence.StepSequence" title="pyrado.sampling.step_sequence.StepSequence"><span class="pre">StepSequence</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">array</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">array</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/pyrado/algorithms/meta/pddr.html#PDDR.sample"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.algorithms.meta.pddr.PDDR.sample" title="Permalink to this definition"></a></dt>
<dd><p>Samples observations from several samplers.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>list of rollouts per sampler, list of all returns, list of all rollout lengths</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyrado.algorithms.meta.pddr.PDDR.save_snapshot">
<span class="sig-name descname"><span class="pre">save_snapshot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">meta_info</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/algorithms/meta/pddr.html#PDDR.save_snapshot"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.algorithms.meta.pddr.PDDR.save_snapshot" title="Permalink to this definition"></a></dt>
<dd><p>Save the algorithm information (e.g., environment, policy, ect.).
Subclasses should call the base method to save the policy.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>meta_info</strong> – is not <cite>None</cite> if this algorithm is run as a subroutine of a meta-algorithm,
contains a dict of information about the current iteration of the meta-algorithm</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyrado.algorithms.meta.pddr.PDDR.set_random_envs">
<span class="sig-name descname"><span class="pre">set_random_envs</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/algorithms/meta/pddr.html#PDDR.set_random_envs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.algorithms.meta.pddr.PDDR.set_random_envs" title="Permalink to this definition"></a></dt>
<dd><p>Creates random environments of the given type.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyrado.algorithms.meta.pddr.PDDR.step">
<span class="sig-name descname"><span class="pre">step</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">snapshot_mode</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">meta_info</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/algorithms/meta/pddr.html#PDDR.step"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.algorithms.meta.pddr.PDDR.step" title="Permalink to this definition"></a></dt>
<dd><p>Performs a single iteration of the algorithm. This includes collecting the data, updating the parameters, and
adding the metrics of interest to the logger. Does not update the <cite>curr_iter</cite> attribute.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>snapshot_mode</strong> – determines when the snapshots are stored (e.g. on every iteration or on new highscore)</p></li>
<li><p><strong>meta_info</strong> – is not <cite>None</cite> if this algorithm is run as a subroutine of a meta-algorithm,
contains a dict of information about the current iteration of the meta-algorithm</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyrado.algorithms.meta.pddr.PDDR.train_teachers">
<span class="sig-name descname"><span class="pre">train_teachers</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">snapshot_mode</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'latest'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/algorithms/meta/pddr.html#PDDR.train_teachers"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.algorithms.meta.pddr.PDDR.train_teachers" title="Permalink to this definition"></a></dt>
<dd><p>Trains all teachers.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>snapshot_mode</strong> – determines when the snapshots are stored (e.g. on every iteration or on new high-score)</p></li>
<li><p><strong>seed</strong> – seed value for the random number generators, pass <cite>None</cite> for no seeding</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyrado.algorithms.meta.pddr.PDDR.unpack_teachers">
<span class="sig-name descname"><span class="pre">unpack_teachers</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">extra</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/algorithms/meta/pddr.html#PDDR.unpack_teachers"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.algorithms.meta.pddr.PDDR.unpack_teachers" title="Permalink to this definition"></a></dt>
<dd><p>Unpack teachers from PDDRTeachers experiment.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>extra</strong> – dict with teacher data</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyrado.algorithms.meta.pddr.PDDR.update">
<span class="sig-name descname"><span class="pre">update</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/algorithms/meta/pddr.html#PDDR.update"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.algorithms.meta.pddr.PDDR.update" title="Permalink to this definition"></a></dt>
<dd><p>Update the policy’s (and value functions’) parameters based on the collected rollout data.</p>
</dd></dl>

</dd></dl>

</section>
<section id="sbi-base">
<h2>sbi_base<a class="headerlink" href="#sbi-base" title="Permalink to this heading"></a></h2>
</section>
<section id="module-pyrado.algorithms.meta.simopt">
<span id="simopt"></span><h2>simopt<a class="headerlink" href="#module-pyrado.algorithms.meta.simopt" title="Permalink to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="pyrado.algorithms.meta.simopt.SimOpt">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">SimOpt</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">save_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">PathLike</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">env_sim</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="environment_wrappers.html#pyrado.environment_wrappers.domain_randomization.MetaDomainRandWrapper" title="pyrado.environment_wrappers.domain_randomization.MetaDomainRandWrapper"><span class="pre">MetaDomainRandWrapper</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">env_real</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="environments.html#pyrado.environments.real_base.RealEnv" title="pyrado.environments.real_base.RealEnv"><span class="pre">RealEnv</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="environment_wrappers.html#pyrado.environment_wrappers.base.EnvWrapper" title="pyrado.environment_wrappers.base.EnvWrapper"><span class="pre">EnvWrapper</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">subrtn_policy</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="algorithms.html#pyrado.algorithms.base.Algorithm" title="pyrado.algorithms.base.Algorithm"><span class="pre">Algorithm</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">subrtn_distr</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="algorithms.episodic.html#pyrado.algorithms.episodic.sysid_via_episodic_rl.SysIdViaEpisodicRL" title="pyrado.algorithms.episodic.sysid_via_episodic_rl.SysIdViaEpisodicRL"><span class="pre">SysIdViaEpisodicRL</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_iter</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_eval_rollouts</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">thold_succ</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">inf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">thold_succ_subrtn</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">-inf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">warmstart</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">policy_param_init</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Tensor</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">valuefcn_param_init</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Tensor</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">subrtn_snapshot_mode</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'latest'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logger</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="logger.html#pyrado.logger.step.StepLogger" title="pyrado.logger.step.StepLogger"><span class="pre">StepLogger</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/algorithms/meta/simopt.html#SimOpt"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.algorithms.meta.simopt.SimOpt" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="algorithms.html#pyrado.algorithms.base.InterruptableAlgorithm" title="pyrado.algorithms.base.InterruptableAlgorithm"><code class="xref py py-class docutils literal notranslate"><span class="pre">InterruptableAlgorithm</span></code></a></p>
<p>Simulation Optimization (SimOpt)</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>A candidate is a set of parameter values for the domain parameter distribution and its value is the
discrepancy between the simulated and real observations (based on a weighted metric).</p>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p>[1] Y. SimOpt, A. Handa, V. Makoviychuk, M. Macklin, J. Issac, N.D. Ratliff, D. Fox, “Closing the Sim-to-Real
Loop: Adapting Simulation Randomization with Real World Experience”, ICRA, 2020</p>
</div>
<p>Constructor</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If you want to continue an experiment, use the <cite>load_dir</cite> argument for the <cite>train</cite> call. If you want to
initialize every of the policies with a pre-trained policy parameters use <cite>policy_param_init</cite>.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>save_dir</strong> – directory to save the snapshots i.e. the results in</p></li>
<li><p><strong>env_sim</strong> – randomized simulation environment a.k.a. source domain</p></li>
<li><p><strong>env_real</strong> – real-world environment a.k.a. target domain</p></li>
<li><p><strong>subrtn_policy</strong> – algorithm which performs the optimization of the behavioral policy (and value-function)</p></li>
<li><p><strong>subrtn_distr</strong> – algorithm which performs the optimization of the domain parameter distribution policy</p></li>
<li><p><strong>max_iter</strong> – maximum number of iterations</p></li>
<li><p><strong>num_eval_rollouts</strong> – number of rollouts in the target domain to estimate the return</p></li>
<li><p><strong>thold_succ</strong> – success threshold on the real system’s return for BayRn, stop the algorithm if exceeded</p></li>
<li><p><strong>thold_succ_subrtn</strong> – success threshold on the simulated system’s return for the subrtn, repeat the
subrtn until the threshold is exceeded or the for a given number of iterations</p></li>
<li><p><strong>warmstart</strong> – initialize the policy (and value function) parameters with the one of the previous iteration.
This behavior can also be overruled by passing <cite>init_policy_params</cite> (and
<cite>valuefcn_param_init</cite>) explicitly.</p></li>
<li><p><strong>policy_param_init</strong> – initial policy parameter values for the subrtn, set <cite>None</cite> to be random</p></li>
<li><p><strong>valuefcn_param_init</strong> – initial value function parameter values for the subrtn, set <cite>None</cite> to be random</p></li>
<li><p><strong>subrtn_snapshot_mode</strong> – snapshot mode for saving during training of the subrtn</p></li>
<li><p><strong>logger</strong> – logger for every step of the algorithm, if <cite>None</cite> the default logger will be created</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyrado.algorithms.meta.simopt.SimOpt.eval_behav_policy">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">eval_behav_policy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">save_dir:</span> <span class="pre">[&lt;class</span> <span class="pre">'str'&gt;,</span> <span class="pre">None],</span> <span class="pre">env:</span> <span class="pre">[&lt;class</span> <span class="pre">'pyrado.environments.real_base.RealEnv'&gt;,</span> <span class="pre">&lt;class</span> <span class="pre">'pyrado.environments.sim_base.SimEnv'&gt;,</span> <span class="pre">&lt;class</span> <span class="pre">'pyrado.environment_wrappers.domain_randomization.MetaDomainRandWrapper'&gt;],</span> <span class="pre">policy:</span> <span class="pre">~pyrado.policies.base.Policy,</span> <span class="pre">prefix:</span> <span class="pre">str,</span> <span class="pre">num_rollouts:</span> <span class="pre">int,</span> <span class="pre">init_states:</span> <span class="pre">[&lt;class</span> <span class="pre">'numpy.ndarray'&gt;,</span> <span class="pre">None]</span> <span class="pre">=</span> <span class="pre">None,</span> <span class="pre">seed:</span> <span class="pre">int</span> <span class="pre">=</span> <span class="pre">1001</span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Sequence</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="sampling.html#pyrado.sampling.step_sequence.StepSequence" title="pyrado.sampling.step_sequence.StepSequence"><span class="pre">StepSequence</span></a><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/pyrado/algorithms/meta/simopt.html#SimOpt.eval_behav_policy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.algorithms.meta.simopt.SimOpt.eval_behav_policy" title="Permalink to this definition"></a></dt>
<dd><p>Evaluate a policy on the target system (real-world platform).
This method is static to facilitate evaluation of specific policies in hindsight.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>save_dir</strong> – directory to save the snapshots i.e. the results in, if <cite>None</cite> nothing is saved</p></li>
<li><p><strong>env</strong> – environment for evaluation, in the sim-2-sim case this is another simulation instance</p></li>
<li><p><strong>policy</strong> – policy to evaluate</p></li>
<li><p><strong>prefix</strong> – to control the saving for the evaluation of an initial policy, <cite>None</cite> to deactivate</p></li>
<li><p><strong>num_rollouts</strong> – number of rollouts to collect on the target domain</p></li>
<li><p><strong>init_states</strong> – pass the initial states of the real system to sync the simulation (mandatory in this case)</p></li>
<li><p><strong>seed</strong> – seed value for the random number generators, only used when evaluating in simulation</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>rollouts</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyrado.algorithms.meta.simopt.SimOpt.eval_ddp_policy">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">eval_ddp_policy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rollouts_real</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Sequence</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="sampling.html#pyrado.sampling.step_sequence.StepSequence" title="pyrado.sampling.step_sequence.StepSequence"><span class="pre">StepSequence</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">env_sim</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="environment_wrappers.html#pyrado.environment_wrappers.domain_randomization.MetaDomainRandWrapper" title="pyrado.environment_wrappers.domain_randomization.MetaDomainRandWrapper"><span class="pre">MetaDomainRandWrapper</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_rollouts</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">subrtn_distr</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="algorithms.episodic.html#pyrado.algorithms.episodic.sysid_via_episodic_rl.SysIdViaEpisodicRL" title="pyrado.algorithms.episodic.sysid_via_episodic_rl.SysIdViaEpisodicRL"><span class="pre">SysIdViaEpisodicRL</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">subrtn_policy</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="algorithms.html#pyrado.algorithms.base.Algorithm" title="pyrado.algorithms.base.Algorithm"><span class="pre">Algorithm</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">float</span></span></span><a class="reference internal" href="_modules/pyrado/algorithms/meta/simopt.html#SimOpt.eval_ddp_policy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.algorithms.meta.simopt.SimOpt.eval_ddp_policy" title="Permalink to this definition"></a></dt>
<dd><p>Evaluate the policy that fits the domain parameter distribution to the observed rollouts.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>rollouts_real</strong> – recorded real-world rollouts</p></li>
<li><p><strong>env_sim</strong> – randomized simulation environment a.k.a. source domain</p></li>
<li><p><strong>num_rollouts</strong> – number of rollouts to collect on the target domain</p></li>
<li><p><strong>subrtn_distr</strong> – algorithm which performs the optimization of the domain parameter distribution policy</p></li>
<li><p><strong>subrtn_policy</strong> – algorithm which performs the optimization of the behavioral policy (and value-function)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>average system identification loss</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pyrado.algorithms.meta.simopt.SimOpt.iteration_key">
<span class="sig-name descname"><span class="pre">iteration_key</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'simopt_iteration'</span></em><a class="headerlink" href="#pyrado.algorithms.meta.simopt.SimOpt.iteration_key" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyrado.algorithms.meta.simopt.SimOpt.load_snapshot">
<span class="sig-name descname"><span class="pre">load_snapshot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">parsed_args</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="environments.html#pyrado.environments.base.Env" title="pyrado.environments.base.Env"><span class="pre">Env</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="policies.html#pyrado.policies.base.Policy" title="pyrado.policies.base.Policy"><span class="pre">Policy</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/pyrado/algorithms/meta/simopt.html#SimOpt.load_snapshot"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.algorithms.meta.simopt.SimOpt.load_snapshot" title="Permalink to this definition"></a></dt>
<dd><p>Load the state of an experiment, which is specific to the algorithm.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>parsed_args</strong> – arguments parsed by the <cite>argparser</cite></p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>environment, policy, and (optional) algorithm-specific output, e.g. value function</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pyrado.algorithms.meta.simopt.SimOpt.name">
<span class="sig-name descname"><span class="pre">name</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'simopt'</span></em><a class="headerlink" href="#pyrado.algorithms.meta.simopt.SimOpt.name" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="pyrado.algorithms.meta.simopt.SimOpt.sample_count">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">sample_count</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><a class="headerlink" href="#pyrado.algorithms.meta.simopt.SimOpt.sample_count" title="Permalink to this definition"></a></dt>
<dd><p>Get the total number of samples, i.e. steps of a rollout, used for training so far.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyrado.algorithms.meta.simopt.SimOpt.save_snapshot">
<span class="sig-name descname"><span class="pre">save_snapshot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">meta_info</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/algorithms/meta/simopt.html#SimOpt.save_snapshot"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.algorithms.meta.simopt.SimOpt.save_snapshot" title="Permalink to this definition"></a></dt>
<dd><p>Save the algorithm information (e.g., environment, policy, ect.).
Subclasses should call the base method to save the policy.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>meta_info</strong> – is not <cite>None</cite> if this algorithm is run as a subroutine of a meta-algorithm,
contains a dict of information about the current iteration of the meta-algorithm</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyrado.algorithms.meta.simopt.SimOpt.step">
<span class="sig-name descname"><span class="pre">step</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">snapshot_mode</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'latest'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">meta_info</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/algorithms/meta/simopt.html#SimOpt.step"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.algorithms.meta.simopt.SimOpt.step" title="Permalink to this definition"></a></dt>
<dd><p>Perform a single iteration of the algorithm. This includes collecting the data, updating the parameters, and
adding the metrics of interest to the logger. Does not update the <cite>curr_iter</cite> attribute.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>snapshot_mode</strong> – determines when the snapshots are stored (e.g. on every iteration or on new highscore)</p></li>
<li><p><strong>meta_info</strong> – is not <cite>None</cite> if this algorithm is run as a subroutine of a meta-algorithm,
contains a dict of information about the current iteration of the meta-algorithm</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="pyrado.algorithms.meta.simopt.SimOpt.subroutine_distr">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">subroutine_distr</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="algorithms.episodic.html#pyrado.algorithms.episodic.sysid_via_episodic_rl.SysIdViaEpisodicRL" title="pyrado.algorithms.episodic.sysid_via_episodic_rl.SysIdViaEpisodicRL"><span class="pre">SysIdViaEpisodicRL</span></a></em><a class="headerlink" href="#pyrado.algorithms.meta.simopt.SimOpt.subroutine_distr" title="Permalink to this definition"></a></dt>
<dd><p>Get the system identification subroutine.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="pyrado.algorithms.meta.simopt.SimOpt.subroutine_policy">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">subroutine_policy</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="algorithms.html#pyrado.algorithms.base.Algorithm" title="pyrado.algorithms.base.Algorithm"><span class="pre">Algorithm</span></a></em><a class="headerlink" href="#pyrado.algorithms.meta.simopt.SimOpt.subroutine_policy" title="Permalink to this definition"></a></dt>
<dd><p>Get the policy optimization subroutine.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyrado.algorithms.meta.simopt.SimOpt.train_ddp_policy">
<span class="sig-name descname"><span class="pre">train_ddp_policy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rollouts_real</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Sequence</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="sampling.html#pyrado.sampling.step_sequence.StepSequence" title="pyrado.sampling.step_sequence.StepSequence"><span class="pre">StepSequence</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prefix</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">float</span></span></span><a class="reference internal" href="_modules/pyrado/algorithms/meta/simopt.html#SimOpt.train_ddp_policy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.algorithms.meta.simopt.SimOpt.train_ddp_policy" title="Permalink to this definition"></a></dt>
<dd><p>Train and evaluate the policy that parametrizes domain randomizer, such that the loss given by the instance of
<cite>SysIdViaEpisodicRL</cite> is minimized.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>rollouts_real</strong> – recorded real-world rollouts</p></li>
<li><p><strong>prefix</strong> – set a prefix to the saved file name, use “” for no prefix</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>average system identification loss</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyrado.algorithms.meta.simopt.SimOpt.train_policy_sim">
<span class="sig-name descname"><span class="pre">train_policy_sim</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cand</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prefix</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cnt_rep</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">float</span></span></span><a class="reference internal" href="_modules/pyrado/algorithms/meta/simopt.html#SimOpt.train_policy_sim"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.algorithms.meta.simopt.SimOpt.train_policy_sim" title="Permalink to this definition"></a></dt>
<dd><p>Train a policy in simulation for given hyper-parameters from the domain randomizer.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>cand</strong> – hyper-parameters for the domain parameter distribution (need be compatible with the randomizer)</p></li>
<li><p><strong>prefix</strong> – set a prefix to the saved file name, use “” for no prefix</p></li>
<li><p><strong>cnt_rep</strong> – current repetition count, coming from the wrapper function</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>estimated return of the trained policy in the target domain</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-pyrado.algorithms.meta.spdr">
<span id="spdr"></span><h2>spdr<a class="headerlink" href="#module-pyrado.algorithms.meta.spdr" title="Permalink to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="pyrado.algorithms.meta.spdr.MultivariateNormalWrapper">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">MultivariateNormalWrapper</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mean</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cov_chol</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/algorithms/meta/spdr.html#MultivariateNormalWrapper"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.algorithms.meta.spdr.MultivariateNormalWrapper" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>A wrapper for PyTorch’s multivariate normal distribution with diagonal covariance.
It is used to get a SciPy optimizer-ready version of the parameters of a distribution,
i.e. a vector that can be used as the target variable.</p>
<p>Constructor.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mean</strong> – mean of the distribution; shape <cite>(k,)</cite></p></li>
<li><p><strong>cov_chol</strong> – Cholesky decomposition of the covariance matrix; must be lower triangular; shape <cite>(k, k)</cite>
if it is the actual matrix or shape <cite>(k * (k + 1) / 2,)</cite> if it is raveled</p></li>
</ul>
</dd>
</dl>
<dl class="py property">
<dt class="sig sig-object py" id="pyrado.algorithms.meta.spdr.MultivariateNormalWrapper.cov">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">cov</span></span><a class="headerlink" href="#pyrado.algorithms.meta.spdr.MultivariateNormalWrapper.cov" title="Permalink to this definition"></a></dt>
<dd><p>Get the covariance matrix, shape <cite>(k, k)</cite>.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="pyrado.algorithms.meta.spdr.MultivariateNormalWrapper.cov_chol">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">cov_chol</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Tensor</span></em><a class="headerlink" href="#pyrado.algorithms.meta.spdr.MultivariateNormalWrapper.cov_chol" title="Permalink to this definition"></a></dt>
<dd><p>Get the Cholesky decomposition of the covariance; shape <cite>(k, k)</cite>.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="pyrado.algorithms.meta.spdr.MultivariateNormalWrapper.cov_chol_tril">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">cov_chol_tril</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Tensor</span></em><a class="headerlink" href="#pyrado.algorithms.meta.spdr.MultivariateNormalWrapper.cov_chol_tril" title="Permalink to this definition"></a></dt>
<dd><p>Get the lower triangular of the Cholesky decomposition of the covariance; shape <cite>(k * (k + 1) / 2)</cite>.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="pyrado.algorithms.meta.spdr.MultivariateNormalWrapper.dim">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">dim</span></span><a class="headerlink" href="#pyrado.algorithms.meta.spdr.MultivariateNormalWrapper.dim" title="Permalink to this definition"></a></dt>
<dd><p>Get the size (dimensionality) of the random variable.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyrado.algorithms.meta.spdr.MultivariateNormalWrapper.from_stacked">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">from_stacked</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dim</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stacked</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#pyrado.algorithms.meta.spdr.MultivariateNormalWrapper" title="pyrado.algorithms.meta.spdr.MultivariateNormalWrapper"><span class="pre">MultivariateNormalWrapper</span></a></span></span><a class="reference internal" href="_modules/pyrado/algorithms/meta/spdr.html#MultivariateNormalWrapper.from_stacked"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.algorithms.meta.spdr.MultivariateNormalWrapper.from_stacked" title="Permalink to this definition"></a></dt>
<dd><p>Creates an instance of this class from the given stacked numpy array as generated e.g. by
<cite>MultivariateNormalWrapper.get_stacked(self)</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dim</strong> – dimensionality <cite>k</cite> of the random variable</p></li>
<li><p><strong>stacked</strong> – array containing the mean and standard deviations of shape <cite>(k + k * (k + 1) / 2,)</cite>, where the
first <cite>k</cite> entries are the mean and the last <cite>k * (k + 1) / 2</cite> entries are lower triangular
entries of the Cholesky decomposition of the covariance matrix</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>a <cite>MultivariateNormalWrapper</cite> with the given mean/cov.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyrado.algorithms.meta.spdr.MultivariateNormalWrapper.get_stacked">
<span class="sig-name descname"><span class="pre">get_stacked</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span></span></span><a class="reference internal" href="_modules/pyrado/algorithms/meta/spdr.html#MultivariateNormalWrapper.get_stacked"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.algorithms.meta.spdr.MultivariateNormalWrapper.get_stacked" title="Permalink to this definition"></a></dt>
<dd><p>Get the numpy representations of the mean and transformed covariance stacked on top of each other.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>stacked mean and transformed covariance; shape <cite>(k + k * (k + 1) / 2,)</cite></p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="pyrado.algorithms.meta.spdr.MultivariateNormalWrapper.mean">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">mean</span></span><a class="headerlink" href="#pyrado.algorithms.meta.spdr.MultivariateNormalWrapper.mean" title="Permalink to this definition"></a></dt>
<dd><p>Get the mean.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyrado.algorithms.meta.spdr.MultivariateNormalWrapper.parameters">
<span class="sig-name descname"><span class="pre">parameters</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Iterator</span><span class="p"><span class="pre">[</span></span><span class="pre">Tensor</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/pyrado/algorithms/meta/spdr.html#MultivariateNormalWrapper.parameters"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.algorithms.meta.spdr.MultivariateNormalWrapper.parameters" title="Permalink to this definition"></a></dt>
<dd><p>Get the parameters (mean and lower triangular covariance Cholesky) of this distribution.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="pyrado.algorithms.meta.spdr.SPDR">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">SPDR</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">env</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="environment_wrappers.html#pyrado.environment_wrappers.domain_randomization.DomainRandWrapper" title="pyrado.environment_wrappers.domain_randomization.DomainRandWrapper"><span class="pre">DomainRandWrapper</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">subroutine</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="algorithms.html#pyrado.algorithms.base.Algorithm" title="pyrado.algorithms.base.Algorithm"><span class="pre">Algorithm</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">kl_constraints_ub</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_iter</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">performance_lower_bound</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">var_lower_bound</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.04</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kl_threshold</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">optimize_mean</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">optimize_cov</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_subrtn_retries</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/algorithms/meta/spdr.html#SPDR"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.algorithms.meta.spdr.SPDR" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="algorithms.html#pyrado.algorithms.base.Algorithm" title="pyrado.algorithms.base.Algorithm"><code class="xref py py-class docutils literal notranslate"><span class="pre">Algorithm</span></code></a></p>
<p>Self-Paced Domain Randomization (SPDR)</p>
<p>This algorithm wraps another algorithm. The main purpose is to apply self-paced RL [1].</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p>[1] P. Klink, H. Abdulsamad, B. Belousov, C. D’Eramo, J. Peters, and J. Pajarinen,
“A Probabilistic Interpretation of Self-Paced Learning with Applications to Reinforcement Learning”, arXiv, 2021</p>
</div>
<p>Constructor</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>env</strong> – environment wrapped in a DomainRandWrapper</p></li>
<li><p><strong>subroutine</strong> – algorithm which performs the policy/value-function optimization, which
must expose its sampler</p></li>
<li><p><strong>kl_constraints_ub</strong> – upper bound for the KL-divergence</p></li>
<li><p><strong>max_iter</strong> – Maximal iterations for the SPDR algorithm (not for the subroutine)</p></li>
<li><p><strong>performance_lower_bound</strong> – lower bound for the performance SPDR tries to stay above
during distribution updates</p></li>
<li><p><strong>var_lower_bound</strong> – clipping value for the variance,necessary when using very small target variances; prefer
a log-transformation instead</p></li>
<li><p><strong>kl_threshold</strong> – threshold for the KL-divergence until which std_lower_bound is enforced</p></li>
<li><p><strong>optimize_mean</strong> – whether the mean should be changed or considered fixed</p></li>
<li><p><strong>optimize_cov</strong> – whether the (co-)variance should be changed or considered fixed</p></li>
<li><p><strong>max_subrtn_retries</strong> – how often a failed (median performance &lt; 30 % of performance_lower_bound)
training attempt of the subroutine should be reattempted</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyrado.algorithms.meta.spdr.SPDR.load_snapshot">
<span class="sig-name descname"><span class="pre">load_snapshot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">parsed_args</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="environments.html#pyrado.environments.base.Env" title="pyrado.environments.base.Env"><span class="pre">Env</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="policies.html#pyrado.policies.base.Policy" title="pyrado.policies.base.Policy"><span class="pre">Policy</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/pyrado/algorithms/meta/spdr.html#SPDR.load_snapshot"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.algorithms.meta.spdr.SPDR.load_snapshot" title="Permalink to this definition"></a></dt>
<dd><p>Load the state of an experiment, which is specific to the algorithm.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>parsed_args</strong> – arguments parsed by the <cite>argparser</cite></p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>environment, policy, and (optional) algorithm-specific output, e.g. value function</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pyrado.algorithms.meta.spdr.SPDR.name">
<span class="sig-name descname"><span class="pre">name</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'spdr'</span></em><a class="headerlink" href="#pyrado.algorithms.meta.spdr.SPDR.name" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyrado.algorithms.meta.spdr.SPDR.reset">
<span class="sig-name descname"><span class="pre">reset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/algorithms/meta/spdr.html#SPDR.reset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.algorithms.meta.spdr.SPDR.reset" title="Permalink to this definition"></a></dt>
<dd><p>Reset the algorithm to it’s initial state. This should NOT reset learned policy parameters.
By default, this resets the iteration count and the exploration strategy.
Be sure to call this function if you override it.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>seed</strong> – seed value for the random number generators, pass <cite>None</cite> for no seeding</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="pyrado.algorithms.meta.spdr.SPDR.sample_count">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">sample_count</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><a class="headerlink" href="#pyrado.algorithms.meta.spdr.SPDR.sample_count" title="Permalink to this definition"></a></dt>
<dd><p>Get the total number of samples, i.e. steps of a rollout, used for training so far.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyrado.algorithms.meta.spdr.SPDR.save_snapshot">
<span class="sig-name descname"><span class="pre">save_snapshot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">meta_info</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/algorithms/meta/spdr.html#SPDR.save_snapshot"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.algorithms.meta.spdr.SPDR.save_snapshot" title="Permalink to this definition"></a></dt>
<dd><p>Save the algorithm information (e.g., environment, policy, ect.).
Subclasses should call the base method to save the policy.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>meta_info</strong> – is not <cite>None</cite> if this algorithm is run as a subroutine of a meta-algorithm,
contains a dict of information about the current iteration of the meta-algorithm</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyrado.algorithms.meta.spdr.SPDR.step">
<span class="sig-name descname"><span class="pre">step</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">snapshot_mode</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">meta_info</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/algorithms/meta/spdr.html#SPDR.step"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.algorithms.meta.spdr.SPDR.step" title="Permalink to this definition"></a></dt>
<dd><p>Perform a step of SPDR. This includes training the subroutine and updating the context distribution accordingly.
For a description of the parameters see <cite>pyrado.algorithms.base.Algorithm.step</cite>.</p>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyrado.algorithms.meta.spdr.ravel_tril_elements">
<span class="sig-name descname"><span class="pre">ravel_tril_elements</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">A</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tensor</span></span></span><a class="reference internal" href="_modules/pyrado/algorithms/meta/spdr.html#ravel_tril_elements"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.algorithms.meta.spdr.ravel_tril_elements" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyrado.algorithms.meta.spdr.unravel_tril_elements">
<span class="sig-name descname"><span class="pre">unravel_tril_elements</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tensor</span></span></span><a class="reference internal" href="_modules/pyrado/algorithms/meta/spdr.html#unravel_tril_elements"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.algorithms.meta.spdr.unravel_tril_elements" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</section>
<section id="module-pyrado.algorithms.meta.spota">
<span id="spota"></span><h2>spota<a class="headerlink" href="#module-pyrado.algorithms.meta.spota" title="Permalink to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="pyrado.algorithms.meta.spota.SPOTA">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">SPOTA</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">save_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">PathLike</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">env</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="environment_wrappers.html#pyrado.environment_wrappers.domain_randomization.DomainRandWrapperBuffer" title="pyrado.environment_wrappers.domain_randomization.DomainRandWrapperBuffer"><span class="pre">DomainRandWrapperBuffer</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">subrtn_cand</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="algorithms.html#pyrado.algorithms.base.Algorithm" title="pyrado.algorithms.base.Algorithm"><span class="pre">Algorithm</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">subrtn_refs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="algorithms.html#pyrado.algorithms.base.Algorithm" title="pyrado.algorithms.base.Algorithm"><span class="pre">Algorithm</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_iter</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">beta</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nG</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nJ</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ntau</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nc_init</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nr_init</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sequence_cand</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">callable</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sequence_refs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">callable</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">warmstart_cand</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">warmstart_refs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cand_policy_param_init</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Tensor</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cand_critic_param_init</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Tensor</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_bs_reps</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">studentized_ci</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">base_seed</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logger</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="logger.html#pyrado.logger.step.StepLogger" title="pyrado.logger.step.StepLogger"><span class="pre">StepLogger</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/algorithms/meta/spota.html#SPOTA"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.algorithms.meta.spota.SPOTA" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="algorithms.html#pyrado.algorithms.base.InterruptableAlgorithm" title="pyrado.algorithms.base.InterruptableAlgorithm"><code class="xref py py-class docutils literal notranslate"><span class="pre">InterruptableAlgorithm</span></code></a></p>
<p>Simulation-based Policy Optimization with Probability Assessment (SPOTA)</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>We use each domain parameter set <span class="math notranslate nohighlight">\(\xi_{j,nr}\)</span> for <span class="math notranslate nohighlight">\(n_{\tau}\)</span> rollouts.
The candidate and the reference policies must have the same architecture!</p>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt>[1] F. Muratore, M. Gienger, J. Peters, “Assessing Transferability from Simulation to Reality for Reinforcement</dt><dd><p>Learning”, PAMI, 2021</p>
</dd>
<dt>[2] W. Mak, D.P. Morton, and R.K. Wood, “Monte Carlo bounding techniques for determining solution quality in</dt><dd><p>stochastic programs”, Oper. Res. Lett., 1999</p>
</dd>
</dl>
</div>
<p>Constructor</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>save_dir</strong> – directory to save the snapshots i.e. the results in</p></li>
<li><p><strong>env</strong> – the environment which the policy operates</p></li>
<li><p><strong>subrtn_cand</strong> – the algorithm that is called at every iteration of SPOTA to yield a candidate policy</p></li>
<li><p><strong>subrtn_refs</strong> – the algorithm that is called at every iteration of SPOTA to yield reference policies</p></li>
<li><p><strong>max_iter</strong> – maximum number of iterations that SPOTA algorithm runs.
Each of these iterations includes multiple iterations of the subroutine.</p></li>
<li><p><strong>alpha</strong> – confidence level for the upper confidence bound (UCBOG)</p></li>
<li><p><strong>beta</strong> – optimality gap threshold for training</p></li>
<li><p><strong>nG</strong> – number of reference solutions</p></li>
<li><p><strong>nJ</strong> – number of samples for Monte-Carlo approximation of the optimality gap</p></li>
<li><p><strong>ntau</strong> – number of rollouts per domain parameter set</p></li>
<li><p><strong>nc_init</strong> – initial number of domains for training the candidate solution</p></li>
<li><p><strong>nr_init</strong> – initial number of domains for training the reference solutions</p></li>
<li><p><strong>sequence_cand</strong> – mathematical sequence for the number of domains for training the candidate solution</p></li>
<li><p><strong>sequence_refs</strong> – mathematical sequence for the number of domains for training the reference solutions</p></li>
<li><p><strong>warmstart_cand</strong> – flag if the next candidate solution should be initialized with the previous one</p></li>
<li><p><strong>warmstart_refs</strong> – flag if the reference solutions should be initialized with the current candidate</p></li>
<li><p><strong>cand_policy_param_init</strong> – initial policy parameter values for the candidate, set None to be random</p></li>
<li><p><strong>cand_critic_param_init</strong> – initial critic parameter values for the candidate, set None to be random</p></li>
<li><p><strong>num_bs_reps</strong> – number of replications for the statistical bootstrap</p></li>
<li><p><strong>studentized_ci</strong> – flag if a student T distribution should be applied for the confidence interval</p></li>
<li><p><strong>base_seed</strong> – seed added to all other seeds in order to make the experiments distinct but repeatable</p></li>
<li><p><strong>logger</strong> – logger for every step of the algorithm, if <cite>None</cite> the default logger will be created</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="pyrado.algorithms.meta.spota.SPOTA.iteration_key">
<span class="sig-name descname"><span class="pre">iteration_key</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'spota_iteration'</span></em><a class="headerlink" href="#pyrado.algorithms.meta.spota.SPOTA.iteration_key" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyrado.algorithms.meta.spota.SPOTA.load_snapshot">
<span class="sig-name descname"><span class="pre">load_snapshot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">parsed_args</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="environments.html#pyrado.environments.base.Env" title="pyrado.environments.base.Env"><span class="pre">Env</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="policies.html#pyrado.policies.base.Policy" title="pyrado.policies.base.Policy"><span class="pre">Policy</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/pyrado/algorithms/meta/spota.html#SPOTA.load_snapshot"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.algorithms.meta.spota.SPOTA.load_snapshot" title="Permalink to this definition"></a></dt>
<dd><p>Load the state of an experiment, which is specific to the algorithm.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>parsed_args</strong> – arguments parsed by the <cite>argparser</cite></p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>environment, policy, and (optional) algorithm-specific output, e.g. value function</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pyrado.algorithms.meta.spota.SPOTA.name">
<span class="sig-name descname"><span class="pre">name</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'spota'</span></em><a class="headerlink" href="#pyrado.algorithms.meta.spota.SPOTA.name" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="pyrado.algorithms.meta.spota.SPOTA.policy">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">policy</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="policies.html#pyrado.policies.base.Policy" title="pyrado.policies.base.Policy"><span class="pre">Policy</span></a></em><a class="headerlink" href="#pyrado.algorithms.meta.spota.SPOTA.policy" title="Permalink to this definition"></a></dt>
<dd><p>Get the algorithm’s policy.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="pyrado.algorithms.meta.spota.SPOTA.sample_count">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">sample_count</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><a class="headerlink" href="#pyrado.algorithms.meta.spota.SPOTA.sample_count" title="Permalink to this definition"></a></dt>
<dd><p>Get the total number of samples, i.e. steps of a rollout, used for training so far.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyrado.algorithms.meta.spota.SPOTA.save_snapshot">
<span class="sig-name descname"><span class="pre">save_snapshot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">meta_info</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/algorithms/meta/spota.html#SPOTA.save_snapshot"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.algorithms.meta.spota.SPOTA.save_snapshot" title="Permalink to this definition"></a></dt>
<dd><p>Save the algorithm information (e.g., environment, policy, ect.).
Subclasses should call the base method to save the policy.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>meta_info</strong> – is not <cite>None</cite> if this algorithm is run as a subroutine of a meta-algorithm,
contains a dict of information about the current iteration of the meta-algorithm</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyrado.algorithms.meta.spota.SPOTA.step">
<span class="sig-name descname"><span class="pre">step</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">snapshot_mode</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'latest'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">meta_info</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/algorithms/meta/spota.html#SPOTA.step"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.algorithms.meta.spota.SPOTA.step" title="Permalink to this definition"></a></dt>
<dd><p>Perform a single iteration of the algorithm. This includes collecting the data, updating the parameters, and
adding the metrics of interest to the logger. Does not update the <cite>curr_iter</cite> attribute.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>snapshot_mode</strong> – determines when the snapshots are stored (e.g. on every iteration or on new highscore)</p></li>
<li><p><strong>meta_info</strong> – is not <cite>None</cite> if this algorithm is run as a subroutine of a meta-algorithm,
contains a dict of information about the current iteration of the meta-algorithm</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="pyrado.algorithms.meta.spota.SPOTA.subroutine_cand">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">subroutine_cand</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="algorithms.html#pyrado.algorithms.base.Algorithm" title="pyrado.algorithms.base.Algorithm"><span class="pre">Algorithm</span></a></em><a class="headerlink" href="#pyrado.algorithms.meta.spota.SPOTA.subroutine_cand" title="Permalink to this definition"></a></dt>
<dd><p>Get the candidate subroutine.</p>
</dd></dl>

</dd></dl>

</section>
<section id="module-pyrado.algorithms.meta.udr">
<span id="udr"></span><h2>udr<a class="headerlink" href="#module-pyrado.algorithms.meta.udr" title="Permalink to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="pyrado.algorithms.meta.udr.UDR">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">UDR</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">env</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="environment_wrappers.html#pyrado.environment_wrappers.base.EnvWrapper" title="pyrado.environment_wrappers.base.EnvWrapper"><span class="pre">EnvWrapper</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">subrtn</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="algorithms.html#pyrado.algorithms.base.Algorithm" title="pyrado.algorithms.base.Algorithm"><span class="pre">Algorithm</span></a></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/algorithms/meta/udr.html#UDR"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.algorithms.meta.udr.UDR" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="algorithms.html#pyrado.algorithms.base.Algorithm" title="pyrado.algorithms.base.Algorithm"><code class="xref py py-class docutils literal notranslate"><span class="pre">Algorithm</span></code></a></p>
<p>Uniform Domain Randomization (UDR)</p>
<p>This algorithm barely wraps another algorithm. The main purpose is to check if the domain randomizer is set up.</p>
<p>Constructor</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>env</strong> – same environment as the subroutine runs in. Only used for checking and saving the randomizer.</p></li>
<li><p><strong>subrtn</strong> – algorithm which performs the policy / value-function optimization</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyrado.algorithms.meta.udr.UDR.load_snapshot">
<span class="sig-name descname"><span class="pre">load_snapshot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">parsed_args</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="environments.html#pyrado.environments.base.Env" title="pyrado.environments.base.Env"><span class="pre">Env</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="policies.html#pyrado.policies.base.Policy" title="pyrado.policies.base.Policy"><span class="pre">Policy</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/pyrado/algorithms/meta/udr.html#UDR.load_snapshot"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.algorithms.meta.udr.UDR.load_snapshot" title="Permalink to this definition"></a></dt>
<dd><p>Load the state of an experiment, which is specific to the algorithm.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>parsed_args</strong> – arguments parsed by the <cite>argparser</cite></p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>environment, policy, and (optional) algorithm-specific output, e.g. value function</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pyrado.algorithms.meta.udr.UDR.name">
<span class="sig-name descname"><span class="pre">name</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'udr'</span></em><a class="headerlink" href="#pyrado.algorithms.meta.udr.UDR.name" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyrado.algorithms.meta.udr.UDR.reset">
<span class="sig-name descname"><span class="pre">reset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/algorithms/meta/udr.html#UDR.reset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.algorithms.meta.udr.UDR.reset" title="Permalink to this definition"></a></dt>
<dd><p>Reset the algorithm to it’s initial state. This should NOT reset learned policy parameters.
By default, this resets the iteration count and the exploration strategy.
Be sure to call this function if you override it.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>seed</strong> – seed value for the random number generators, pass <cite>None</cite> for no seeding</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="pyrado.algorithms.meta.udr.UDR.sample_count">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">sample_count</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><a class="headerlink" href="#pyrado.algorithms.meta.udr.UDR.sample_count" title="Permalink to this definition"></a></dt>
<dd><p>Get the total number of samples, i.e. steps of a rollout, used for training so far.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyrado.algorithms.meta.udr.UDR.save_snapshot">
<span class="sig-name descname"><span class="pre">save_snapshot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">meta_info</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/algorithms/meta/udr.html#UDR.save_snapshot"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.algorithms.meta.udr.UDR.save_snapshot" title="Permalink to this definition"></a></dt>
<dd><p>Save the algorithm information (e.g., environment, policy, ect.).
Subclasses should call the base method to save the policy.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>meta_info</strong> – is not <cite>None</cite> if this algorithm is run as a subroutine of a meta-algorithm,
contains a dict of information about the current iteration of the meta-algorithm</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyrado.algorithms.meta.udr.UDR.step">
<span class="sig-name descname"><span class="pre">step</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">snapshot_mode</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">meta_info</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/algorithms/meta/udr.html#UDR.step"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.algorithms.meta.udr.UDR.step" title="Permalink to this definition"></a></dt>
<dd><p>Perform a single iteration of the algorithm. This includes collecting the data, updating the parameters, and
adding the metrics of interest to the logger. Does not update the <cite>curr_iter</cite> attribute.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>snapshot_mode</strong> – determines when the snapshots are stored (e.g. on every iteration or on new highscore)</p></li>
<li><p><strong>meta_info</strong> – is not <cite>None</cite> if this algorithm is run as a subroutine of a meta-algorithm,
contains a dict of information about the current iteration of the meta-algorithm</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="pyrado.algorithms.meta.udr.UDR.subroutine">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">subroutine</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="algorithms.html#pyrado.algorithms.base.Algorithm" title="pyrado.algorithms.base.Algorithm"><span class="pre">Algorithm</span></a></em><a class="headerlink" href="#pyrado.algorithms.meta.udr.UDR.subroutine" title="Permalink to this definition"></a></dt>
<dd><p>Get the policy optimization subroutine.</p>
</dd></dl>

</dd></dl>

</section>
<section id="module-pyrado.algorithms.meta">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-pyrado.algorithms.meta" title="Permalink to this heading"></a></h2>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="algorithms.step_based.html" class="btn btn-neutral float-left" title="step_based" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="algorithms.regression.html" class="btn btn-neutral float-right" title="regression" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2020.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>