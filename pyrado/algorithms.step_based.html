<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>step_based &mdash; Pyrado 0.7.1 documentation</title>
      <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="_static/graphviz.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/sphinx_highlight.js"></script>
        <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="meta" href="algorithms.meta.html" />
    <link rel="prev" title="episodic" href="algorithms.episodic.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="index.html" class="icon icon-home"> Pyrado
          </a>
              <div class="version">
                0.7.1
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Examples:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="examples/1_basic_experiment.html">How to run an experiment</a></li>
<li class="toctree-l1"><a class="reference internal" href="examples/2_wrapping_environments.html">How to wrap an environment</a></li>
<li class="toctree-l1"><a class="reference internal" href="examples/3_algorithm_skeleton.html">How to create an algorithm</a></li>
<li class="toctree-l1"><a class="reference internal" href="examples/4_creating_rcspysim_environments.html">How to create an RcsPySim environment</a></li>
<li class="toctree-l1"><a class="reference internal" href="examples/5_panda3d_visualization.html"><strong>How to create a visualization</strong></a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Environments:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="environments.html">environments</a></li>
<li class="toctree-l1"><a class="reference internal" href="environments.barrett_wam.html">barrett_wam</a></li>
<li class="toctree-l1"><a class="reference internal" href="environments.mujoco.html">mujoco</a></li>
<li class="toctree-l1"><a class="reference internal" href="environments.pysim.html">pysim</a></li>
<li class="toctree-l1"><a class="reference internal" href="environments.quanser.html">quanser</a></li>
<li class="toctree-l1"><a class="reference internal" href="environments.rcspysim.html">rcspysim</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Environment Wrappers:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="environment_wrappers.html">environment_wrappers</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Domain Randomization:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="domain_randomization.html">domain_randomization</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Algorithms:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="algorithms.html">algorithms</a></li>
<li class="toctree-l1"><a class="reference internal" href="algorithms.episodic.html">episodic</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">step_based</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#module-pyrado.algorithms.step_based.a2c">a2c</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#pyrado.algorithms.step_based.a2c.A2C"><code class="docutils literal notranslate"><span class="pre">A2C</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#pyrado.algorithms.step_based.a2c.A2C.loss_fcn"><code class="docutils literal notranslate"><span class="pre">A2C.loss_fcn()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pyrado.algorithms.step_based.a2c.A2C.name"><code class="docutils literal notranslate"><span class="pre">A2C.name</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pyrado.algorithms.step_based.a2c.A2C.update"><code class="docutils literal notranslate"><span class="pre">A2C.update()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-pyrado.algorithms.step_based.actor_critic">actor_critic</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#pyrado.algorithms.step_based.actor_critic.ActorCritic"><code class="docutils literal notranslate"><span class="pre">ActorCritic</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#pyrado.algorithms.step_based.actor_critic.ActorCritic.critic"><code class="docutils literal notranslate"><span class="pre">ActorCritic.critic</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pyrado.algorithms.step_based.actor_critic.ActorCritic.expl_strat"><code class="docutils literal notranslate"><span class="pre">ActorCritic.expl_strat</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pyrado.algorithms.step_based.actor_critic.ActorCritic.init_modules"><code class="docutils literal notranslate"><span class="pre">ActorCritic.init_modules()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pyrado.algorithms.step_based.actor_critic.ActorCritic.load_snapshot"><code class="docutils literal notranslate"><span class="pre">ActorCritic.load_snapshot()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pyrado.algorithms.step_based.actor_critic.ActorCritic.reset"><code class="docutils literal notranslate"><span class="pre">ActorCritic.reset()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pyrado.algorithms.step_based.actor_critic.ActorCritic.sampler"><code class="docutils literal notranslate"><span class="pre">ActorCritic.sampler</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pyrado.algorithms.step_based.actor_critic.ActorCritic.save_snapshot"><code class="docutils literal notranslate"><span class="pre">ActorCritic.save_snapshot()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pyrado.algorithms.step_based.actor_critic.ActorCritic.step"><code class="docutils literal notranslate"><span class="pre">ActorCritic.step()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pyrado.algorithms.step_based.actor_critic.ActorCritic.update"><code class="docutils literal notranslate"><span class="pre">ActorCritic.update()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-pyrado.algorithms.step_based.dql">dql</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#pyrado.algorithms.step_based.dql.DQL"><code class="docutils literal notranslate"><span class="pre">DQL</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#pyrado.algorithms.step_based.dql.DQL.init_modules"><code class="docutils literal notranslate"><span class="pre">DQL.init_modules()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pyrado.algorithms.step_based.dql.DQL.load_snapshot"><code class="docutils literal notranslate"><span class="pre">DQL.load_snapshot()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pyrado.algorithms.step_based.dql.DQL.loss_fcn"><code class="docutils literal notranslate"><span class="pre">DQL.loss_fcn()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pyrado.algorithms.step_based.dql.DQL.name"><code class="docutils literal notranslate"><span class="pre">DQL.name</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pyrado.algorithms.step_based.dql.DQL.reset"><code class="docutils literal notranslate"><span class="pre">DQL.reset()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pyrado.algorithms.step_based.dql.DQL.sampler"><code class="docutils literal notranslate"><span class="pre">DQL.sampler</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pyrado.algorithms.step_based.dql.DQL.save_snapshot"><code class="docutils literal notranslate"><span class="pre">DQL.save_snapshot()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pyrado.algorithms.step_based.dql.DQL.update"><code class="docutils literal notranslate"><span class="pre">DQL.update()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-pyrado.algorithms.step_based.gae">gae</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#pyrado.algorithms.step_based.gae.GAE"><code class="docutils literal notranslate"><span class="pre">GAE</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#pyrado.algorithms.step_based.gae.GAE.gae"><code class="docutils literal notranslate"><span class="pre">GAE.gae()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pyrado.algorithms.step_based.gae.GAE.reset"><code class="docutils literal notranslate"><span class="pre">GAE.reset()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pyrado.algorithms.step_based.gae.GAE.tdlamda_returns"><code class="docutils literal notranslate"><span class="pre">GAE.tdlamda_returns()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pyrado.algorithms.step_based.gae.GAE.update"><code class="docutils literal notranslate"><span class="pre">GAE.update()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pyrado.algorithms.step_based.gae.GAE.values"><code class="docutils literal notranslate"><span class="pre">GAE.values()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pyrado.algorithms.step_based.gae.GAE.vfcn"><code class="docutils literal notranslate"><span class="pre">GAE.vfcn</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-pyrado.algorithms.step_based.ppo">ppo</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#pyrado.algorithms.step_based.ppo.PPO"><code class="docutils literal notranslate"><span class="pre">PPO</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#pyrado.algorithms.step_based.ppo.PPO.expl_strat"><code class="docutils literal notranslate"><span class="pre">PPO.expl_strat</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pyrado.algorithms.step_based.ppo.PPO.loss_fcn"><code class="docutils literal notranslate"><span class="pre">PPO.loss_fcn()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pyrado.algorithms.step_based.ppo.PPO.name"><code class="docutils literal notranslate"><span class="pre">PPO.name</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pyrado.algorithms.step_based.ppo.PPO.update"><code class="docutils literal notranslate"><span class="pre">PPO.update()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#pyrado.algorithms.step_based.ppo.PPO2"><code class="docutils literal notranslate"><span class="pre">PPO2</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#pyrado.algorithms.step_based.ppo.PPO2.expl_strat"><code class="docutils literal notranslate"><span class="pre">PPO2.expl_strat</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pyrado.algorithms.step_based.ppo.PPO2.loss_fcn"><code class="docutils literal notranslate"><span class="pre">PPO2.loss_fcn()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pyrado.algorithms.step_based.ppo.PPO2.name"><code class="docutils literal notranslate"><span class="pre">PPO2.name</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pyrado.algorithms.step_based.ppo.PPO2.update"><code class="docutils literal notranslate"><span class="pre">PPO2.update()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-pyrado.algorithms.step_based.sac">sac</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#pyrado.algorithms.step_based.sac.SAC"><code class="docutils literal notranslate"><span class="pre">SAC</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#pyrado.algorithms.step_based.sac.SAC.ent_coeff"><code class="docutils literal notranslate"><span class="pre">SAC.ent_coeff</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pyrado.algorithms.step_based.sac.SAC.init_modules"><code class="docutils literal notranslate"><span class="pre">SAC.init_modules()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pyrado.algorithms.step_based.sac.SAC.load_snapshot"><code class="docutils literal notranslate"><span class="pre">SAC.load_snapshot()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pyrado.algorithms.step_based.sac.SAC.name"><code class="docutils literal notranslate"><span class="pre">SAC.name</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pyrado.algorithms.step_based.sac.SAC.reset"><code class="docutils literal notranslate"><span class="pre">SAC.reset()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pyrado.algorithms.step_based.sac.SAC.sampler"><code class="docutils literal notranslate"><span class="pre">SAC.sampler</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pyrado.algorithms.step_based.sac.SAC.save_snapshot"><code class="docutils literal notranslate"><span class="pre">SAC.save_snapshot()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pyrado.algorithms.step_based.sac.SAC.update"><code class="docutils literal notranslate"><span class="pre">SAC.update()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-pyrado.algorithms.step_based.svpg">svpg</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#pyrado.algorithms.step_based.svpg.OptimizerHook"><code class="docutils literal notranslate"><span class="pre">OptimizerHook</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#pyrado.algorithms.step_based.svpg.OptimizerHook.empty"><code class="docutils literal notranslate"><span class="pre">OptimizerHook.empty()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pyrado.algorithms.step_based.svpg.OptimizerHook.iter_steps"><code class="docutils literal notranslate"><span class="pre">OptimizerHook.iter_steps()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pyrado.algorithms.step_based.svpg.OptimizerHook.real_step"><code class="docutils literal notranslate"><span class="pre">OptimizerHook.real_step()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pyrado.algorithms.step_based.svpg.OptimizerHook.reset"><code class="docutils literal notranslate"><span class="pre">OptimizerHook.reset()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pyrado.algorithms.step_based.svpg.OptimizerHook.step"><code class="docutils literal notranslate"><span class="pre">OptimizerHook.step()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pyrado.algorithms.step_based.svpg.OptimizerHook.zero_grad"><code class="docutils literal notranslate"><span class="pre">OptimizerHook.zero_grad()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#pyrado.algorithms.step_based.svpg.SVPG"><code class="docutils literal notranslate"><span class="pre">SVPG</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#pyrado.algorithms.step_based.svpg.SVPG.iter_particles"><code class="docutils literal notranslate"><span class="pre">SVPG.iter_particles</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pyrado.algorithms.step_based.svpg.SVPG.kernel"><code class="docutils literal notranslate"><span class="pre">SVPG.kernel()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pyrado.algorithms.step_based.svpg.SVPG.load_particle"><code class="docutils literal notranslate"><span class="pre">SVPG.load_particle()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pyrado.algorithms.step_based.svpg.SVPG.load_snapshot"><code class="docutils literal notranslate"><span class="pre">SVPG.load_snapshot()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pyrado.algorithms.step_based.svpg.SVPG.name"><code class="docutils literal notranslate"><span class="pre">SVPG.name</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pyrado.algorithms.step_based.svpg.SVPG.save_snapshot"><code class="docutils literal notranslate"><span class="pre">SVPG.save_snapshot()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pyrado.algorithms.step_based.svpg.SVPG.step"><code class="docutils literal notranslate"><span class="pre">SVPG.step()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pyrado.algorithms.step_based.svpg.SVPG.store_particle"><code class="docutils literal notranslate"><span class="pre">SVPG.store_particle()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#pyrado.algorithms.step_based.svpg.SVPGBuilder"><code class="docutils literal notranslate"><span class="pre">SVPGBuilder</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-pyrado.algorithms.step_based.value_based">value_based</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#pyrado.algorithms.step_based.value_based.ValueBased"><code class="docutils literal notranslate"><span class="pre">ValueBased</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#pyrado.algorithms.step_based.value_based.ValueBased.expl_strat"><code class="docutils literal notranslate"><span class="pre">ValueBased.expl_strat</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pyrado.algorithms.step_based.value_based.ValueBased.memory"><code class="docutils literal notranslate"><span class="pre">ValueBased.memory</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pyrado.algorithms.step_based.value_based.ValueBased.reset"><code class="docutils literal notranslate"><span class="pre">ValueBased.reset()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pyrado.algorithms.step_based.value_based.ValueBased.save_snapshot"><code class="docutils literal notranslate"><span class="pre">ValueBased.save_snapshot()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pyrado.algorithms.step_based.value_based.ValueBased.step"><code class="docutils literal notranslate"><span class="pre">ValueBased.step()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pyrado.algorithms.step_based.value_based.ValueBased.update"><code class="docutils literal notranslate"><span class="pre">ValueBased.update()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-pyrado.algorithms.step_based">Module contents</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="algorithms.meta.html">meta</a></li>
<li class="toctree-l1"><a class="reference internal" href="algorithms.regression.html">regression</a></li>
<li class="toctree-l1"><a class="reference internal" href="algorithms.stopping_criteria.html">stopping_criteria</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Exploration:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="exploration.html">exploration</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Policies:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="policies.html">policies</a></li>
<li class="toctree-l1"><a class="reference internal" href="policies.feed_back.html">feed_back</a></li>
<li class="toctree-l1"><a class="reference internal" href="policies.feed_forward.html">feed_forward</a></li>
<li class="toctree-l1"><a class="reference internal" href="policies.recurrent.html">recurrent</a></li>
<li class="toctree-l1"><a class="reference internal" href="policies.special.html">special</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Spaces:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="spaces.html">spaces</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Tasks &amp; Rewards:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="tasks.html">tasks</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Sampling:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="sampling.html">sampling</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Plotting:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="plotting.html">plotting</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Utilities:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="utils.html">utils</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Pyrado</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
      <li>step_based</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/algorithms.step_based.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="step-based">
<h1>step_based<a class="headerlink" href="#step-based" title="Permalink to this heading"></a></h1>
<section id="module-pyrado.algorithms.step_based.a2c">
<span id="a2c"></span><h2>a2c<a class="headerlink" href="#module-pyrado.algorithms.step_based.a2c" title="Permalink to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="pyrado.algorithms.step_based.a2c.A2C">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">A2C</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">save_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">PathLike</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">env</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="environments.html#pyrado.environments.base.Env" title="pyrado.environments.base.Env"><span class="pre">Env</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">policy</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="policies.html#pyrado.policies.base.Policy" title="pyrado.policies.base.Policy"><span class="pre">Policy</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">critic</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#pyrado.algorithms.step_based.gae.GAE" title="pyrado.algorithms.step_based.gae.GAE"><span class="pre">GAE</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_iter</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_rollouts</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_steps</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vfcn_coeff</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">entropy_coeff</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.001</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">32</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">std_init</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_grad_norm</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_workers</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">4</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lr</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.0005</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lr_scheduler</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lr_scheduler_hparam</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logger</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="logger.html#pyrado.logger.step.StepLogger" title="pyrado.logger.step.StepLogger"><span class="pre">StepLogger</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/algorithms/step_based/a2c.html#A2C"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.algorithms.step_based.a2c.A2C" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#pyrado.algorithms.step_based.actor_critic.ActorCritic" title="pyrado.algorithms.step_based.actor_critic.ActorCritic"><code class="xref py py-class docutils literal notranslate"><span class="pre">ActorCritic</span></code></a></p>
<p>Advantage Actor Critic (A2C)</p>
<p>Constructor</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>save_dir</strong> – directory to save the snapshots i.e. the results in</p></li>
<li><p><strong>env</strong> – the environment which the policy operates</p></li>
<li><p><strong>policy</strong> – policy to be updated</p></li>
<li><p><strong>critic</strong> – advantage estimation function <span class="math notranslate nohighlight">\(A(s,a) = Q(s,a) - V(s)\)</span></p></li>
<li><p><strong>max_iter</strong> – maximum number of iterations (i.e. policy updates) that this algorithm runs</p></li>
<li><p><strong>min_rollouts</strong> – minimum number of rollouts sampled per policy update batch</p></li>
<li><p><strong>min_steps</strong> – minimum number of state transitions sampled per policy update batch</p></li>
<li><p><strong>vfcn_coeff</strong> – weighting factor of the value function term in the combined loss, specific to PPO2</p></li>
<li><p><strong>entropy_coeff</strong> – weighting factor of the entropy term in the combined loss, specific to PPO2</p></li>
<li><p><strong>batch_size</strong> – number of samples per policy update batch</p></li>
<li><p><strong>std_init</strong> – initial standard deviation on the actions for the exploration noise</p></li>
<li><p><strong>max_grad_norm</strong> – maximum L2 norm of the gradients for clipping, set to <cite>None</cite> to disable gradient clipping</p></li>
<li><p><strong>num_workers</strong> – number of environments for parallel sampling</p></li>
<li><p><strong>lr</strong> – (initial) learning rate for the optimizer which can be by modified by the scheduler.
By default, the learning rate is constant.</p></li>
<li><p><strong>lr_scheduler</strong> – learning rate scheduler that does one step per epoch (pass through the whole data set)</p></li>
<li><p><strong>lr_scheduler_hparam</strong> – hyper-parameters for the learning rate scheduler</p></li>
<li><p><strong>logger</strong> – logger for every step of the algorithm, if <cite>None</cite> the default logger will be created</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyrado.algorithms.step_based.a2c.A2C.loss_fcn">
<span class="sig-name descname"><span class="pre">loss_fcn</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">log_probs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">adv</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">v_pred</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">v_targ</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/algorithms/step_based/a2c.html#A2C.loss_fcn"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.algorithms.step_based.a2c.A2C.loss_fcn" title="Permalink to this definition"></a></dt>
<dd><p>A2C loss function</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>log_probs</strong> – logarithm of the probabilities of the taken actions</p></li>
<li><p><strong>adv</strong> – advantage values</p></li>
<li><p><strong>v_pred</strong> – predicted value function values</p></li>
<li><p><strong>v_targ</strong> – target value function values</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>combined loss value</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pyrado.algorithms.step_based.a2c.A2C.name">
<span class="sig-name descname"><span class="pre">name</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'a2c'</span></em><a class="headerlink" href="#pyrado.algorithms.step_based.a2c.A2C.name" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyrado.algorithms.step_based.a2c.A2C.update">
<span class="sig-name descname"><span class="pre">update</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rollouts</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Sequence</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="sampling.html#pyrado.sampling.step_sequence.StepSequence" title="pyrado.sampling.step_sequence.StepSequence"><span class="pre">StepSequence</span></a><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/algorithms/step_based/a2c.html#A2C.update"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.algorithms.step_based.a2c.A2C.update" title="Permalink to this definition"></a></dt>
<dd><p>Update the actor and critic parameters from the given batch of rollouts.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>rollouts</strong> – batch of rollouts</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-pyrado.algorithms.step_based.actor_critic">
<span id="actor-critic"></span><h2>actor_critic<a class="headerlink" href="#module-pyrado.algorithms.step_based.actor_critic" title="Permalink to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="pyrado.algorithms.step_based.actor_critic.ActorCritic">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">ActorCritic</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">env</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="environments.html#pyrado.environments.base.Env" title="pyrado.environments.base.Env"><span class="pre">Env</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">actor</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="policies.html#pyrado.policies.base.Policy" title="pyrado.policies.base.Policy"><span class="pre">Policy</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">critic</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#pyrado.algorithms.step_based.gae.GAE" title="pyrado.algorithms.step_based.gae.GAE"><span class="pre">GAE</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">PathLike</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_iter</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logger</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="logger.html#pyrado.logger.step.StepLogger" title="pyrado.logger.step.StepLogger"><span class="pre">StepLogger</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/algorithms/step_based/actor_critic.html#ActorCritic"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.algorithms.step_based.actor_critic.ActorCritic" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="algorithms.html#pyrado.algorithms.base.Algorithm" title="pyrado.algorithms.base.Algorithm"><code class="xref py py-class docutils literal notranslate"><span class="pre">Algorithm</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">ABC</span></code></p>
<p>Base class of all actor critic algorithms</p>
<p>Constructor</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>env</strong> – the environment which the policy operates</p></li>
<li><p><strong>actor</strong> – policy taking the actions in the environment</p></li>
<li><p><strong>critic</strong> – estimates the value of states (e.g. advantage or return)</p></li>
<li><p><strong>save_dir</strong> – directory to save the snapshots i.e. the results in</p></li>
<li><p><strong>max_iter</strong> – maximum number of iterations</p></li>
<li><p><strong>logger</strong> – logger for every step of the algorithm, if <cite>None</cite> the default logger will be created</p></li>
</ul>
</dd>
</dl>
<dl class="py property">
<dt class="sig sig-object py" id="pyrado.algorithms.step_based.actor_critic.ActorCritic.critic">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">critic</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="#pyrado.algorithms.step_based.gae.GAE" title="pyrado.algorithms.step_based.gae.GAE"><span class="pre">GAE</span></a></em><a class="headerlink" href="#pyrado.algorithms.step_based.actor_critic.ActorCritic.critic" title="Permalink to this definition"></a></dt>
<dd><p>Get the critic.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="pyrado.algorithms.step_based.actor_critic.ActorCritic.expl_strat">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">expl_strat</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="exploration.html#pyrado.exploration.stochastic_action.NormalActNoiseExplStrat" title="pyrado.exploration.stochastic_action.NormalActNoiseExplStrat"><span class="pre">NormalActNoiseExplStrat</span></a></em><a class="headerlink" href="#pyrado.algorithms.step_based.actor_critic.ActorCritic.expl_strat" title="Permalink to this definition"></a></dt>
<dd><p>Get the algorithm’s exploration strategy.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyrado.algorithms.step_based.actor_critic.ActorCritic.init_modules">
<span class="sig-name descname"><span class="pre">init_modules</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">warmstart</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">suffix</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prefix</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/algorithms/step_based/actor_critic.html#ActorCritic.init_modules"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.algorithms.step_based.actor_critic.ActorCritic.init_modules" title="Permalink to this definition"></a></dt>
<dd><p>Initialize the algorithm’s learnable modules, e.g. a policy or value function.
Overwrite this method if the algorithm uses a learnable module aside the policy, e.g. a value function.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>warmstart</strong> – if <cite>True</cite>, the algorithm starts learning with a non-random initialization. This can either
be the a fixed parameter vector, or the loaded results of the previous iteration.</p></li>
<li><p><strong>suffix</strong> – keyword for <cite>meta_info</cite> when loading from previous iteration</p></li>
<li><p><strong>prefix</strong> – keyword for <cite>meta_info</cite> when loading from previous iteration</p></li>
<li><p><strong>kwargs</strong> – keyword arguments for initialization, e.g. <cite>policy_param_init</cite> or <cite>valuefcn_param_init</cite></p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyrado.algorithms.step_based.actor_critic.ActorCritic.load_snapshot">
<span class="sig-name descname"><span class="pre">load_snapshot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">parsed_args</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="environments.html#pyrado.environments.base.Env" title="pyrado.environments.base.Env"><span class="pre">Env</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="policies.html#pyrado.policies.base.Policy" title="pyrado.policies.base.Policy"><span class="pre">Policy</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/pyrado/algorithms/step_based/actor_critic.html#ActorCritic.load_snapshot"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.algorithms.step_based.actor_critic.ActorCritic.load_snapshot" title="Permalink to this definition"></a></dt>
<dd><p>Load the state of an experiment, which is specific to the algorithm.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>parsed_args</strong> – arguments parsed by the <cite>argparser</cite></p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>environment, policy, and (optional) algorithm-specific output, e.g. value function</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyrado.algorithms.step_based.actor_critic.ActorCritic.reset">
<span class="sig-name descname"><span class="pre">reset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/algorithms/step_based/actor_critic.html#ActorCritic.reset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.algorithms.step_based.actor_critic.ActorCritic.reset" title="Permalink to this definition"></a></dt>
<dd><p>Reset the algorithm to it’s initial state. This should NOT reset learned policy parameters.
By default, this resets the iteration count and the exploration strategy.
Be sure to call this function if you override it.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>seed</strong> – seed value for the random number generators, pass <cite>None</cite> for no seeding</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="pyrado.algorithms.step_based.actor_critic.ActorCritic.sampler">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">sampler</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="sampling.html#pyrado.sampling.parallel_rollout_sampler.ParallelRolloutSampler" title="pyrado.sampling.parallel_rollout_sampler.ParallelRolloutSampler"><span class="pre">ParallelRolloutSampler</span></a></em><a class="headerlink" href="#pyrado.algorithms.step_based.actor_critic.ActorCritic.sampler" title="Permalink to this definition"></a></dt>
<dd><p>Get the sampler. For algorithms with multiple samplers, this is the once collecting the training data.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyrado.algorithms.step_based.actor_critic.ActorCritic.save_snapshot">
<span class="sig-name descname"><span class="pre">save_snapshot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">meta_info</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/algorithms/step_based/actor_critic.html#ActorCritic.save_snapshot"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.algorithms.step_based.actor_critic.ActorCritic.save_snapshot" title="Permalink to this definition"></a></dt>
<dd><p>Save the algorithm information (e.g., environment, policy, ect.).
Subclasses should call the base method to save the policy.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>meta_info</strong> – is not <cite>None</cite> if this algorithm is run as a subroutine of a meta-algorithm,
contains a dict of information about the current iteration of the meta-algorithm</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyrado.algorithms.step_based.actor_critic.ActorCritic.step">
<span class="sig-name descname"><span class="pre">step</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">snapshot_mode</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">meta_info</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/algorithms/step_based/actor_critic.html#ActorCritic.step"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.algorithms.step_based.actor_critic.ActorCritic.step" title="Permalink to this definition"></a></dt>
<dd><p>Perform a single iteration of the algorithm. This includes collecting the data, updating the parameters, and
adding the metrics of interest to the logger. Does not update the <cite>curr_iter</cite> attribute.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>snapshot_mode</strong> – determines when the snapshots are stored (e.g. on every iteration or on new highscore)</p></li>
<li><p><strong>meta_info</strong> – is not <cite>None</cite> if this algorithm is run as a subroutine of a meta-algorithm,
contains a dict of information about the current iteration of the meta-algorithm</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyrado.algorithms.step_based.actor_critic.ActorCritic.update">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">update</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rollouts</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Sequence</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="sampling.html#pyrado.sampling.step_sequence.StepSequence" title="pyrado.sampling.step_sequence.StepSequence"><span class="pre">StepSequence</span></a><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/algorithms/step_based/actor_critic.html#ActorCritic.update"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.algorithms.step_based.actor_critic.ActorCritic.update" title="Permalink to this definition"></a></dt>
<dd><p>Update the actor and critic parameters from the given batch of rollouts.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>rollouts</strong> – batch of rollouts</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-pyrado.algorithms.step_based.dql">
<span id="dql"></span><h2>dql<a class="headerlink" href="#module-pyrado.algorithms.step_based.dql" title="Permalink to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="pyrado.algorithms.step_based.dql.DQL">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">DQL</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">save_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">PathLike</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">env</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="environments.html#pyrado.environments.base.Env" title="pyrado.environments.base.Env"><span class="pre">Env</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">policy</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="policies.feed_back.html#pyrado.policies.feed_back.fnn.DiscreteActQValPolicy" title="pyrado.policies.feed_back.fnn.DiscreteActQValPolicy"><span class="pre">DiscreteActQValPolicy</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">memory_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eps_init</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eps_schedule_gamma</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gamma</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_iter</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_updates_per_step</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_update_intvl</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_init_memory_steps</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_rollouts</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_steps</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">256</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eval_intvl</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_grad_norm</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lr</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.0005</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lr_scheduler</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lr_scheduler_hparam</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_workers</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">4</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logger</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="logger.html#pyrado.logger.step.StepLogger" title="pyrado.logger.step.StepLogger"><span class="pre">StepLogger</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_trained_policy_for_refill</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/algorithms/step_based/dql.html#DQL"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.algorithms.step_based.dql.DQL" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#pyrado.algorithms.step_based.value_based.ValueBased" title="pyrado.algorithms.step_based.value_based.ValueBased"><code class="xref py py-class docutils literal notranslate"><span class="pre">ValueBased</span></code></a></p>
<p>Deep Q-Learning (without bells and whistles)</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p>[1] V. Mnih et.al., “Human-level control through deep reinforcement learning”, Nature, 2015</p>
</div>
<p>Constructor</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>save_dir</strong> – directory to save the snapshots i.e. the results in</p></li>
<li><p><strong>env</strong> – the environment which the policy operates</p></li>
<li><p><strong>policy</strong> – (current) Q-network updated by this algorithm</p></li>
<li><p><strong>memory_size</strong> – number of transitions in the replay memory buffer</p></li>
<li><p><strong>eps_init</strong> – initial value for the probability of taking a random action, constant if <cite>eps_schedule_gamma=1</cite></p></li>
<li><p><strong>eps_schedule_gamma</strong> – temporal discount factor for the exponential decay of epsilon</p></li>
<li><p><strong>gamma</strong> – temporal discount factor for the state values</p></li>
<li><p><strong>max_iter</strong> – maximum number of iterations (i.e. policy updates) that this algorithm runs</p></li>
<li><p><strong>num_updates_per_step</strong> – number of (batched) updates per algorithm steps</p></li>
<li><p><strong>target_update_intvl</strong> – number of iterations that pass before updating the <cite>qfcn_targ</cite> network</p></li>
<li><p><strong>num_init_memory_steps</strong> – number of samples used to initially fill the replay buffer with, pass <cite>None</cite> to
fill the buffer completely</p></li>
<li><p><strong>min_rollouts</strong> – minimum number of rollouts sampled per policy update batch</p></li>
<li><p><strong>min_steps</strong> – minimum number of state transitions sampled per policy update batch</p></li>
<li><p><strong>batch_size</strong> – number of samples per policy update batch</p></li>
<li><p><strong>eval_intvl</strong> – interval in which the evaluation rollouts are collected, also the interval in which the
logger prints the summary statistics</p></li>
<li><p><strong>max_grad_norm</strong> – maximum L2 norm of the gradients for clipping, set to <cite>None</cite> to disable gradient clipping</p></li>
<li><p><strong>lr</strong> – (initial) learning rate for the optimizer which can be by modified by the scheduler.
By default, the learning rate is constant.</p></li>
<li><p><strong>lr_scheduler</strong> – learning rate scheduler that does one step per epoch (pass through the whole data set)</p></li>
<li><p><strong>lr_scheduler_hparam</strong> – hyper-parameters for the learning rate scheduler</p></li>
<li><p><strong>num_workers</strong> – number of environments for parallel sampling</p></li>
<li><p><strong>logger</strong> – logger for every step of the algorithm, if <cite>None</cite> the default logger will be created</p></li>
<li><p><strong>use_trained_policy_for_refill</strong> – whether to use the trained policy instead of a dummy policy to refill the
replay buffer after resets</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyrado.algorithms.step_based.dql.DQL.init_modules">
<span class="sig-name descname"><span class="pre">init_modules</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">warmstart</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">suffix</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prefix</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/algorithms/step_based/dql.html#DQL.init_modules"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.algorithms.step_based.dql.DQL.init_modules" title="Permalink to this definition"></a></dt>
<dd><p>Initialize the algorithm’s learnable modules, e.g. a policy or value function.
Overwrite this method if the algorithm uses a learnable module aside the policy, e.g. a value function.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>warmstart</strong> – if <cite>True</cite>, the algorithm starts learning with a non-random initialization. This can either
be the a fixed parameter vector, or the loaded results of the previous iteration.</p></li>
<li><p><strong>suffix</strong> – keyword for <cite>meta_info</cite> when loading from previous iteration</p></li>
<li><p><strong>prefix</strong> – keyword for <cite>meta_info</cite> when loading from previous iteration</p></li>
<li><p><strong>kwargs</strong> – keyword arguments for initialization, e.g. <cite>policy_param_init</cite> or <cite>valuefcn_param_init</cite></p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyrado.algorithms.step_based.dql.DQL.load_snapshot">
<span class="sig-name descname"><span class="pre">load_snapshot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">parsed_args</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="environments.html#pyrado.environments.base.Env" title="pyrado.environments.base.Env"><span class="pre">Env</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="policies.html#pyrado.policies.base.Policy" title="pyrado.policies.base.Policy"><span class="pre">Policy</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/pyrado/algorithms/step_based/dql.html#DQL.load_snapshot"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.algorithms.step_based.dql.DQL.load_snapshot" title="Permalink to this definition"></a></dt>
<dd><p>Load the state of an experiment, which is specific to the algorithm.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>parsed_args</strong> – arguments parsed by the <cite>argparser</cite></p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>environment, policy, and (optional) algorithm-specific output, e.g. value function</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyrado.algorithms.step_based.dql.DQL.loss_fcn">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">loss_fcn</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">q_vals</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">expected_q_vals</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tensor</span></span></span><a class="reference internal" href="_modules/pyrado/algorithms/step_based/dql.html#DQL.loss_fcn"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.algorithms.step_based.dql.DQL.loss_fcn" title="Permalink to this definition"></a></dt>
<dd><p>The Huber loss function on the one-step TD error <span class="math notranslate nohighlight">\(\delta = Q(s,a) - (r + \gamma \max_a Q(s^\prime, a))\)</span>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>q_vals</strong> – state-action values <span class="math notranslate nohighlight">\(Q(s,a)\)</span>, from policy network</p></li>
<li><p><strong>expected_q_vals</strong> – expected state-action values <span class="math notranslate nohighlight">\(r + \gamma \max_a Q(s^\prime, a)\)</span>, from target network</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>loss value</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pyrado.algorithms.step_based.dql.DQL.name">
<span class="sig-name descname"><span class="pre">name</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'dql'</span></em><a class="headerlink" href="#pyrado.algorithms.step_based.dql.DQL.name" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyrado.algorithms.step_based.dql.DQL.reset">
<span class="sig-name descname"><span class="pre">reset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/algorithms/step_based/dql.html#DQL.reset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.algorithms.step_based.dql.DQL.reset" title="Permalink to this definition"></a></dt>
<dd><p>Reset the algorithm to it’s initial state. This should NOT reset learned policy parameters.
By default, this resets the iteration count and the exploration strategy.
Be sure to call this function if you override it.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>seed</strong> – seed value for the random number generators, pass <cite>None</cite> for no seeding</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="pyrado.algorithms.step_based.dql.DQL.sampler">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">sampler</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="sampling.html#pyrado.sampling.parallel_rollout_sampler.ParallelRolloutSampler" title="pyrado.sampling.parallel_rollout_sampler.ParallelRolloutSampler"><span class="pre">ParallelRolloutSampler</span></a></em><a class="headerlink" href="#pyrado.algorithms.step_based.dql.DQL.sampler" title="Permalink to this definition"></a></dt>
<dd><p>Get the sampler. For algorithms with multiple samplers, this is the once collecting the training data.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyrado.algorithms.step_based.dql.DQL.save_snapshot">
<span class="sig-name descname"><span class="pre">save_snapshot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">meta_info</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/algorithms/step_based/dql.html#DQL.save_snapshot"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.algorithms.step_based.dql.DQL.save_snapshot" title="Permalink to this definition"></a></dt>
<dd><p>Save the algorithm information (e.g., environment, policy, ect.).
Subclasses should call the base method to save the policy.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>meta_info</strong> – is not <cite>None</cite> if this algorithm is run as a subroutine of a meta-algorithm,
contains a dict of information about the current iteration of the meta-algorithm</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyrado.algorithms.step_based.dql.DQL.update">
<span class="sig-name descname"><span class="pre">update</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/algorithms/step_based/dql.html#DQL.update"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.algorithms.step_based.dql.DQL.update" title="Permalink to this definition"></a></dt>
<dd><p>Update the policy’s and qfcn_targ Q-function’s parameters on transitions sampled from the replay memory.</p>
</dd></dl>

</dd></dl>

</section>
<section id="module-pyrado.algorithms.step_based.gae">
<span id="gae"></span><h2>gae<a class="headerlink" href="#module-pyrado.algorithms.step_based.gae" title="Permalink to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="pyrado.algorithms.step_based.gae.GAE">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">GAE</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">vfcn</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">Module</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="policies.html#pyrado.policies.base.Policy" title="pyrado.policies.base.Policy"><span class="pre">Policy</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gamma</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.99</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lamda</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.95</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_epoch</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">64</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">standardize_adv</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">standardizer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="utils.html#pyrado.utils.data_processing.RunningStandardizer" title="pyrado.utils.data_processing.RunningStandardizer"><span class="pre">RunningStandardizer</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_grad_norm</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lr</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.0005</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lr_scheduler</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lr_scheduler_hparam</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/algorithms/step_based/gae.html#GAE"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.algorithms.step_based.gae.GAE" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="logger.html#pyrado.logger.step.LoggerAware" title="pyrado.logger.step.LoggerAware"><code class="xref py py-class docutils literal notranslate"><span class="pre">LoggerAware</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<p>General Advantage Estimation (GAE)</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p>[1] J. Schulmann, P. Moritz, S. Levine, M. Jordan, P. Abbeel, ‘High-Dimensional Continuous Control Using
Generalized Advantage Estimation’, ICLR 2016</p>
</div>
<p>Constructor</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>vfcn</strong> – value function, which can be a <cite>FNN</cite> or a <cite>Policy</cite></p></li>
<li><p><strong>gamma</strong> – temporal discount factor</p></li>
<li><p><strong>lamda</strong> – regulates the trade-off between bias (max for 0) and variance (max for 1), see [1]</p></li>
<li><p><strong>num_epoch</strong> – number of iterations over all gathered samples during one estimator update</p></li>
<li><p><strong>batch_size</strong> – number of samples per estimator update batch</p></li>
<li><p><strong>standardize_adv</strong> – if <cite>True</cite>, the advantages are standardized to be <span class="math notranslate nohighlight">\(~ N(0,1)\)</span></p></li>
<li><p><strong>standardizer</strong> – pass <cite>None</cite> to use stateless standardisation, alternatively pass <cite>RunningStandardizer()</cite>
to use a standardizer wich keeps track of past values</p></li>
<li><p><strong>max_grad_norm</strong> – maximum L2 norm of the gradients for clipping, set to <cite>None</cite> to disable gradient clipping</p></li>
<li><p><strong>lr</strong> – (initial) learning rate for the optimizer which can be by modified by the scheduler.
By default, the learning rate is constant.</p></li>
<li><p><strong>lr_scheduler</strong> – learning rate scheduler that does one step per epoch (pass through the whole data set)</p></li>
<li><p><strong>lr_scheduler_hparam</strong> – hyper-parameters for the learning rate scheduler</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyrado.algorithms.step_based.gae.GAE.gae">
<span class="sig-name descname"><span class="pre">gae</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">concat_ros</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="sampling.html#pyrado.sampling.step_sequence.StepSequence" title="pyrado.sampling.step_sequence.StepSequence"><span class="pre">StepSequence</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">v_pred</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Tensor</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">requires_grad</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tensor</span></span></span><a class="reference internal" href="_modules/pyrado/algorithms/step_based/gae.html#GAE.gae"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.algorithms.step_based.gae.GAE.gae" title="Permalink to this definition"></a></dt>
<dd><p>Compute the generalized advantage estimation as described in [1].</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>concat_ros</strong> – concatenated rollouts (sequence of steps from potentially different rollouts)</p></li>
<li><p><strong>v_pred</strong> – state-value predictions if already computed, else pass None</p></li>
<li><p><strong>requires_grad</strong> – is the gradient required</p></li>
</ul>
</dd>
<dt class="field-even">Return adv</dt>
<dd class="field-even"><p>tensor of advantages</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyrado.algorithms.step_based.gae.GAE.reset">
<span class="sig-name descname"><span class="pre">reset</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/algorithms/step_based/gae.html#GAE.reset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.algorithms.step_based.gae.GAE.reset" title="Permalink to this definition"></a></dt>
<dd><p>Reset the advantage estimator to it’s initial state.
The default implementation resets the learning rate scheduler if there is one.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyrado.algorithms.step_based.gae.GAE.tdlamda_returns">
<span class="sig-name descname"><span class="pre">tdlamda_returns</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">v_pred</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Tensor</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">adv</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Tensor</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">concat_ros</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="sampling.html#pyrado.sampling.step_sequence.StepSequence" title="pyrado.sampling.step_sequence.StepSequence"><span class="pre">StepSequence</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tensor</span></span></span><a class="reference internal" href="_modules/pyrado/algorithms/step_based/gae.html#GAE.tdlamda_returns"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.algorithms.step_based.gae.GAE.tdlamda_returns" title="Permalink to this definition"></a></dt>
<dd><p>Compute the TD(<span class="math notranslate nohighlight">\(\lambda\)</span>) returns based on the predictions of the network (introduces a bias).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>v_pred</strong> – state-value predictions if already computed, pass <cite>None</cite> to compute form given rollouts</p></li>
<li><p><strong>adv</strong> – advantages if already computed, pass <cite>None</cite> to compute form given rollouts</p></li>
<li><p><strong>concat_ros</strong> – rollouts to compute predicted values and advantages from if they are not provided</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>exponentially weighted returns based on the value function estimator</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyrado.algorithms.step_based.gae.GAE.update">
<span class="sig-name descname"><span class="pre">update</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rollouts</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Sequence</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="sampling.html#pyrado.sampling.step_sequence.StepSequence" title="pyrado.sampling.step_sequence.StepSequence"><span class="pre">StepSequence</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_empirical_returns</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/algorithms/step_based/gae.html#GAE.update"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.algorithms.step_based.gae.GAE.update" title="Permalink to this definition"></a></dt>
<dd><p>Adapt the parameters of the advantage function estimator, minimizing the MSE loss for the given samples.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>rollouts</strong> – batch of rollouts</p></li>
<li><p><strong>use_empirical_returns</strong> – use the return from the rollout (True) or the ones from the V-fcn (False)</p></li>
</ul>
</dd>
<dt class="field-even">Return adv</dt>
<dd class="field-even"><p>tensor of advantages after V-function updates</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyrado.algorithms.step_based.gae.GAE.values">
<span class="sig-name descname"><span class="pre">values</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">concat_ros</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="sampling.html#pyrado.sampling.step_sequence.StepSequence" title="pyrado.sampling.step_sequence.StepSequence"><span class="pre">StepSequence</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tensor</span></span></span><a class="reference internal" href="_modules/pyrado/algorithms/step_based/gae.html#GAE.values"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.algorithms.step_based.gae.GAE.values" title="Permalink to this definition"></a></dt>
<dd><p>Compute the states’ values for all observations.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>concat_ros</strong> – concatenated rollouts</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>states’ values</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="pyrado.algorithms.step_based.gae.GAE.vfcn">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">vfcn</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">Module</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="policies.html#pyrado.policies.base.Policy" title="pyrado.policies.base.Policy"><span class="pre">Policy</span></a><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#pyrado.algorithms.step_based.gae.GAE.vfcn" title="Permalink to this definition"></a></dt>
<dd><p>Get the value function approximator.</p>
</dd></dl>

</dd></dl>

</section>
<section id="module-pyrado.algorithms.step_based.ppo">
<span id="ppo"></span><h2>ppo<a class="headerlink" href="#module-pyrado.algorithms.step_based.ppo" title="Permalink to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="pyrado.algorithms.step_based.ppo.PPO">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">PPO</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">save_dir:</span> <span class="pre">~pyrado.PathLike</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">env:</span> <span class="pre">~pyrado.environments.base.Env</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">policy:</span> <span class="pre">~pyrado.policies.base.Policy</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">critic:</span> <span class="pre">~pyrado.algorithms.step_based.gae.GAE</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_iter:</span> <span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_rollouts:</span> <span class="pre">int</span> <span class="pre">=</span> <span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_steps:</span> <span class="pre">int</span> <span class="pre">=</span> <span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_epoch:</span> <span class="pre">int</span> <span class="pre">=</span> <span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eps_clip:</span> <span class="pre">float</span> <span class="pre">=</span> <span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_size:</span> <span class="pre">int</span> <span class="pre">=</span> <span class="pre">64</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">std_init:</span> <span class="pre">float</span> <span class="pre">=</span> <span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_workers:</span> <span class="pre">int</span> <span class="pre">=</span> <span class="pre">4</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_grad_norm:</span> <span class="pre">~typing.Optional[float]</span> <span class="pre">=</span> <span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lr:</span> <span class="pre">float</span> <span class="pre">=</span> <span class="pre">0.0005</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lr_scheduler=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lr_scheduler_hparam:</span> <span class="pre">[&lt;class</span> <span class="pre">'dict'&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">None]</span> <span class="pre">=</span> <span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logger:</span> <span class="pre">~pyrado.logger.step.StepLogger</span> <span class="pre">=</span> <span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/algorithms/step_based/ppo.html#PPO"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.algorithms.step_based.ppo.PPO" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#pyrado.algorithms.step_based.actor_critic.ActorCritic" title="pyrado.algorithms.step_based.actor_critic.ActorCritic"><code class="xref py py-class docutils literal notranslate"><span class="pre">ActorCritic</span></code></a></p>
<p>Proximal Policy Optimization (PPO)</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt>[1] J. Schulmann,  F. Wolski, P. Dhariwal, A. Radford, O. Klimov, “Proximal Policy Optimization Algorithms”,</dt><dd><p>arXiv, 2017</p>
</dd>
</dl>
<p>[2] D.P. Kingma, J. Ba, “Adam: A Method for Stochastic Optimization”, ICLR, 2015</p>
</div>
<p>Constructor</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>save_dir</strong> – directory to save the snapshots i.e. the results in</p></li>
<li><p><strong>env</strong> – the environment which the policy operates</p></li>
<li><p><strong>policy</strong> – policy to be updated</p></li>
<li><p><strong>critic</strong> – advantage estimation function <span class="math notranslate nohighlight">\(A(s,a) = Q(s,a) - V(s)\)</span></p></li>
<li><p><strong>max_iter</strong> – maximum number of iterations (i.e. policy updates) that this algorithm runs</p></li>
<li><p><strong>min_rollouts</strong> – minimum number of rollouts sampled per policy update batch</p></li>
<li><p><strong>min_steps</strong> – minimum number of state transitions sampled per policy update batch</p></li>
<li><p><strong>num_epoch</strong> – number of iterations over all gathered samples during one policy update</p></li>
<li><p><strong>eps_clip</strong> – max/min probability ratio, see [1]</p></li>
<li><p><strong>batch_size</strong> – number of samples per policy update batch</p></li>
<li><p><strong>std_init</strong> – initial standard deviation on the actions for the exploration noise</p></li>
<li><p><strong>num_workers</strong> – number of environments for parallel sampling</p></li>
<li><p><strong>max_grad_norm</strong> – maximum L2 norm of the gradients for clipping, set to <cite>None</cite> to disable gradient clipping</p></li>
<li><p><strong>lr</strong> – (initial) learning rate for the optimizer which can be by modified by the scheduler.
By default, the learning rate is constant.</p></li>
<li><p><strong>lr_scheduler</strong> – learning rate scheduler that does one step per epoch (pass through the whole data set)</p></li>
<li><p><strong>lr_scheduler_hparam</strong> – hyper-parameters for the learning rate scheduler</p></li>
<li><p><strong>logger</strong> – logger for every step of the algorithm, if <cite>None</cite> the default logger will be created</p></li>
</ul>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The Adam optimizer computes individual learning rates for all parameters. Thus, the learning rate scheduler
schedules the maximum learning rate.</p>
</div>
<dl class="py property">
<dt class="sig sig-object py" id="pyrado.algorithms.step_based.ppo.PPO.expl_strat">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">expl_strat</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="exploration.html#pyrado.exploration.stochastic_action.NormalActNoiseExplStrat" title="pyrado.exploration.stochastic_action.NormalActNoiseExplStrat"><span class="pre">NormalActNoiseExplStrat</span></a></em><a class="headerlink" href="#pyrado.algorithms.step_based.ppo.PPO.expl_strat" title="Permalink to this definition"></a></dt>
<dd><p>Get the algorithm’s exploration strategy.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyrado.algorithms.step_based.ppo.PPO.loss_fcn">
<span class="sig-name descname"><span class="pre">loss_fcn</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">log_probs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">log_probs_old</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">adv</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tensor</span></span></span><a class="reference internal" href="_modules/pyrado/algorithms/step_based/ppo.html#PPO.loss_fcn"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.algorithms.step_based.ppo.PPO.loss_fcn" title="Permalink to this definition"></a></dt>
<dd><p>PPO loss function</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>log_probs</strong> – logarithm of the probabilities of the taken actions using the updated policy</p></li>
<li><p><strong>log_probs_old</strong> – logarithm of the probabilities of the taken actions using the old policy</p></li>
<li><p><strong>adv</strong> – advantage values</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>loss value</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pyrado.algorithms.step_based.ppo.PPO.name">
<span class="sig-name descname"><span class="pre">name</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'ppo'</span></em><a class="headerlink" href="#pyrado.algorithms.step_based.ppo.PPO.name" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyrado.algorithms.step_based.ppo.PPO.update">
<span class="sig-name descname"><span class="pre">update</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rollouts</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Sequence</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="sampling.html#pyrado.sampling.step_sequence.StepSequence" title="pyrado.sampling.step_sequence.StepSequence"><span class="pre">StepSequence</span></a><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/algorithms/step_based/ppo.html#PPO.update"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.algorithms.step_based.ppo.PPO.update" title="Permalink to this definition"></a></dt>
<dd><p>Update the actor and critic parameters from the given batch of rollouts.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>rollouts</strong> – batch of rollouts</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="pyrado.algorithms.step_based.ppo.PPO2">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">PPO2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">save_dir:</span> <span class="pre">~pyrado.PathLike</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">env:</span> <span class="pre">~pyrado.environments.base.Env</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">policy:</span> <span class="pre">~pyrado.policies.base.Policy</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">critic:</span> <span class="pre">~pyrado.algorithms.step_based.gae.GAE</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_iter:</span> <span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_rollouts:</span> <span class="pre">int</span> <span class="pre">=</span> <span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_steps:</span> <span class="pre">int</span> <span class="pre">=</span> <span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_epoch:</span> <span class="pre">int</span> <span class="pre">=</span> <span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eps_clip:</span> <span class="pre">float</span> <span class="pre">=</span> <span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vfcn_coeff:</span> <span class="pre">float</span> <span class="pre">=</span> <span class="pre">0.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">entropy_coeff:</span> <span class="pre">float</span> <span class="pre">=</span> <span class="pre">0.001</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_size:</span> <span class="pre">int</span> <span class="pre">=</span> <span class="pre">32</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">std_init:</span> <span class="pre">float</span> <span class="pre">=</span> <span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_workers:</span> <span class="pre">int</span> <span class="pre">=</span> <span class="pre">4</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_grad_norm:</span> <span class="pre">~typing.Optional[float]</span> <span class="pre">=</span> <span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lr:</span> <span class="pre">float</span> <span class="pre">=</span> <span class="pre">0.0005</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lr_scheduler=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lr_scheduler_hparam:</span> <span class="pre">[&lt;class</span> <span class="pre">'dict'&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">None]</span> <span class="pre">=</span> <span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logger:</span> <span class="pre">~pyrado.logger.step.StepLogger</span> <span class="pre">=</span> <span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/algorithms/step_based/ppo.html#PPO2"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.algorithms.step_based.ppo.PPO2" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#pyrado.algorithms.step_based.actor_critic.ActorCritic" title="pyrado.algorithms.step_based.actor_critic.ActorCritic"><code class="xref py py-class docutils literal notranslate"><span class="pre">ActorCritic</span></code></a></p>
<p>Variant of Proximal Policy Optimization (PPO)
PPO2 differs from PPO by also clipping the value function and standardizing the advantages.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>PPO2 refers to the OpenAI version of PPO which is a GPU-enabled implementation. However, this one is not!</p>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p>[1] OpenAI Stable Baselines Documentation, <a class="reference external" href="https://stable-baselines.readthedocs.io/en/master/modules/ppo2.html">https://stable-baselines.readthedocs.io/en/master/modules/ppo2.html</a>
[2] J. Schulmann,  F. Wolski, P. Dhariwal, A. Radford, O. Klimov, “Proximal Policy Optimization Algorithms”,</p>
<blockquote>
<div><p>arXiv, 2017</p>
</div></blockquote>
<p>[3] D.P. Kingma, J. Ba, “Adam: A Method for Stochastic Optimization”, ICLR, 2015</p>
</div>
<p>Constructor</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>save_dir</strong> – directory to save the snapshots i.e. the results in</p></li>
<li><p><strong>env</strong> – the environment which the policy operates</p></li>
<li><p><strong>policy</strong> – policy to be updated</p></li>
<li><p><strong>critic</strong> – advantage estimation function <span class="math notranslate nohighlight">\(A(s,a) = Q(s,a) - V(s)\)</span></p></li>
<li><p><strong>max_iter</strong> – maximum number of iterations (i.e. policy updates) that this algorithm runs</p></li>
<li><p><strong>min_rollouts</strong> – minimum number of rollouts sampled per policy update batch</p></li>
<li><p><strong>min_steps</strong> – minimum number of state transitions sampled per policy update batch</p></li>
<li><p><strong>num_epoch</strong> – number of iterations over all gathered samples during one policy update</p></li>
<li><p><strong>eps_clip</strong> – max/min probability ratio, see [1]</p></li>
<li><p><strong>vfcn_coeff</strong> – weighting factor of the value function term in the combined loss, specific to PPO2</p></li>
<li><p><strong>entropy_coeff</strong> – weighting factor of the entropy term in the combined loss, specific to PPO2</p></li>
<li><p><strong>batch_size</strong> – number of samples per policy update batch</p></li>
<li><p><strong>std_init</strong> – initial standard deviation on the actions for the exploration noise</p></li>
<li><p><strong>num_workers</strong> – number of environments for parallel sampling</p></li>
<li><p><strong>max_grad_norm</strong> – maximum L2 norm of the gradients for clipping, set to <cite>None</cite> to disable gradient clipping</p></li>
<li><p><strong>lr</strong> – (initial) learning rate for the optimizer which can be by modified by the scheduler.
By default, the learning rate is constant.</p></li>
<li><p><strong>lr_scheduler</strong> – learning rate scheduler that does one step per epoch (pass through the whole data set)</p></li>
<li><p><strong>lr_scheduler_hparam</strong> – hyper-parameters for the learning rate scheduler</p></li>
<li><p><strong>logger</strong> – logger for every step of the algorithm, if <cite>None</cite> the default logger will be created</p></li>
</ul>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The Adam optimizer computes individual learning rates for all parameters. Thus, the learning rate scheduler
schedules the maximum learning rate.</p>
</div>
<dl class="py property">
<dt class="sig sig-object py" id="pyrado.algorithms.step_based.ppo.PPO2.expl_strat">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">expl_strat</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="exploration.html#pyrado.exploration.stochastic_action.NormalActNoiseExplStrat" title="pyrado.exploration.stochastic_action.NormalActNoiseExplStrat"><span class="pre">NormalActNoiseExplStrat</span></a></em><a class="headerlink" href="#pyrado.algorithms.step_based.ppo.PPO2.expl_strat" title="Permalink to this definition"></a></dt>
<dd><p>Get the algorithm’s exploration strategy.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyrado.algorithms.step_based.ppo.PPO2.loss_fcn">
<span class="sig-name descname"><span class="pre">loss_fcn</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">log_probs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">log_probs_old</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">adv</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">v_pred</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">v_pred_old</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">v_targ</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tensor</span></span></span><a class="reference internal" href="_modules/pyrado/algorithms/step_based/ppo.html#PPO2.loss_fcn"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.algorithms.step_based.ppo.PPO2.loss_fcn" title="Permalink to this definition"></a></dt>
<dd><p>PPO2 loss function</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>log_probs</strong> – logarithm of the probabilities of the taken actions using the updated policy</p></li>
<li><p><strong>log_probs_old</strong> – logarithm of the probabilities of the taken actions using the old policy</p></li>
<li><p><strong>adv</strong> – advantage values</p></li>
<li><p><strong>v_pred</strong> – predicted value function values</p></li>
<li><p><strong>v_pred_old</strong> – predicted value function values using the old value function</p></li>
<li><p><strong>v_targ</strong> – target value function values</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>combined loss value</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pyrado.algorithms.step_based.ppo.PPO2.name">
<span class="sig-name descname"><span class="pre">name</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'ppo2'</span></em><a class="headerlink" href="#pyrado.algorithms.step_based.ppo.PPO2.name" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyrado.algorithms.step_based.ppo.PPO2.update">
<span class="sig-name descname"><span class="pre">update</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rollouts</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Sequence</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="sampling.html#pyrado.sampling.step_sequence.StepSequence" title="pyrado.sampling.step_sequence.StepSequence"><span class="pre">StepSequence</span></a><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/algorithms/step_based/ppo.html#PPO2.update"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.algorithms.step_based.ppo.PPO2.update" title="Permalink to this definition"></a></dt>
<dd><p>Update the actor and critic parameters from the given batch of rollouts.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>rollouts</strong> – batch of rollouts</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-pyrado.algorithms.step_based.sac">
<span id="sac"></span><h2>sac<a class="headerlink" href="#module-pyrado.algorithms.step_based.sac" title="Permalink to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="pyrado.algorithms.step_based.sac.SAC">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">SAC</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">save_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">PathLike</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">env</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="environments.html#pyrado.environments.base.Env" title="pyrado.environments.base.Env"><span class="pre">Env</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">policy</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="policies.html#pyrado.policies.base.TwoHeadedPolicy" title="pyrado.policies.base.TwoHeadedPolicy"><span class="pre">TwoHeadedPolicy</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">qfcn_1</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="policies.html#pyrado.policies.base.Policy" title="pyrado.policies.base.Policy"><span class="pre">Policy</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">qfcn_2</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="policies.html#pyrado.policies.base.Policy" title="pyrado.policies.base.Policy"><span class="pre">Policy</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">memory_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gamma</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_iter</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_updates_per_step</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tau</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.995</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ent_coeff_init</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">learn_ent_coeff</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_update_intvl</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_init_memory_steps</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">standardize_rew</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rew_scale</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_rollouts</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_steps</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">256</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eval_intvl</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_grad_norm</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">5.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lr</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.0003</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lr_scheduler</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lr_scheduler_hparam</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_workers</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">4</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logger</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="logger.html#pyrado.logger.step.StepLogger" title="pyrado.logger.step.StepLogger"><span class="pre">StepLogger</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_trained_policy_for_refill</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/algorithms/step_based/sac.html#SAC"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.algorithms.step_based.sac.SAC" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#pyrado.algorithms.step_based.value_based.ValueBased" title="pyrado.algorithms.step_based.value_based.ValueBased"><code class="xref py py-class docutils literal notranslate"><span class="pre">ValueBased</span></code></a></p>
<p>Soft Actor-Critic (SAC) variant with stochastic policy and two Q-functions and two Q-targets (no V-function)</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt>[1] T. Haarnoja, A. Zhou, P. Abbeel, S. Levine, “Soft Actor-Critic: Off-Policy Maximum Entropy Deep</dt><dd><p>Reinforcement Learning with a Stochastic Actor”, ICML, 2018</p>
</dd>
<dt>[2] This implementation was inspired by <a class="reference external" href="https://github.com/pranz24/pytorch-soft-actor-critic">https://github.com/pranz24/pytorch-soft-actor-critic</a></dt><dd><p>which is seems to be based on <a class="reference external" href="https://github.com/vitchyr/rlkit">https://github.com/vitchyr/rlkit</a></p>
</dd>
<dt>[3] This implementation also borrows (at least a bit) from</dt><dd><p><a class="reference external" href="https://github.com/DLR-RM/stable-baselines3/tree/master/stable_baselines3/sac">https://github.com/DLR-RM/stable-baselines3/tree/master/stable_baselines3/sac</a></p>
</dd>
</dl>
<p>[4] <a class="reference external" href="https://github.com/MushroomRL/mushroom-rl/blob/dev/mushroom_rl/algorithms/actor_critic/deep_actor_critic/sac.py">https://github.com/MushroomRL/mushroom-rl/blob/dev/mushroom_rl/algorithms/actor_critic/deep_actor_critic/sac.py</a></p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The update order of the policy, the Q-functions, (and the entropy coefficient) is different in almost every
implementation out there. Here we follow the one from [3].</p>
</div>
<p>Constructor</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>save_dir</strong> – directory to save the snapshots i.e. the results in</p></li>
<li><p><strong>env</strong> – the environment which the policy operates</p></li>
<li><p><strong>policy</strong> – policy to be updated</p></li>
<li><p><strong>qfcn_1</strong> – state-action value function <span class="math notranslate nohighlight">\(Q(s,a)\)</span>, the associated target Q-functions is created from a
re-initialized copies of this one</p></li>
<li><p><strong>qfcn_2</strong> – state-action value function <span class="math notranslate nohighlight">\(Q(s,a)\)</span>, the associated target Q-functions is created from a
re-initialized copies of this one</p></li>
<li><p><strong>memory_size</strong> – number of transitions in the replay memory buffer, e.g. 1000000</p></li>
<li><p><strong>gamma</strong> – temporal discount factor for the state values</p></li>
<li><p><strong>max_iter</strong> – maximum number of iterations (i.e. policy updates) that this algorithm runs</p></li>
<li><p><strong>num_updates_per_step</strong> – number of (batched) gradient updates per algorithm step</p></li>
<li><p><strong>tau</strong> – interpolation factor in averaging for target networks, update used for the soft update a.k.a. polyak
update, between 0 and 1</p></li>
<li><p><strong>ent_coeff_init</strong> – initial weighting factor of the entropy term in the loss function</p></li>
<li><p><strong>learn_ent_coeff</strong> – adapt the weighting factor of the entropy term</p></li>
<li><p><strong>target_update_intvl</strong> – number of iterations that pass before updating the target network</p></li>
<li><p><strong>num_init_memory_steps</strong> – number of samples used to initially fill the replay buffer with, pass <cite>None</cite> to
fill the buffer completely</p></li>
<li><p><strong>standardize_rew</strong> – if <cite>True</cite>, the rewards are standardized to be <span class="math notranslate nohighlight">\(~ N(0,1)\)</span></p></li>
<li><p><strong>rew_scale</strong> – scaling factor for the rewards, defaults no scaling</p></li>
<li><p><strong>min_rollouts</strong> – minimum number of rollouts sampled per policy update batch</p></li>
<li><p><strong>min_steps</strong> – minimum number of state transitions sampled per policy update batch</p></li>
<li><p><strong>batch_size</strong> – number of samples per policy update batch</p></li>
<li><p><strong>eval_intvl</strong> – interval in which the evaluation rollouts are collected, also the interval in which the
logger prints the summary statistics</p></li>
<li><p><strong>max_grad_norm</strong> – maximum L2 norm of the gradients for clipping, set to <cite>None</cite> to disable gradient clipping</p></li>
<li><p><strong>lr</strong> – (initial) learning rate for the optimizer which can be by modified by the scheduler.
By default, the learning rate is constant.</p></li>
<li><p><strong>lr_scheduler</strong> – learning rate scheduler type for the policy and the Q-functions that does one step
per <cite>update()</cite> call</p></li>
<li><p><strong>lr_scheduler_hparam</strong> – hyper-parameters for the learning rate scheduler</p></li>
<li><p><strong>num_workers</strong> – number of environments for parallel sampling</p></li>
<li><p><strong>logger</strong> – logger for every step of the algorithm, if <cite>None</cite> the default logger will be created</p></li>
<li><p><strong>use_trained_policy_for_refill</strong> – whether to use the trained policy instead of a dummy policy to refill the
replay buffer after resets</p></li>
</ul>
</dd>
</dl>
<dl class="py property">
<dt class="sig sig-object py" id="pyrado.algorithms.step_based.sac.SAC.ent_coeff">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">ent_coeff</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Tensor</span></em><a class="headerlink" href="#pyrado.algorithms.step_based.sac.SAC.ent_coeff" title="Permalink to this definition"></a></dt>
<dd><p>Get the detached entropy coefficient.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyrado.algorithms.step_based.sac.SAC.init_modules">
<span class="sig-name descname"><span class="pre">init_modules</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">warmstart</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">suffix</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prefix</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/algorithms/step_based/sac.html#SAC.init_modules"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.algorithms.step_based.sac.SAC.init_modules" title="Permalink to this definition"></a></dt>
<dd><p>Initialize the algorithm’s learnable modules, e.g. a policy or value function.
Overwrite this method if the algorithm uses a learnable module aside the policy, e.g. a value function.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>warmstart</strong> – if <cite>True</cite>, the algorithm starts learning with a non-random initialization. This can either
be the a fixed parameter vector, or the loaded results of the previous iteration.</p></li>
<li><p><strong>suffix</strong> – keyword for <cite>meta_info</cite> when loading from previous iteration</p></li>
<li><p><strong>prefix</strong> – keyword for <cite>meta_info</cite> when loading from previous iteration</p></li>
<li><p><strong>kwargs</strong> – keyword arguments for initialization, e.g. <cite>policy_param_init</cite> or <cite>valuefcn_param_init</cite></p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyrado.algorithms.step_based.sac.SAC.load_snapshot">
<span class="sig-name descname"><span class="pre">load_snapshot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">parsed_args</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="environments.html#pyrado.environments.base.Env" title="pyrado.environments.base.Env"><span class="pre">Env</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="policies.html#pyrado.policies.base.Policy" title="pyrado.policies.base.Policy"><span class="pre">Policy</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/pyrado/algorithms/step_based/sac.html#SAC.load_snapshot"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.algorithms.step_based.sac.SAC.load_snapshot" title="Permalink to this definition"></a></dt>
<dd><p>Load the state of an experiment, which is specific to the algorithm.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>parsed_args</strong> – arguments parsed by the <cite>argparser</cite></p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>environment, policy, and (optional) algorithm-specific output, e.g. value function</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pyrado.algorithms.step_based.sac.SAC.name">
<span class="sig-name descname"><span class="pre">name</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'sac'</span></em><a class="headerlink" href="#pyrado.algorithms.step_based.sac.SAC.name" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyrado.algorithms.step_based.sac.SAC.reset">
<span class="sig-name descname"><span class="pre">reset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/algorithms/step_based/sac.html#SAC.reset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.algorithms.step_based.sac.SAC.reset" title="Permalink to this definition"></a></dt>
<dd><p>Reset the algorithm to it’s initial state. This should NOT reset learned policy parameters.
By default, this resets the iteration count and the exploration strategy.
Be sure to call this function if you override it.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>seed</strong> – seed value for the random number generators, pass <cite>None</cite> for no seeding</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="pyrado.algorithms.step_based.sac.SAC.sampler">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">sampler</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="sampling.html#pyrado.sampling.parallel_rollout_sampler.ParallelRolloutSampler" title="pyrado.sampling.parallel_rollout_sampler.ParallelRolloutSampler"><span class="pre">ParallelRolloutSampler</span></a></em><a class="headerlink" href="#pyrado.algorithms.step_based.sac.SAC.sampler" title="Permalink to this definition"></a></dt>
<dd><p>Get the sampler. For algorithms with multiple samplers, this is the once collecting the training data.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyrado.algorithms.step_based.sac.SAC.save_snapshot">
<span class="sig-name descname"><span class="pre">save_snapshot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">meta_info</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/algorithms/step_based/sac.html#SAC.save_snapshot"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.algorithms.step_based.sac.SAC.save_snapshot" title="Permalink to this definition"></a></dt>
<dd><p>Save the algorithm information (e.g., environment, policy, ect.).
Subclasses should call the base method to save the policy.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>meta_info</strong> – is not <cite>None</cite> if this algorithm is run as a subroutine of a meta-algorithm,
contains a dict of information about the current iteration of the meta-algorithm</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyrado.algorithms.step_based.sac.SAC.update">
<span class="sig-name descname"><span class="pre">update</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/algorithms/step_based/sac.html#SAC.update"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.algorithms.step_based.sac.SAC.update" title="Permalink to this definition"></a></dt>
<dd><p>Update the policy’s and Q-functions’ parameters on transitions sampled from the replay memory.</p>
</dd></dl>

</dd></dl>

</section>
<section id="module-pyrado.algorithms.step_based.svpg">
<span id="svpg"></span><h2>svpg<a class="headerlink" href="#module-pyrado.algorithms.step_based.svpg" title="Permalink to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="pyrado.algorithms.step_based.svpg.OptimizerHook">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">OptimizerHook</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">particle</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/algorithms/step_based/svpg.html#OptimizerHook"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.algorithms.step_based.svpg.OptimizerHook" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>This class mocks the optimizer interface partially to intercept the gradient updates of svpg.</p>
<p>Constructor</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>particle</strong> – blueprint algorithm in which the optimizer is replaced by the mocked one</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyrado.algorithms.step_based.svpg.OptimizerHook.empty">
<span class="sig-name descname"><span class="pre">empty</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">bool</span></span></span><a class="reference internal" href="_modules/pyrado/algorithms/step_based/svpg.html#OptimizerHook.empty"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.algorithms.step_based.svpg.OptimizerHook.empty" title="Permalink to this definition"></a></dt>
<dd><p>Check if the buffer is empty.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>buffer is empty</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyrado.algorithms.step_based.svpg.OptimizerHook.iter_steps">
<span class="sig-name descname"><span class="pre">iter_steps</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">List</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Dict</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Tensor</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Tensor</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/pyrado/algorithms/step_based/svpg.html#OptimizerHook.iter_steps"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.algorithms.step_based.svpg.OptimizerHook.iter_steps" title="Permalink to this definition"></a></dt>
<dd><p>Generate the steps in the buffer queue.</p>
<dl class="field-list simple">
<dt class="field-odd">Yield</dt>
<dd class="field-odd"><p>the next step in the queue</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyrado.algorithms.step_based.svpg.OptimizerHook.real_step">
<span class="sig-name descname"><span class="pre">real_step</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/algorithms/step_based/svpg.html#OptimizerHook.real_step"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.algorithms.step_based.svpg.OptimizerHook.real_step" title="Permalink to this definition"></a></dt>
<dd><p>Call the original optimizer with given args and kwargs.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyrado.algorithms.step_based.svpg.OptimizerHook.reset">
<span class="sig-name descname"><span class="pre">reset</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/algorithms/step_based/svpg.html#OptimizerHook.reset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.algorithms.step_based.svpg.OptimizerHook.reset" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyrado.algorithms.step_based.svpg.OptimizerHook.step">
<span class="sig-name descname"><span class="pre">step</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/algorithms/step_based/svpg.html#OptimizerHook.step"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.algorithms.step_based.svpg.OptimizerHook.step" title="Permalink to this definition"></a></dt>
<dd><p>Store the args of the mocked call in the queue.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyrado.algorithms.step_based.svpg.OptimizerHook.zero_grad">
<span class="sig-name descname"><span class="pre">zero_grad</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/algorithms/step_based/svpg.html#OptimizerHook.zero_grad"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.algorithms.step_based.svpg.OptimizerHook.zero_grad" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="pyrado.algorithms.step_based.svpg.SVPG">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">SVPG</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">save_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">PathLike</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">env</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="environments.html#pyrado.environments.base.Env" title="pyrado.environments.base.Env"><span class="pre">Env</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">particle</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="algorithms.html#pyrado.algorithms.base.Algorithm" title="pyrado.algorithms.base.Algorithm"><span class="pre">Algorithm</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_iter</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_particles</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">temperature</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">horizon</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logger</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="logger.html#pyrado.logger.step.StepLogger" title="pyrado.logger.step.StepLogger"><span class="pre">StepLogger</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/algorithms/step_based/svpg.html#SVPG"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.algorithms.step_based.svpg.SVPG" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="algorithms.html#pyrado.algorithms.base.Algorithm" title="pyrado.algorithms.base.Algorithm"><code class="xref py py-class docutils literal notranslate"><span class="pre">Algorithm</span></code></a></p>
<p>Stein Variational Policy Gradient (SVPG)</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p>[1] Yang Liu, Prajit Ramachandran, Qiang Liu, Jian Peng, “Stein Variational Policy Gradient”, arXiv, 2017</p>
</div>
<p>Constructor</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>save_dir</strong> – directory to save the snapshots i.e. the results in</p></li>
<li><p><strong>env</strong> – the environment which the policy operates</p></li>
<li><p><strong>particle</strong> – the particle to populate with different parameters during training</p></li>
<li><p><strong>max_iter</strong> – maximum number of iterations (i.e. policy updates) that this algorithm runs</p></li>
<li><p><strong>num_particles</strong> – number of SVPG particles</p></li>
<li><p><strong>temperature</strong> – SVPG temperature</p></li>
<li><p><strong>horizon</strong> – horizon for each particle</p></li>
<li><p><strong>logger</strong> – defaults to <cite>None</cite></p></li>
</ul>
</dd>
</dl>
<dl class="py property">
<dt class="sig sig-object py" id="pyrado.algorithms.step_based.svpg.SVPG.iter_particles">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">iter_particles</span></span><a class="headerlink" href="#pyrado.algorithms.step_based.svpg.SVPG.iter_particles" title="Permalink to this definition"></a></dt>
<dd><p>Iterate particles by sequentially loading and yielding them.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyrado.algorithms.step_based.svpg.SVPG.kernel">
<span class="sig-name descname"><span class="pre">kernel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Tensor</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Tensor</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/pyrado/algorithms/step_based/svpg.html#SVPG.kernel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.algorithms.step_based.svpg.SVPG.kernel" title="Permalink to this definition"></a></dt>
<dd><p>Compute the RBF-kernel and the corresponding derivatives.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>X</strong> – the tensor to compute the kernel from</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the kernel and its derivatives</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyrado.algorithms.step_based.svpg.SVPG.load_particle">
<span class="sig-name descname"><span class="pre">load_particle</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">idx</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/algorithms/step_based/svpg.html#SVPG.load_particle"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.algorithms.step_based.svpg.SVPG.load_particle" title="Permalink to this definition"></a></dt>
<dd><p>Load a specific particle’s state into <cite>self.particle</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>idx</strong> – index of the particle to load</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyrado.algorithms.step_based.svpg.SVPG.load_snapshot">
<span class="sig-name descname"><span class="pre">load_snapshot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">parsed_args</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="environments.html#pyrado.environments.base.Env" title="pyrado.environments.base.Env"><span class="pre">Env</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="policies.html#pyrado.policies.base.Policy" title="pyrado.policies.base.Policy"><span class="pre">Policy</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/pyrado/algorithms/step_based/svpg.html#SVPG.load_snapshot"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.algorithms.step_based.svpg.SVPG.load_snapshot" title="Permalink to this definition"></a></dt>
<dd><p>Load the state of an experiment, which is specific to the algorithm.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>parsed_args</strong> – arguments parsed by the <cite>argparser</cite></p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>environment, policy, and (optional) algorithm-specific output, e.g. value function</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pyrado.algorithms.step_based.svpg.SVPG.name">
<span class="sig-name descname"><span class="pre">name</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'svpg'</span></em><a class="headerlink" href="#pyrado.algorithms.step_based.svpg.SVPG.name" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyrado.algorithms.step_based.svpg.SVPG.save_snapshot">
<span class="sig-name descname"><span class="pre">save_snapshot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">meta_info</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/algorithms/step_based/svpg.html#SVPG.save_snapshot"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.algorithms.step_based.svpg.SVPG.save_snapshot" title="Permalink to this definition"></a></dt>
<dd><p>Save the algorithm information (e.g., environment, policy, ect.).
Subclasses should call the base method to save the policy.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>meta_info</strong> – is not <cite>None</cite> if this algorithm is run as a subroutine of a meta-algorithm,
contains a dict of information about the current iteration of the meta-algorithm</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyrado.algorithms.step_based.svpg.SVPG.step">
<span class="sig-name descname"><span class="pre">step</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">snapshot_mode</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">meta_info</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/algorithms/step_based/svpg.html#SVPG.step"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.algorithms.step_based.svpg.SVPG.step" title="Permalink to this definition"></a></dt>
<dd><p>Perform a single iteration of the algorithm. This includes collecting the data, updating the parameters, and
adding the metrics of interest to the logger. Does not update the <cite>curr_iter</cite> attribute.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>snapshot_mode</strong> – determines when the snapshots are stored (e.g. on every iteration or on new highscore)</p></li>
<li><p><strong>meta_info</strong> – is not <cite>None</cite> if this algorithm is run as a subroutine of a meta-algorithm,
contains a dict of information about the current iteration of the meta-algorithm</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyrado.algorithms.step_based.svpg.SVPG.store_particle">
<span class="sig-name descname"><span class="pre">store_particle</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/algorithms/step_based/svpg.html#SVPG.store_particle"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.algorithms.step_based.svpg.SVPG.store_particle" title="Permalink to this definition"></a></dt>
<dd><p>Safe the current particle’s state.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="pyrado.algorithms.step_based.svpg.SVPGBuilder">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">SVPGBuilder</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">save_dir</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">env</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="environments.html#pyrado.environments.base.Env" title="pyrado.environments.base.Env"><span class="pre">Env</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">hparam</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/algorithms/step_based/svpg.html#SVPGBuilder"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.algorithms.step_based.svpg.SVPGBuilder" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Helper class to build an SVPG algorithm instance</p>
<p>Constructor</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>save_dir</strong> – directory to save the snapshots i.e. the results in</p></li>
<li><p><strong>env</strong> – the environment which the policy operates</p></li>
<li><p><strong>hparam</strong> – hyper-parameters for SVPG</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-pyrado.algorithms.step_based.value_based">
<span id="value-based"></span><h2>value_based<a class="headerlink" href="#module-pyrado.algorithms.step_based.value_based" title="Permalink to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="pyrado.algorithms.step_based.value_based.ValueBased">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">ValueBased</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">save_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">PathLike</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">env</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="environments.html#pyrado.environments.base.Env" title="pyrado.environments.base.Env"><span class="pre">Env</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">policy</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="policies.html#pyrado.policies.base.Policy" title="pyrado.policies.base.Policy"><span class="pre">Policy</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="policies.html#pyrado.policies.base.TwoHeadedPolicy" title="pyrado.policies.base.TwoHeadedPolicy"><span class="pre">TwoHeadedPolicy</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">memory_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gamma</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_iter</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_updates_per_step</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_update_intvl</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_init_memory_steps</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_rollouts</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_steps</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eval_intvl</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_grad_norm</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_workers</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logger</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="logger.html#pyrado.logger.step.StepLogger" title="pyrado.logger.step.StepLogger"><span class="pre">StepLogger</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_trained_policy_for_refill</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/algorithms/step_based/value_based.html#ValueBased"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.algorithms.step_based.value_based.ValueBased" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="algorithms.html#pyrado.algorithms.base.Algorithm" title="pyrado.algorithms.base.Algorithm"><code class="xref py py-class docutils literal notranslate"><span class="pre">Algorithm</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">ABC</span></code></p>
<p>Base class of all value-based algorithms</p>
<p>Constructor</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>save_dir</strong> – directory to save the snapshots i.e. the results in</p></li>
<li><p><strong>env</strong> – the environment which the policy operates</p></li>
<li><p><strong>policy</strong> – policy to be updated</p></li>
<li><p><strong>memory_size</strong> – number of transitions in the replay memory buffer, e.g. 1000000</p></li>
<li><p><strong>gamma</strong> – temporal discount factor for the state values</p></li>
<li><p><strong>max_iter</strong> – maximum number of iterations (i.e. policy updates) that this algorithm runs</p></li>
<li><p><strong>num_updates_per_step</strong> – number of (batched) gradient updates per algorithm step</p></li>
<li><p><strong>target_update_intvl</strong> – number of iterations that pass before updating the target network</p></li>
<li><p><strong>num_init_memory_steps</strong> – number of samples used to initially fill the replay buffer with, pass <cite>None</cite> to
fill the buffer completely</p></li>
<li><p><strong>min_rollouts</strong> – minimum number of rollouts sampled per policy update batch</p></li>
<li><p><strong>min_steps</strong> – minimum number of state transitions sampled per policy update batch</p></li>
<li><p><strong>batch_size</strong> – number of samples per policy update batch</p></li>
<li><p><strong>eval_intvl</strong> – interval in which the evaluation rollouts are collected, also the interval in which the
logger prints the summary statistics</p></li>
<li><p><strong>max_grad_norm</strong> – maximum L2 norm of the gradients for clipping, set to <cite>None</cite> to disable gradient clipping</p></li>
<li><p><strong>num_workers</strong> – number of environments for parallel sampling</p></li>
<li><p><strong>logger</strong> – logger for every step of the algorithm, if <cite>None</cite> the default logger will be created</p></li>
<li><p><strong>use_trained_policy_for_refill</strong> – whether to use the trained policy instead of a dummy policy to refill the
replay buffer after resets</p></li>
</ul>
</dd>
</dl>
<dl class="py property">
<dt class="sig sig-object py" id="pyrado.algorithms.step_based.value_based.ValueBased.expl_strat">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">expl_strat</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="exploration.html#pyrado.exploration.stochastic_action.SACExplStrat" title="pyrado.exploration.stochastic_action.SACExplStrat"><span class="pre">SACExplStrat</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="exploration.html#pyrado.exploration.stochastic_action.EpsGreedyExplStrat" title="pyrado.exploration.stochastic_action.EpsGreedyExplStrat"><span class="pre">EpsGreedyExplStrat</span></a><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#pyrado.algorithms.step_based.value_based.ValueBased.expl_strat" title="Permalink to this definition"></a></dt>
<dd><p>Get the algorithm’s exploration strategy.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="pyrado.algorithms.step_based.value_based.ValueBased.memory">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">memory</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="algorithms.html#pyrado.algorithms.utils.ReplayMemory" title="pyrado.algorithms.utils.ReplayMemory"><span class="pre">ReplayMemory</span></a></em><a class="headerlink" href="#pyrado.algorithms.step_based.value_based.ValueBased.memory" title="Permalink to this definition"></a></dt>
<dd><p>Get the replay memory.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyrado.algorithms.step_based.value_based.ValueBased.reset">
<span class="sig-name descname"><span class="pre">reset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/algorithms/step_based/value_based.html#ValueBased.reset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.algorithms.step_based.value_based.ValueBased.reset" title="Permalink to this definition"></a></dt>
<dd><p>Reset the algorithm to it’s initial state. This should NOT reset learned policy parameters.
By default, this resets the iteration count and the exploration strategy.
Be sure to call this function if you override it.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>seed</strong> – seed value for the random number generators, pass <cite>None</cite> for no seeding</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyrado.algorithms.step_based.value_based.ValueBased.save_snapshot">
<span class="sig-name descname"><span class="pre">save_snapshot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">meta_info</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/algorithms/step_based/value_based.html#ValueBased.save_snapshot"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.algorithms.step_based.value_based.ValueBased.save_snapshot" title="Permalink to this definition"></a></dt>
<dd><p>Save the algorithm information (e.g., environment, policy, ect.).
Subclasses should call the base method to save the policy.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>meta_info</strong> – is not <cite>None</cite> if this algorithm is run as a subroutine of a meta-algorithm,
contains a dict of information about the current iteration of the meta-algorithm</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyrado.algorithms.step_based.value_based.ValueBased.step">
<span class="sig-name descname"><span class="pre">step</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">snapshot_mode</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">meta_info</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/algorithms/step_based/value_based.html#ValueBased.step"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.algorithms.step_based.value_based.ValueBased.step" title="Permalink to this definition"></a></dt>
<dd><p>Perform a single iteration of the algorithm. This includes collecting the data, updating the parameters, and
adding the metrics of interest to the logger. Does not update the <cite>curr_iter</cite> attribute.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>snapshot_mode</strong> – determines when the snapshots are stored (e.g. on every iteration or on new highscore)</p></li>
<li><p><strong>meta_info</strong> – is not <cite>None</cite> if this algorithm is run as a subroutine of a meta-algorithm,
contains a dict of information about the current iteration of the meta-algorithm</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyrado.algorithms.step_based.value_based.ValueBased.update">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">update</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/algorithms/step_based/value_based.html#ValueBased.update"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.algorithms.step_based.value_based.ValueBased.update" title="Permalink to this definition"></a></dt>
<dd><p>Update the policy’s (and value functions’) parameters based on the collected rollout data.</p>
</dd></dl>

</dd></dl>

</section>
<section id="module-pyrado.algorithms.step_based">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-pyrado.algorithms.step_based" title="Permalink to this heading"></a></h2>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="algorithms.episodic.html" class="btn btn-neutral float-left" title="episodic" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="algorithms.meta.html" class="btn btn-neutral float-right" title="meta" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2020.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>